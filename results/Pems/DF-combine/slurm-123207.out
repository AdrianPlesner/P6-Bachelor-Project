[08:38:54] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for CPU
[08:38:59] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for GPU
  0%|          | 0/1143 [00:00<?, ?it/s] 34%|███▎      | 384/1143 [00:10<00:19, 38.37it/s, epoch=1/50, avg_epoch_loss=0.304] 94%|█████████▍| 1072/1143 [00:20<00:01, 56.22it/s, epoch=1/50, avg_epoch_loss=0.227]100%|██████████| 1143/1143 [00:21<00:00, 54.30it/s, epoch=1/50, avg_epoch_loss=0.224]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 677/1143 [00:10<00:06, 67.68it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:17<00:00, 67.21it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 681/1143 [00:10<00:06, 68.03it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:16<00:00, 67.91it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 683/1143 [00:10<00:06, 68.29it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:16<00:00, 68.41it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 682/1143 [00:10<00:06, 68.12it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 68.27it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 690/1143 [00:10<00:06, 68.91it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 68.89it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 693/1143 [00:10<00:06, 69.28it/s, epoch=7/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:16<00:00, 69.50it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 694/1143 [00:10<00:06, 69.39it/s, epoch=8/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:16<00:00, 69.43it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 689/1143 [00:10<00:06, 68.86it/s, epoch=9/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:16<00:00, 69.05it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 695/1143 [00:10<00:06, 69.46it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.52it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 693/1143 [00:10<00:06, 69.30it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 69.47it/s, epoch=11/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 697/1143 [00:10<00:06, 69.69it/s, epoch=12/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 69.77it/s, epoch=12/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 695/1143 [00:10<00:06, 69.45it/s, epoch=13/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 69.24it/s, epoch=13/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 692/1143 [00:10<00:06, 69.17it/s, epoch=14/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 69.05it/s, epoch=14/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 698/1143 [00:10<00:06, 69.80it/s, epoch=15/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 69.40it/s, epoch=15/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 692/1143 [00:10<00:06, 69.17it/s, epoch=16/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.26it/s, epoch=16/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 686/1143 [00:10<00:06, 68.59it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 68.76it/s, epoch=17/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 695/1143 [00:10<00:06, 69.42it/s, epoch=18/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.24it/s, epoch=18/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 681/1143 [00:10<00:06, 67.99it/s, epoch=19/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 68.52it/s, epoch=19/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 682/1143 [00:10<00:06, 68.11it/s, epoch=20/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 68.57it/s, epoch=20/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 691/1143 [00:10<00:06, 69.09it/s, epoch=21/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.05it/s, epoch=21/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 690/1143 [00:10<00:06, 68.92it/s, epoch=22/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 68.20it/s, epoch=22/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 690/1143 [00:10<00:06, 68.99it/s, epoch=23/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 68.74it/s, epoch=23/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 691/1143 [00:10<00:06, 69.03it/s, epoch=24/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.12it/s, epoch=24/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 683/1143 [00:10<00:06, 68.23it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.49it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 686/1143 [00:10<00:06, 68.57it/s, epoch=26/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 68.45it/s, epoch=26/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 680/1143 [00:10<00:06, 67.99it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.25it/s, epoch=27/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 685/1143 [00:10<00:06, 68.41it/s, epoch=28/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 68.56it/s, epoch=28/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 691/1143 [00:10<00:06, 69.09it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.01it/s, epoch=29/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 694/1143 [00:10<00:06, 69.32it/s, epoch=30/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.07it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 683/1143 [00:10<00:06, 68.21it/s, epoch=31/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 68.13it/s, epoch=31/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 685/1143 [00:10<00:06, 68.49it/s, epoch=32/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 68.41it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 684/1143 [00:10<00:06, 68.36it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.20it/s, epoch=33/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 686/1143 [00:10<00:06, 68.59it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:16<00:00, 68.76it/s, epoch=34/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 688/1143 [00:10<00:06, 68.80it/s, epoch=35/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 68.65it/s, epoch=35/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 691/1143 [00:10<00:06, 69.01it/s, epoch=36/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.19it/s, epoch=36/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 680/1143 [00:10<00:06, 67.95it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:16<00:00, 68.28it/s, epoch=37/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 685/1143 [00:10<00:06, 68.49it/s, epoch=38/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.73it/s, epoch=38/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 688/1143 [00:10<00:06, 68.72it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.57it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 687/1143 [00:10<00:06, 68.65it/s, epoch=40/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.66it/s, epoch=40/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 681/1143 [00:10<00:06, 68.09it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.24it/s, epoch=41/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 682/1143 [00:10<00:06, 68.19it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 67.97it/s, epoch=42/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 675/1143 [00:10<00:06, 67.47it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 67.17it/s, epoch=43/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 678/1143 [00:10<00:06, 67.71it/s, epoch=44/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 67.98it/s, epoch=44/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 678/1143 [00:10<00:06, 67.80it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:16<00:00, 67.72it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 686/1143 [00:10<00:06, 68.51it/s, epoch=46/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 68.35it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 673/1143 [00:10<00:06, 67.27it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:16<00:00, 68.00it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 687/1143 [00:10<00:06, 68.64it/s, epoch=48/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.37it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 686/1143 [00:10<00:06, 68.58it/s, epoch=49/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.43it/s, epoch=49/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 683/1143 [00:10<00:06, 68.25it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:16<00:00, 67.99it/s, epoch=50/50, avg_epoch_loss=0.178]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 2, 'global_layers': 5, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
Loading data took 3.5813078694045544 seconds
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 2, 'global_layers': 5, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 849.596766397357 seconds
Creating forecasts took 150.47518371790648 seconds
 Start rescaling
Rescaling took 401.7440236955881 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 630/1143 [00:10<00:08, 62.91it/s, epoch=1/50, avg_epoch_loss=0.247]100%|██████████| 1143/1143 [00:18<00:00, 63.39it/s, epoch=1/50, avg_epoch_loss=0.218]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 646/1143 [00:10<00:07, 64.55it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:17<00:00, 64.54it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 647/1143 [00:10<00:07, 64.65it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 64.43it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 647/1143 [00:10<00:07, 64.69it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 64.79it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 653/1143 [00:10<00:07, 65.21it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 65.11it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 652/1143 [00:10<00:07, 65.18it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:17<00:00, 64.98it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 643/1143 [00:10<00:07, 64.30it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 64.80it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 650/1143 [00:10<00:07, 65.00it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 64.76it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 641/1143 [00:10<00:07, 64.08it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 64.02it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 643/1143 [00:10<00:07, 64.23it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 64.36it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 638/1143 [00:10<00:07, 63.75it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 64.07it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 638/1143 [00:10<00:07, 63.70it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 64.35it/s, epoch=12/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 655/1143 [00:10<00:07, 65.42it/s, epoch=13/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 65.31it/s, epoch=13/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 656/1143 [00:10<00:07, 65.51it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 65.25it/s, epoch=14/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 652/1143 [00:10<00:07, 65.17it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 65.08it/s, epoch=15/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 647/1143 [00:10<00:07, 64.68it/s, epoch=16/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 64.79it/s, epoch=16/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 649/1143 [00:10<00:07, 64.88it/s, epoch=17/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 64.16it/s, epoch=17/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 638/1143 [00:10<00:07, 63.80it/s, epoch=18/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 63.26it/s, epoch=18/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 613/1143 [00:10<00:08, 61.25it/s, epoch=19/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 62.32it/s, epoch=19/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 643/1143 [00:10<00:07, 64.26it/s, epoch=20/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 64.11it/s, epoch=20/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 645/1143 [00:10<00:07, 64.50it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 63.93it/s, epoch=21/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 632/1143 [00:10<00:08, 63.18it/s, epoch=22/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 63.59it/s, epoch=22/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 58%|█████▊    | 661/1143 [00:10<00:07, 66.08it/s, epoch=23/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 65.36it/s, epoch=23/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 651/1143 [00:10<00:07, 65.00it/s, epoch=24/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 64.87it/s, epoch=24/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 58%|█████▊    | 658/1143 [00:10<00:07, 65.70it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 65.47it/s, epoch=25/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 651/1143 [00:10<00:07, 65.00it/s, epoch=26/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 65.15it/s, epoch=26/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 656/1143 [00:10<00:07, 65.53it/s, epoch=27/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 65.18it/s, epoch=27/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 650/1143 [00:10<00:07, 64.96it/s, epoch=28/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 64.65it/s, epoch=28/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 642/1143 [00:10<00:07, 64.19it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 64.33it/s, epoch=29/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 656/1143 [00:10<00:07, 65.58it/s, epoch=30/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 65.10it/s, epoch=30/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 651/1143 [00:10<00:07, 65.01it/s, epoch=31/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 65.25it/s, epoch=31/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 656/1143 [00:10<00:07, 65.54it/s, epoch=32/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 64.52it/s, epoch=32/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 656/1143 [00:10<00:07, 65.52it/s, epoch=33/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 65.38it/s, epoch=33/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 657/1143 [00:10<00:07, 65.65it/s, epoch=34/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 65.60it/s, epoch=34/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 652/1143 [00:10<00:07, 65.16it/s, epoch=35/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 65.38it/s, epoch=35/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 653/1143 [00:10<00:07, 65.25it/s, epoch=36/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 65.40it/s, epoch=36/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 58%|█████▊    | 659/1143 [00:10<00:07, 65.89it/s, epoch=37/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 65.68it/s, epoch=37/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 644/1143 [00:10<00:07, 64.36it/s, epoch=38/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 64.56it/s, epoch=38/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 644/1143 [00:10<00:07, 64.39it/s, epoch=39/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 64.23it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 647/1143 [00:10<00:07, 64.68it/s, epoch=40/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 64.22it/s, epoch=40/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 649/1143 [00:10<00:07, 64.86it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 64.95it/s, epoch=41/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 655/1143 [00:10<00:07, 65.45it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 65.43it/s, epoch=42/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 656/1143 [00:10<00:07, 65.56it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 65.36it/s, epoch=43/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 657/1143 [00:10<00:07, 65.68it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 65.60it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 651/1143 [00:10<00:07, 65.09it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 65.32it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 58%|█████▊    | 661/1143 [00:10<00:07, 66.05it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 65.64it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 655/1143 [00:10<00:07, 65.49it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 65.20it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 651/1143 [00:10<00:07, 65.06it/s, epoch=48/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 65.25it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 652/1143 [00:10<00:07, 65.14it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 65.34it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 642/1143 [00:10<00:07, 64.11it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 64.44it/s, epoch=50/50, avg_epoch_loss=0.178]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 69.37420453131199 seconds
Parameter global_units with value 2 had evaluation 2.3593511464243764
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 5, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 882.8942796513438 seconds
Creating forecasts took 150.73962549306452 seconds
 Start rescaling
Rescaling took 402.6707695759833 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 638/1143 [00:10<00:07, 63.71it/s, epoch=1/50, avg_epoch_loss=0.232]100%|██████████| 1143/1143 [00:18<00:00, 63.32it/s, epoch=1/50, avg_epoch_loss=0.209]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 634/1143 [00:10<00:08, 63.35it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:17<00:00, 64.06it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 642/1143 [00:10<00:07, 64.14it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 63.93it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 644/1143 [00:10<00:07, 64.33it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:17<00:00, 64.36it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 636/1143 [00:10<00:07, 63.52it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 63.85it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 642/1143 [00:10<00:07, 64.10it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:17<00:00, 64.24it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 651/1143 [00:10<00:07, 65.02it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 65.00it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 644/1143 [00:10<00:07, 64.35it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 63.67it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 644/1143 [00:10<00:07, 64.36it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 64.56it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 642/1143 [00:10<00:07, 64.15it/s, epoch=10/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 64.51it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 643/1143 [00:10<00:07, 64.22it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 64.02it/s, epoch=11/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 624/1143 [00:10<00:08, 62.35it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.90it/s, epoch=12/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 633/1143 [00:10<00:08, 63.27it/s, epoch=13/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 63.23it/s, epoch=13/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 637/1143 [00:10<00:07, 63.68it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 63.75it/s, epoch=14/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 642/1143 [00:10<00:07, 64.11it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 64.34it/s, epoch=15/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 648/1143 [00:10<00:07, 64.79it/s, epoch=16/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 64.64it/s, epoch=16/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 648/1143 [00:10<00:07, 64.74it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 64.96it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 643/1143 [00:10<00:07, 64.28it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 64.53it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 638/1143 [00:10<00:07, 63.79it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 64.43it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 645/1143 [00:10<00:07, 64.49it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 64.58it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 649/1143 [00:10<00:07, 64.81it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 64.69it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 644/1143 [00:10<00:07, 64.38it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 64.24it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 641/1143 [00:10<00:07, 64.03it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 63.17it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 638/1143 [00:10<00:07, 63.74it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 63.87it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 645/1143 [00:10<00:07, 64.50it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 64.77it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 648/1143 [00:10<00:07, 64.76it/s, epoch=26/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 64.31it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 641/1143 [00:10<00:07, 64.07it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 64.36it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 648/1143 [00:10<00:07, 64.71it/s, epoch=28/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 64.72it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 648/1143 [00:10<00:07, 64.73it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 64.48it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 643/1143 [00:10<00:07, 64.30it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 64.26it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 632/1143 [00:10<00:08, 63.11it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 62.71it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 632/1143 [00:10<00:08, 63.12it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 63.30it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 624/1143 [00:10<00:08, 62.32it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 62.30it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 640/1143 [00:10<00:07, 63.92it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 63.66it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 636/1143 [00:10<00:07, 63.56it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 63.85it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 642/1143 [00:10<00:07, 64.12it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 64.36it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 650/1143 [00:10<00:07, 64.94it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 64.63it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 643/1143 [00:10<00:07, 64.21it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 64.44it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 644/1143 [00:10<00:07, 64.33it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 64.52it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 645/1143 [00:10<00:07, 64.46it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 62.86it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 643/1143 [00:10<00:07, 64.24it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 64.17it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 644/1143 [00:10<00:07, 64.34it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 63.92it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 643/1143 [00:10<00:07, 64.26it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 64.11it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 633/1143 [00:10<00:08, 63.22it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 63.23it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 639/1143 [00:10<00:07, 63.89it/s, epoch=45/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:18<00:00, 63.48it/s, epoch=45/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 641/1143 [00:10<00:07, 64.08it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 63.92it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 637/1143 [00:10<00:07, 63.63it/s, epoch=47/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:17<00:00, 63.83it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 642/1143 [00:10<00:07, 64.16it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 64.21it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 639/1143 [00:10<00:07, 63.83it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 64.14it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 651/1143 [00:10<00:07, 65.06it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 64.65it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 79.59130154363811 seconds
Parameter global_units with value 4 had evaluation 2.1223329890391525
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 6, 'global_layers': 5, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 892.9357119910419 seconds
Creating forecasts took 153.00131320394576 seconds
 Start rescaling
Rescaling took 400.90106661990285 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.64it/s, epoch=1/50, avg_epoch_loss=0.237]100%|██████████| 1143/1143 [00:19<00:00, 60.06it/s, epoch=1/50, avg_epoch_loss=0.21]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.63it/s, epoch=2/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.98it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 609/1143 [00:10<00:08, 60.89it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 60.67it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 615/1143 [00:10<00:08, 61.44it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 61.33it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 605/1143 [00:10<00:08, 60.45it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 60.78it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.31it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 60.67it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 605/1143 [00:10<00:08, 60.44it/s, epoch=7/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 60.81it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 602/1143 [00:10<00:08, 60.14it/s, epoch=8/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 60.46it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 606/1143 [00:10<00:08, 60.57it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 60.45it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 594/1143 [00:10<00:09, 59.29it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.27it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 591/1143 [00:10<00:09, 59.08it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.66it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 59.91it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.30it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.08it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.65it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 611/1143 [00:10<00:08, 61.05it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.27it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 619/1143 [00:10<00:08, 61.89it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.76it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 606/1143 [00:10<00:08, 60.52it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.50it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 614/1143 [00:10<00:08, 61.34it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.34it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 620/1143 [00:10<00:08, 61.96it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.71it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 625/1143 [00:10<00:08, 62.48it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 62.07it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 613/1143 [00:10<00:08, 61.29it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.35it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 617/1143 [00:10<00:08, 61.70it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 61.71it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 618/1143 [00:10<00:08, 61.75it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.66it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 617/1143 [00:10<00:08, 61.66it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 61.90it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 609/1143 [00:10<00:08, 60.88it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.00it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 612/1143 [00:10<00:08, 61.11it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 61.16it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 616/1143 [00:10<00:08, 61.55it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.51it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 609/1143 [00:10<00:08, 60.83it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.73it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 617/1143 [00:10<00:08, 61.63it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.32it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 621/1143 [00:10<00:08, 62.05it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 61.90it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 614/1143 [00:10<00:08, 61.37it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.27it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 627/1143 [00:10<00:08, 62.65it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 62.42it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 608/1143 [00:10<00:08, 60.72it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.31it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 614/1143 [00:10<00:08, 61.31it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.60it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 621/1143 [00:10<00:08, 62.03it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 61.51it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 606/1143 [00:10<00:08, 60.51it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.33it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 619/1143 [00:10<00:08, 61.88it/s, epoch=36/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.37it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 615/1143 [00:10<00:08, 61.41it/s, epoch=37/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.45it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 614/1143 [00:10<00:08, 61.38it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 61.17it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 616/1143 [00:10<00:08, 61.60it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 61.45it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 615/1143 [00:10<00:08, 61.43it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 61.26it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 614/1143 [00:10<00:08, 61.32it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.45it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 618/1143 [00:10<00:08, 61.74it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.04it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 614/1143 [00:10<00:08, 61.38it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.43it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 614/1143 [00:10<00:08, 61.36it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 61.13it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.19it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 60.07it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 610/1143 [00:10<00:08, 60.94it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 61.59it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 612/1143 [00:10<00:08, 61.20it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 61.07it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 619/1143 [00:10<00:08, 61.86it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 61.89it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 616/1143 [00:10<00:08, 61.57it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 62.12it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.69it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.63it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 87.571363652125 seconds
Parameter global_units with value 6 had evaluation 2.2829276251503923
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 8, 'global_layers': 5, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 936.0800240151584 seconds
Creating forecasts took 155.27871957048774 seconds
 Start rescaling
Rescaling took 400.73685340583324 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 586/1143 [00:10<00:09, 58.57it/s, epoch=1/50, avg_epoch_loss=0.224]100%|██████████| 1143/1143 [00:19<00:00, 58.75it/s, epoch=1/50, avg_epoch_loss=0.204]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 585/1143 [00:10<00:09, 58.47it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.00it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 593/1143 [00:10<00:09, 59.23it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.00it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 581/1143 [00:10<00:09, 58.03it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 57.83it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.09it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 57.12it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 57.12it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 577/1143 [00:10<00:09, 57.62it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 57.94it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 578/1143 [00:10<00:09, 57.76it/s, epoch=7/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 57.52it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 584/1143 [00:10<00:09, 58.33it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 57.75it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 576/1143 [00:10<00:09, 57.59it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 57.89it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 596/1143 [00:10<00:09, 59.56it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.27it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.89it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.81it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.43it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 57.14it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 581/1143 [00:10<00:09, 58.04it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 57.99it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 587/1143 [00:10<00:09, 58.69it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.02it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 570/1143 [00:10<00:10, 56.92it/s, epoch=15/50, avg_epoch_loss=0.178]100%|█████████▉| 1140/1143 [00:20<00:00, 56.76it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.79it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 576/1143 [00:10<00:09, 57.55it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.69it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 577/1143 [00:10<00:09, 57.61it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.33it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 577/1143 [00:10<00:09, 57.65it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.65it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 584/1143 [00:10<00:09, 58.32it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.81it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 584/1143 [00:10<00:09, 58.31it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.98it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 579/1143 [00:10<00:09, 57.85it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.06it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 582/1143 [00:10<00:09, 58.13it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.15it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 583/1143 [00:10<00:09, 58.26it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.46it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 590/1143 [00:10<00:09, 58.92it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.73it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 574/1143 [00:10<00:09, 57.38it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.96it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 579/1143 [00:10<00:09, 57.80it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.31it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 583/1143 [00:10<00:09, 58.25it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.85it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 579/1143 [00:10<00:09, 57.85it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.97it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 588/1143 [00:10<00:09, 58.80it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.45it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 587/1143 [00:10<00:09, 58.65it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.49it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 586/1143 [00:10<00:09, 58.54it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.23it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 579/1143 [00:10<00:09, 57.89it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.44it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 576/1143 [00:10<00:09, 57.53it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.75it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 574/1143 [00:10<00:09, 57.40it/s, epoch=34/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:20<00:00, 57.09it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.18it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.54it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 574/1143 [00:10<00:09, 57.35it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.16it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 584/1143 [00:10<00:09, 58.39it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.49it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 577/1143 [00:10<00:09, 57.62it/s, epoch=38/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.07it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 583/1143 [00:10<00:09, 58.21it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.22it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 587/1143 [00:10<00:09, 58.64it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.53it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 591/1143 [00:10<00:09, 59.10it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.74it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.81it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.58it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 582/1143 [00:10<00:09, 58.15it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.95it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 568/1143 [00:10<00:10, 56.71it/s, epoch=44/50, avg_epoch_loss=0.177] 99%|█████████▉| 1136/1143 [00:20<00:00, 56.64it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.63it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 568/1143 [00:10<00:10, 56.71it/s, epoch=45/50, avg_epoch_loss=0.176]100%|█████████▉| 1139/1143 [00:20<00:00, 56.94it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.90it/s, epoch=45/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 580/1143 [00:10<00:09, 57.90it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.64it/s, epoch=46/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 576/1143 [00:10<00:09, 57.59it/s, epoch=47/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 57.54it/s, epoch=47/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.14it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.27it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 582/1143 [00:10<00:09, 58.10it/s, epoch=49/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 57.85it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 573/1143 [00:10<00:09, 57.27it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.48it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 89.13687501102686 seconds
Parameter global_units with value 8 had evaluation 2.3390457175015174
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 10, 'global_layers': 5, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 987.6082725152373 seconds
Creating forecasts took 165.549529267475 seconds
 Start rescaling
Rescaling took 401.2943139746785 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 611/1143 [00:10<00:08, 61.03it/s, epoch=1/50, avg_epoch_loss=0.231]100%|██████████| 1143/1143 [00:18<00:00, 61.70it/s, epoch=1/50, avg_epoch_loss=0.208]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 613/1143 [00:10<00:08, 61.30it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:18<00:00, 61.82it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 624/1143 [00:10<00:08, 62.32it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 62.25it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 636/1143 [00:10<00:07, 63.51it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 63.17it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 624/1143 [00:10<00:08, 62.39it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 62.29it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 623/1143 [00:10<00:08, 62.23it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 62.48it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 615/1143 [00:10<00:08, 61.42it/s, epoch=7/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 61.98it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 621/1143 [00:10<00:08, 62.06it/s, epoch=8/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 62.18it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 633/1143 [00:10<00:08, 63.21it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 62.65it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 623/1143 [00:10<00:08, 62.28it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.47it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 603/1143 [00:10<00:08, 60.25it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 60.66it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 614/1143 [00:10<00:08, 61.32it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.56it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 619/1143 [00:10<00:08, 61.83it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 62.04it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 634/1143 [00:10<00:08, 63.32it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 63.10it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 620/1143 [00:10<00:08, 61.95it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.09it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 626/1143 [00:10<00:08, 62.57it/s, epoch=16/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.09it/s, epoch=16/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 619/1143 [00:10<00:08, 61.90it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.77it/s, epoch=17/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 620/1143 [00:10<00:08, 61.93it/s, epoch=18/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.99it/s, epoch=18/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 620/1143 [00:10<00:08, 61.94it/s, epoch=19/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.27it/s, epoch=19/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 613/1143 [00:10<00:08, 61.23it/s, epoch=20/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.70it/s, epoch=20/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 622/1143 [00:10<00:08, 62.15it/s, epoch=21/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.81it/s, epoch=21/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 624/1143 [00:10<00:08, 62.32it/s, epoch=22/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 62.19it/s, epoch=22/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 616/1143 [00:10<00:08, 61.55it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.94it/s, epoch=23/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 618/1143 [00:10<00:08, 61.73it/s, epoch=24/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.89it/s, epoch=24/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 616/1143 [00:10<00:08, 61.57it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.64it/s, epoch=25/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 623/1143 [00:10<00:08, 62.30it/s, epoch=26/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.29it/s, epoch=26/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 606/1143 [00:10<00:08, 60.54it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.46it/s, epoch=27/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 606/1143 [00:10<00:08, 60.60it/s, epoch=28/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.06it/s, epoch=28/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 610/1143 [00:10<00:08, 60.99it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.96it/s, epoch=29/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 610/1143 [00:10<00:08, 60.99it/s, epoch=30/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.11it/s, epoch=30/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 616/1143 [00:10<00:08, 61.52it/s, epoch=31/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.45it/s, epoch=31/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 624/1143 [00:10<00:08, 62.31it/s, epoch=32/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.66it/s, epoch=32/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 621/1143 [00:10<00:08, 62.03it/s, epoch=33/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.89it/s, epoch=33/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 618/1143 [00:10<00:08, 61.74it/s, epoch=34/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.88it/s, epoch=34/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 620/1143 [00:10<00:08, 61.97it/s, epoch=35/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.12it/s, epoch=35/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 621/1143 [00:10<00:08, 62.10it/s, epoch=36/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.35it/s, epoch=36/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 615/1143 [00:10<00:08, 61.44it/s, epoch=37/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.44it/s, epoch=37/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 620/1143 [00:10<00:08, 61.96it/s, epoch=38/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.31it/s, epoch=38/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 621/1143 [00:10<00:08, 62.00it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.68it/s, epoch=39/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 611/1143 [00:10<00:08, 61.06it/s, epoch=40/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.68it/s, epoch=40/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 613/1143 [00:10<00:08, 61.26it/s, epoch=41/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.43it/s, epoch=41/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 621/1143 [00:10<00:08, 62.05it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 62.19it/s, epoch=42/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 620/1143 [00:10<00:08, 61.95it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.84it/s, epoch=43/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 613/1143 [00:10<00:08, 61.28it/s, epoch=44/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.49it/s, epoch=44/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 619/1143 [00:10<00:08, 61.80it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 61.26it/s, epoch=45/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 616/1143 [00:10<00:08, 61.56it/s, epoch=46/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.78it/s, epoch=46/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.71it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.18it/s, epoch=47/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 605/1143 [00:10<00:08, 60.50it/s, epoch=48/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.63it/s, epoch=48/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 611/1143 [00:10<00:08, 61.08it/s, epoch=49/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.55it/s, epoch=49/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 616/1143 [00:10<00:08, 61.59it/s, epoch=50/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.70it/s, epoch=50/50, avg_epoch_loss=0.179]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 82.49840826541185 seconds
Parameter global_units with value 10 had evaluation 2.482500597789276
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 12, 'global_layers': 5, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 926.4538642279804 seconds
Creating forecasts took 155.40940069779754 seconds
 Start rescaling
Rescaling took 401.83753815479577 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.18it/s, epoch=1/50, avg_epoch_loss=0.223]100%|██████████| 1143/1143 [00:19<00:00, 57.30it/s, epoch=1/50, avg_epoch_loss=0.203]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 577/1143 [00:10<00:09, 57.64it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 58.13it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 594/1143 [00:10<00:09, 59.39it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.85it/s, epoch=3/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.08it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 60.14it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.04it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 58.04it/s, epoch=5/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 599/1143 [00:10<00:09, 59.85it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.42it/s, epoch=6/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.15it/s, epoch=7/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.50it/s, epoch=7/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.79it/s, epoch=8/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.08it/s, epoch=8/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.10it/s, epoch=9/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 57.28it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 574/1143 [00:10<00:09, 57.40it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 57.42it/s, epoch=10/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.04it/s, epoch=11/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 57.39it/s, epoch=11/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 59.90it/s, epoch=12/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.93it/s, epoch=12/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 591/1143 [00:10<00:09, 59.05it/s, epoch=13/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.10it/s, epoch=13/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 594/1143 [00:10<00:09, 59.32it/s, epoch=14/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.30it/s, epoch=14/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 582/1143 [00:10<00:09, 58.14it/s, epoch=15/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 58.32it/s, epoch=15/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 588/1143 [00:10<00:09, 58.71it/s, epoch=16/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 58.44it/s, epoch=16/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 570/1143 [00:10<00:10, 56.93it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 57.14it/s, epoch=17/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.10it/s, epoch=18/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.79it/s, epoch=18/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.14it/s, epoch=19/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.94it/s, epoch=19/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.16it/s, epoch=20/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.00it/s, epoch=20/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.14it/s, epoch=21/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.37it/s, epoch=21/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 602/1143 [00:10<00:08, 60.19it/s, epoch=22/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.55it/s, epoch=22/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 603/1143 [00:10<00:08, 60.26it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.45it/s, epoch=23/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 581/1143 [00:10<00:09, 58.09it/s, epoch=24/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.82it/s, epoch=24/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 596/1143 [00:10<00:09, 59.57it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.90it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 602/1143 [00:10<00:08, 60.14it/s, epoch=26/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.92it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 588/1143 [00:10<00:09, 58.72it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.24it/s, epoch=27/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.18it/s, epoch=28/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.40it/s, epoch=28/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.11it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.18it/s, epoch=29/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.87it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.35it/s, epoch=30/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.01it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 60.16it/s, epoch=31/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 593/1143 [00:10<00:09, 59.21it/s, epoch=32/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.78it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 609/1143 [00:10<00:08, 60.80it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.41it/s, epoch=33/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 605/1143 [00:10<00:08, 60.46it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.21it/s, epoch=34/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.76it/s, epoch=35/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.87it/s, epoch=35/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 608/1143 [00:10<00:08, 60.71it/s, epoch=36/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.76it/s, epoch=36/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 605/1143 [00:10<00:08, 60.47it/s, epoch=37/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.23it/s, epoch=37/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.72it/s, epoch=38/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.80it/s, epoch=38/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.66it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.99it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 603/1143 [00:10<00:08, 60.20it/s, epoch=40/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.51it/s, epoch=40/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 599/1143 [00:10<00:09, 59.83it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.13it/s, epoch=41/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 603/1143 [00:10<00:08, 60.20it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.94it/s, epoch=42/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 593/1143 [00:10<00:09, 59.22it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.95it/s, epoch=43/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 605/1143 [00:10<00:08, 60.48it/s, epoch=44/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 60.08it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 595/1143 [00:10<00:09, 59.44it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.56it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 595/1143 [00:10<00:09, 59.48it/s, epoch=46/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.96it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 606/1143 [00:10<00:08, 60.53it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.90it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 593/1143 [00:10<00:09, 59.30it/s, epoch=48/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.27it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 587/1143 [00:10<00:09, 58.63it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.34it/s, epoch=49/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 595/1143 [00:10<00:09, 59.43it/s, epoch=50/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.54it/s, epoch=50/50, avg_epoch_loss=0.178]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 86.07910193502903 seconds
Parameter global_units with value 12 had evaluation 2.304657652532916
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 14, 'global_layers': 5, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 966.3130057659 seconds
Creating forecasts took 158.36348541267216 seconds
 Start rescaling
Rescaling took 400.4918304234743 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 575/1143 [00:10<00:09, 57.47it/s, epoch=1/50, avg_epoch_loss=0.235]100%|██████████| 1143/1143 [00:19<00:00, 57.88it/s, epoch=1/50, avg_epoch_loss=0.209]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.09it/s, epoch=2/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 57.40it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.73it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 58.82it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.16it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.02it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.49it/s, epoch=5/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 57.93it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.02it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 58.98it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 585/1143 [00:10<00:09, 58.42it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 58.28it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 576/1143 [00:10<00:09, 57.51it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 57.52it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 583/1143 [00:10<00:09, 58.27it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 58.51it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 579/1143 [00:10<00:09, 57.85it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 57.62it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 578/1143 [00:10<00:09, 57.72it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 58.30it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 581/1143 [00:10<00:09, 58.10it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.63it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 590/1143 [00:10<00:09, 58.96it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.58it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 588/1143 [00:10<00:09, 58.73it/s, epoch=14/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 58.47it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 588/1143 [00:10<00:09, 58.73it/s, epoch=15/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 58.77it/s, epoch=15/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 585/1143 [00:10<00:09, 58.44it/s, epoch=16/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.30it/s, epoch=16/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.20it/s, epoch=17/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 58.63it/s, epoch=17/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 584/1143 [00:10<00:09, 58.33it/s, epoch=18/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.04it/s, epoch=18/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 584/1143 [00:10<00:09, 58.36it/s, epoch=19/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.32it/s, epoch=19/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 578/1143 [00:10<00:09, 57.71it/s, epoch=20/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 57.88it/s, epoch=20/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 588/1143 [00:10<00:09, 58.73it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.94it/s, epoch=21/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.14it/s, epoch=22/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.66it/s, epoch=22/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.89it/s, epoch=23/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.24it/s, epoch=23/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 580/1143 [00:10<00:09, 57.99it/s, epoch=24/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.26it/s, epoch=24/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 583/1143 [00:10<00:09, 58.22it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.33it/s, epoch=25/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.16it/s, epoch=26/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 58.86it/s, epoch=26/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 581/1143 [00:10<00:09, 58.04it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.87it/s, epoch=27/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 580/1143 [00:10<00:09, 57.97it/s, epoch=28/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 57.98it/s, epoch=28/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 578/1143 [00:10<00:09, 57.75it/s, epoch=29/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 57.72it/s, epoch=29/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 577/1143 [00:10<00:09, 57.68it/s, epoch=30/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 57.82it/s, epoch=30/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 581/1143 [00:10<00:09, 58.01it/s, epoch=31/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.63it/s, epoch=31/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.70it/s, epoch=32/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.14it/s, epoch=32/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.14it/s, epoch=33/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.71it/s, epoch=33/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 591/1143 [00:10<00:09, 59.03it/s, epoch=34/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.59it/s, epoch=34/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 590/1143 [00:10<00:09, 58.95it/s, epoch=35/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.99it/s, epoch=35/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 590/1143 [00:10<00:09, 58.96it/s, epoch=36/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.43it/s, epoch=36/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.07it/s, epoch=37/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 57.14it/s, epoch=37/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 57.12it/s, epoch=37/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 581/1143 [00:10<00:09, 58.09it/s, epoch=38/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.96it/s, epoch=38/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 583/1143 [00:10<00:09, 58.22it/s, epoch=39/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.15it/s, epoch=39/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 583/1143 [00:10<00:09, 58.22it/s, epoch=40/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.66it/s, epoch=40/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.74it/s, epoch=41/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.16it/s, epoch=41/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 594/1143 [00:10<00:09, 59.33it/s, epoch=42/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.16it/s, epoch=42/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 584/1143 [00:10<00:09, 58.37it/s, epoch=43/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.67it/s, epoch=43/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 588/1143 [00:10<00:09, 58.75it/s, epoch=44/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.82it/s, epoch=44/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 581/1143 [00:10<00:09, 58.07it/s, epoch=45/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.36it/s, epoch=45/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 586/1143 [00:10<00:09, 58.55it/s, epoch=46/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.50it/s, epoch=46/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 573/1143 [00:10<00:09, 57.22it/s, epoch=47/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.87it/s, epoch=47/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 586/1143 [00:10<00:09, 58.55it/s, epoch=48/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.17it/s, epoch=48/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 593/1143 [00:10<00:09, 59.21it/s, epoch=49/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.73it/s, epoch=49/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 579/1143 [00:10<00:09, 57.87it/s, epoch=50/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.15it/s, epoch=50/50, avg_epoch_loss=0.179]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 89.37640660628676 seconds
Parameter global_units with value 14 had evaluation 2.2759287273074253
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 16, 'global_layers': 5, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 979.5910896640271 seconds
Creating forecasts took 167.25154251232743 seconds
 Start rescaling
Rescaling took 402.43072953633964 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.18it/s, epoch=1/50, avg_epoch_loss=0.222]100%|██████████| 1143/1143 [00:19<00:00, 57.17it/s, epoch=1/50, avg_epoch_loss=0.202]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 582/1143 [00:10<00:09, 58.13it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 58.00it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 582/1143 [00:10<00:09, 58.19it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 58.05it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 580/1143 [00:10<00:09, 57.96it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 57.48it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 576/1143 [00:10<00:09, 57.59it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 57.73it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 576/1143 [00:10<00:09, 57.54it/s, epoch=6/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 57.42it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 568/1143 [00:10<00:10, 56.74it/s, epoch=7/50, avg_epoch_loss=0.18] 99%|█████████▉| 1136/1143 [00:20<00:00, 56.72it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.73it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.73it/s, epoch=8/50, avg_epoch_loss=0.179] 99%|█████████▊| 1127/1143 [00:20<00:00, 56.40it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.32it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.70it/s, epoch=9/50, avg_epoch_loss=0.179] 99%|█████████▊| 1127/1143 [00:20<00:00, 56.36it/s, epoch=9/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.30it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.08it/s, epoch=10/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.34it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 574/1143 [00:10<00:09, 57.36it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 57.67it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 578/1143 [00:10<00:09, 57.77it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.93it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 581/1143 [00:10<00:09, 58.06it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.11it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.09it/s, epoch=14/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.50it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 575/1143 [00:10<00:09, 57.49it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.56it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.13it/s, epoch=16/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.89it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.33it/s, epoch=17/50, avg_epoch_loss=0.178] 99%|█████████▉| 1133/1143 [00:20<00:00, 56.61it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.56it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 569/1143 [00:10<00:10, 56.88it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.19it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 579/1143 [00:10<00:09, 57.85it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.32it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.14it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.37it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 575/1143 [00:10<00:09, 57.50it/s, epoch=21/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 57.43it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 577/1143 [00:10<00:09, 57.68it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.57it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.69it/s, epoch=23/50, avg_epoch_loss=0.177]100%|█████████▉| 1140/1143 [00:20<00:00, 57.04it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 57.00it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 573/1143 [00:10<00:09, 57.28it/s, epoch=24/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 57.40it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 573/1143 [00:10<00:09, 57.25it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.74it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.78it/s, epoch=26/50, avg_epoch_loss=0.178] 99%|█████████▉| 1131/1143 [00:20<00:00, 56.66it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.50it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.39it/s, epoch=27/50, avg_epoch_loss=0.177] 99%|█████████▉| 1137/1143 [00:20<00:00, 56.91it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.84it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 569/1143 [00:10<00:10, 56.84it/s, epoch=28/50, avg_epoch_loss=0.178]100%|█████████▉| 1141/1143 [00:20<00:00, 57.04it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 57.01it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 575/1143 [00:10<00:09, 57.42it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.57it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 566/1143 [00:10<00:10, 56.58it/s, epoch=30/50, avg_epoch_loss=0.177]100%|█████████▉| 1141/1143 [00:20<00:00, 57.10it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 57.00it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.12it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.68it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.24it/s, epoch=32/50, avg_epoch_loss=0.178]100%|█████████▉| 1139/1143 [00:20<00:00, 57.02it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.91it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 576/1143 [00:10<00:09, 57.52it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.63it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 573/1143 [00:10<00:09, 57.22it/s, epoch=34/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:20<00:00, 56.76it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.02it/s, epoch=35/50, avg_epoch_loss=0.178] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.77it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.75it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.65it/s, epoch=36/50, avg_epoch_loss=0.176] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.30it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.36it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 566/1143 [00:10<00:10, 56.55it/s, epoch=37/50, avg_epoch_loss=0.177] 99%|█████████▉| 1135/1143 [00:20<00:00, 56.73it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.70it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.99it/s, epoch=38/50, avg_epoch_loss=0.177]100%|█████████▉| 1138/1143 [00:20<00:00, 57.05it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.89it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 576/1143 [00:10<00:09, 57.59it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.84it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 581/1143 [00:10<00:09, 58.09it/s, epoch=40/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 57.90it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.08it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.97it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 584/1143 [00:10<00:09, 58.37it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.98it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 580/1143 [00:10<00:09, 57.92it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.89it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.18it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.71it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.09it/s, epoch=45/50, avg_epoch_loss=0.177] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.34it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.34it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 577/1143 [00:10<00:09, 57.66it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.45it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 575/1143 [00:10<00:09, 57.45it/s, epoch=47/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:20<00:00, 57.04it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.07it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.28it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 584/1143 [00:10<00:09, 58.36it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.94it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.05it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.52it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 89.3253077249974 seconds
Parameter global_units with value 16 had evaluation 2.3930147608956904
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 18, 'global_layers': 5, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 998.8310102596879 seconds
Creating forecasts took 162.74572910368443 seconds
 Start rescaling
Rescaling took 404.91396095231175 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 588/1143 [00:10<00:09, 58.77it/s, epoch=1/50, avg_epoch_loss=0.219]100%|██████████| 1143/1143 [00:19<00:00, 58.96it/s, epoch=1/50, avg_epoch_loss=0.2] 
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 596/1143 [00:10<00:09, 59.55it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.57it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.01it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 60.30it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 595/1143 [00:10<00:09, 59.49it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.33it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 607/1143 [00:10<00:08, 60.66it/s, epoch=5/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 60.61it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.78it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.76it/s, epoch=6/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 602/1143 [00:10<00:08, 60.12it/s, epoch=7/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.64it/s, epoch=7/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.81it/s, epoch=8/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 58.80it/s, epoch=8/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 590/1143 [00:10<00:09, 58.93it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 58.81it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 587/1143 [00:10<00:09, 58.65it/s, epoch=10/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 58.66it/s, epoch=10/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 588/1143 [00:10<00:09, 58.77it/s, epoch=11/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.30it/s, epoch=11/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 605/1143 [00:10<00:08, 60.48it/s, epoch=12/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 60.75it/s, epoch=12/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 620/1143 [00:10<00:08, 61.91it/s, epoch=13/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 61.83it/s, epoch=13/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.40it/s, epoch=14/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 60.07it/s, epoch=14/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 59.94it/s, epoch=15/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 60.44it/s, epoch=15/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.08it/s, epoch=16/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 60.14it/s, epoch=16/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 607/1143 [00:10<00:08, 60.66it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.18it/s, epoch=17/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 607/1143 [00:10<00:08, 60.62it/s, epoch=18/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 61.03it/s, epoch=18/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 614/1143 [00:10<00:08, 61.38it/s, epoch=19/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 61.28it/s, epoch=19/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 611/1143 [00:10<00:08, 61.06it/s, epoch=20/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.24it/s, epoch=20/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 613/1143 [00:10<00:08, 61.30it/s, epoch=21/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.86it/s, epoch=21/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 609/1143 [00:10<00:08, 60.84it/s, epoch=22/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 60.60it/s, epoch=22/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 599/1143 [00:10<00:09, 59.83it/s, epoch=23/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.68it/s, epoch=23/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 607/1143 [00:10<00:08, 60.70it/s, epoch=24/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.00it/s, epoch=24/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 618/1143 [00:10<00:08, 61.76it/s, epoch=25/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.85it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 59.92it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.32it/s, epoch=26/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 59.96it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.90it/s, epoch=27/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 608/1143 [00:10<00:08, 60.76it/s, epoch=28/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.32it/s, epoch=28/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 603/1143 [00:10<00:08, 60.27it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.18it/s, epoch=29/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.68it/s, epoch=30/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.97it/s, epoch=30/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.65it/s, epoch=31/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.86it/s, epoch=31/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.35it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.25it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 596/1143 [00:10<00:09, 59.56it/s, epoch=33/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.25it/s, epoch=33/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.10it/s, epoch=34/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.26it/s, epoch=34/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 603/1143 [00:10<00:08, 60.21it/s, epoch=35/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 60.13it/s, epoch=35/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.37it/s, epoch=36/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.57it/s, epoch=36/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 606/1143 [00:10<00:08, 60.52it/s, epoch=37/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.30it/s, epoch=37/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 611/1143 [00:10<00:08, 60.98it/s, epoch=38/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.90it/s, epoch=38/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 605/1143 [00:10<00:08, 60.41it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.20it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 602/1143 [00:10<00:08, 60.16it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.97it/s, epoch=40/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.67it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 60.04it/s, epoch=41/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 59.98it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.85it/s, epoch=42/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 582/1143 [00:10<00:09, 58.20it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.80it/s, epoch=43/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 603/1143 [00:10<00:08, 60.27it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.97it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 580/1143 [00:10<00:09, 57.92it/s, epoch=45/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.60it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 575/1143 [00:10<00:09, 57.47it/s, epoch=46/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 57.57it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 577/1143 [00:10<00:09, 57.67it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.68it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 584/1143 [00:10<00:09, 58.34it/s, epoch=48/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.15it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 606/1143 [00:10<00:08, 60.51it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.82it/s, epoch=49/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.37it/s, epoch=50/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 60.06it/s, epoch=50/50, avg_epoch_loss=0.178]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 87.62154331430793 seconds
Parameter global_units with value 18 had evaluation 2.510302457320312
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 20, 'global_layers': 5, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 953.9355756901205 seconds
Creating forecasts took 156.93934191204607 seconds
 Start rescaling
Rescaling took 401.6757334638387 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.86it/s, epoch=1/50, avg_epoch_loss=0.23]100%|██████████| 1143/1143 [00:19<00:00, 58.99it/s, epoch=1/50, avg_epoch_loss=0.206]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 596/1143 [00:10<00:09, 59.55it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.74it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.03it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.47it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.77it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.97it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 59.95it/s, epoch=5/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.99it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.65it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.96it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.02it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.49it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 576/1143 [00:10<00:09, 57.57it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 57.81it/s, epoch=8/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 580/1143 [00:10<00:09, 57.93it/s, epoch=9/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.19it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 574/1143 [00:10<00:09, 57.37it/s, epoch=10/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.61it/s, epoch=10/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 585/1143 [00:10<00:09, 58.50it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.92it/s, epoch=11/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 59.95it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.62it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 608/1143 [00:10<00:08, 60.73it/s, epoch=13/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.86it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 586/1143 [00:10<00:09, 58.53it/s, epoch=14/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.88it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 603/1143 [00:10<00:08, 60.22it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.81it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 594/1143 [00:10<00:09, 59.30it/s, epoch=16/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.45it/s, epoch=16/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 595/1143 [00:10<00:09, 59.41it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.24it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 593/1143 [00:10<00:09, 59.22it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.08it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 596/1143 [00:10<00:09, 59.52it/s, epoch=19/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.76it/s, epoch=19/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.61it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.39it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 605/1143 [00:10<00:08, 60.42it/s, epoch=21/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:18<00:00, 60.26it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.83it/s, epoch=22/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.86it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.15it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.49it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 588/1143 [00:10<00:09, 58.73it/s, epoch=24/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.67it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 587/1143 [00:10<00:09, 58.68it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.95it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.12it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.14it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 586/1143 [00:10<00:09, 58.50it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.52it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 577/1143 [00:10<00:09, 57.69it/s, epoch=28/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.94it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 584/1143 [00:10<00:09, 58.34it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.48it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 590/1143 [00:10<00:09, 58.91it/s, epoch=30/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.26it/s, epoch=30/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 585/1143 [00:10<00:09, 58.48it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.39it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.88it/s, epoch=32/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.76it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.85it/s, epoch=33/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.05it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 593/1143 [00:10<00:09, 59.24it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.54it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 595/1143 [00:10<00:09, 59.41it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.10it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 574/1143 [00:10<00:09, 57.38it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.70it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 576/1143 [00:10<00:09, 57.56it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.94it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.18it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.68it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 574/1143 [00:10<00:09, 57.35it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.05it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 595/1143 [00:10<00:09, 59.48it/s, epoch=40/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 59.12it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.88it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.55it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 593/1143 [00:10<00:09, 59.25it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.93it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 581/1143 [00:10<00:09, 58.02it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.09it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 591/1143 [00:10<00:09, 59.06it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.37it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 581/1143 [00:10<00:09, 58.07it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.97it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 587/1143 [00:10<00:09, 58.61it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.19it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 588/1143 [00:10<00:09, 58.72it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.87it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 587/1143 [00:10<00:09, 58.67it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.87it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 584/1143 [00:10<00:09, 58.38it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.37it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.79it/s, epoch=50/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 59.75it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 86.21192185766995 seconds
Parameter global_units with value 20 had evaluation 2.4470711903668314
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 22, 'global_layers': 5, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 970.5143189374357 seconds
Creating forecasts took 158.0079838372767 seconds
 Start rescaling
Rescaling took 401.4566209875047 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 588/1143 [00:10<00:09, 58.80it/s, epoch=1/50, avg_epoch_loss=0.241]100%|██████████| 1143/1143 [00:19<00:00, 59.05it/s, epoch=1/50, avg_epoch_loss=0.212]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 594/1143 [00:10<00:09, 59.31it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.38it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.08it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.30it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.83it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 58.93it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 59.92it/s, epoch=5/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.52it/s, epoch=5/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 59.98it/s, epoch=6/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.30it/s, epoch=6/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 591/1143 [00:10<00:09, 59.06it/s, epoch=7/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.56it/s, epoch=7/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.70it/s, epoch=8/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.49it/s, epoch=8/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.33it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 60.04it/s, epoch=9/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.86it/s, epoch=10/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.83it/s, epoch=10/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 582/1143 [00:10<00:09, 58.15it/s, epoch=11/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.57it/s, epoch=11/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 599/1143 [00:10<00:09, 59.84it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.94it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.08it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.75it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 585/1143 [00:10<00:09, 58.47it/s, epoch=14/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.85it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.62it/s, epoch=15/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.28it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 588/1143 [00:10<00:09, 58.76it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 60.08it/s, epoch=16/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 599/1143 [00:10<00:09, 59.82it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.17it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.13it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.36it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 586/1143 [00:10<00:09, 58.56it/s, epoch=19/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.81it/s, epoch=19/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.79it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.52it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 585/1143 [00:10<00:09, 58.50it/s, epoch=21/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 58.06it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 585/1143 [00:10<00:09, 58.42it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.79it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 593/1143 [00:10<00:09, 59.25it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.37it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 595/1143 [00:10<00:09, 59.41it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.74it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 599/1143 [00:10<00:09, 59.85it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.86it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 593/1143 [00:10<00:09, 59.23it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.98it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.78it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.63it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 607/1143 [00:10<00:08, 60.60it/s, epoch=28/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.54it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 606/1143 [00:10<00:08, 60.55it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.68it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 622/1143 [00:10<00:08, 62.17it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.14it/s, epoch=30/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 588/1143 [00:10<00:09, 58.76it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.91it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.76it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.78it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 602/1143 [00:10<00:08, 60.12it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.84it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.61it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.70it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 599/1143 [00:10<00:09, 59.86it/s, epoch=35/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.61it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 618/1143 [00:10<00:08, 61.79it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 62.07it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 608/1143 [00:10<00:08, 60.71it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.82it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 615/1143 [00:10<00:08, 61.48it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 61.34it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 602/1143 [00:10<00:08, 60.19it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.02it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 623/1143 [00:10<00:08, 62.24it/s, epoch=40/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:18<00:00, 62.16it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 630/1143 [00:10<00:08, 62.99it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 62.48it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 59.92it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.43it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 608/1143 [00:10<00:08, 60.75it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.53it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 612/1143 [00:10<00:08, 61.14it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.87it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.63it/s, epoch=45/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 59.81it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 612/1143 [00:10<00:08, 61.13it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.58it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 616/1143 [00:10<00:08, 61.53it/s, epoch=47/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:18<00:00, 61.39it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 605/1143 [00:10<00:08, 60.44it/s, epoch=48/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.88it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 616/1143 [00:10<00:08, 61.54it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 61.25it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 602/1143 [00:10<00:08, 60.18it/s, epoch=50/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.63it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 84.65868156217039 seconds
Parameter global_units with value 22 had evaluation 2.4134028791217763
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 24, 'global_layers': 5, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 953.2376630157232 seconds
Creating forecasts took 158.93905900418758 seconds
 Start rescaling
Rescaling took 398.91568893380463 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 686/1143 [00:10<00:06, 68.51it/s, epoch=1/50, avg_epoch_loss=0.245]100%|██████████| 1143/1143 [00:16<00:00, 69.54it/s, epoch=1/50, avg_epoch_loss=0.219]
  0%|          | 0/1143 [00:00<?, ?it/s] 63%|██████▎   | 722/1143 [00:10<00:05, 72.15it/s, epoch=2/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 71.20it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 709/1143 [00:10<00:06, 70.82it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 70.82it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 63%|██████▎   | 721/1143 [00:10<00:05, 72.01it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:15<00:00, 71.74it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 703/1143 [00:10<00:06, 70.27it/s, epoch=5/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 70.46it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 708/1143 [00:10<00:06, 70.71it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 70.82it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 708/1143 [00:10<00:06, 70.75it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 70.74it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 709/1143 [00:10<00:06, 70.86it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 70.60it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 694/1143 [00:10<00:06, 69.38it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 69.60it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 710/1143 [00:10<00:06, 70.94it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 70.78it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 707/1143 [00:10<00:06, 70.66it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 70.87it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████▏   | 701/1143 [00:10<00:06, 70.04it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.99it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 704/1143 [00:10<00:06, 70.35it/s, epoch=13/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 70.41it/s, epoch=13/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 63%|██████▎   | 715/1143 [00:10<00:05, 71.42it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 71.02it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 700/1143 [00:10<00:06, 69.97it/s, epoch=15/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 70.40it/s, epoch=15/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 690/1143 [00:10<00:06, 68.94it/s, epoch=16/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.62it/s, epoch=16/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 708/1143 [00:10<00:06, 70.74it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 70.23it/s, epoch=17/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 698/1143 [00:10<00:06, 69.75it/s, epoch=18/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 69.78it/s, epoch=18/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 697/1143 [00:10<00:06, 69.67it/s, epoch=19/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 70.30it/s, epoch=19/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 704/1143 [00:10<00:06, 70.31it/s, epoch=20/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 70.71it/s, epoch=20/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 699/1143 [00:10<00:06, 69.88it/s, epoch=21/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 70.41it/s, epoch=21/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 693/1143 [00:10<00:06, 69.27it/s, epoch=22/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.91it/s, epoch=22/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 704/1143 [00:10<00:06, 70.32it/s, epoch=23/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 70.58it/s, epoch=23/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 705/1143 [00:10<00:06, 70.44it/s, epoch=24/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 70.23it/s, epoch=24/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████▏   | 701/1143 [00:10<00:06, 70.05it/s, epoch=25/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.68it/s, epoch=25/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 704/1143 [00:10<00:06, 70.39it/s, epoch=26/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 70.63it/s, epoch=26/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████▏   | 702/1143 [00:10<00:06, 70.20it/s, epoch=27/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.98it/s, epoch=27/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 712/1143 [00:10<00:06, 71.16it/s, epoch=28/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.91it/s, epoch=28/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 688/1143 [00:10<00:06, 68.77it/s, epoch=29/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 69.10it/s, epoch=29/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 705/1143 [00:10<00:06, 70.47it/s, epoch=30/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 70.33it/s, epoch=30/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 693/1143 [00:10<00:06, 69.26it/s, epoch=31/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.33it/s, epoch=31/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 682/1143 [00:10<00:06, 68.12it/s, epoch=32/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 68.55it/s, epoch=32/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 708/1143 [00:10<00:06, 70.77it/s, epoch=33/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 70.34it/s, epoch=33/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 697/1143 [00:10<00:06, 69.70it/s, epoch=34/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.92it/s, epoch=34/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 714/1143 [00:10<00:06, 71.30it/s, epoch=35/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 70.67it/s, epoch=35/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 692/1143 [00:10<00:06, 69.12it/s, epoch=36/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.23it/s, epoch=36/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 672/1143 [00:10<00:07, 67.14it/s, epoch=37/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 67.01it/s, epoch=37/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 693/1143 [00:10<00:06, 69.26it/s, epoch=38/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.14it/s, epoch=38/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 680/1143 [00:10<00:06, 67.94it/s, epoch=39/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 67.91it/s, epoch=39/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 682/1143 [00:10<00:06, 68.11it/s, epoch=40/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.42it/s, epoch=40/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 692/1143 [00:10<00:06, 69.16it/s, epoch=41/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 68.93it/s, epoch=41/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 687/1143 [00:10<00:06, 68.68it/s, epoch=42/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.51it/s, epoch=42/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 699/1143 [00:10<00:06, 69.81it/s, epoch=43/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.75it/s, epoch=43/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 693/1143 [00:10<00:06, 69.27it/s, epoch=44/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.60it/s, epoch=44/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████▏   | 701/1143 [00:10<00:06, 70.07it/s, epoch=45/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.54it/s, epoch=45/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████▏   | 702/1143 [00:10<00:06, 70.11it/s, epoch=46/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.79it/s, epoch=46/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 699/1143 [00:10<00:06, 69.86it/s, epoch=47/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 70.13it/s, epoch=47/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 705/1143 [00:10<00:06, 70.41it/s, epoch=48/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 70.96it/s, epoch=48/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 707/1143 [00:10<00:06, 70.66it/s, epoch=49/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 70.32it/s, epoch=49/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 694/1143 [00:10<00:06, 69.34it/s, epoch=50/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.72it/s, epoch=50/50, avg_epoch_loss=0.179]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.08417714387178 seconds
Parameter global_units with value 24 had evaluation 2.197032844973037
The best value for global_units is 4 with evaluation 2.1223329890391525
 md[global_units] = 4
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 1, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 817.076469860971 seconds
Creating forecasts took 148.38748025149107 seconds
 Start rescaling
Rescaling took 401.84919117949903 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 686/1143 [00:10<00:06, 68.51it/s, epoch=1/50, avg_epoch_loss=0.235]100%|██████████| 1143/1143 [00:16<00:00, 68.68it/s, epoch=1/50, avg_epoch_loss=0.214]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 695/1143 [00:10<00:06, 69.48it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:16<00:00, 69.00it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████▏   | 701/1143 [00:10<00:06, 70.02it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 69.29it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 678/1143 [00:10<00:06, 67.75it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 67.32it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 672/1143 [00:10<00:07, 67.11it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 67.34it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 58%|█████▊    | 665/1143 [00:10<00:07, 66.41it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:17<00:00, 67.01it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▊    | 671/1143 [00:10<00:07, 67.03it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:16<00:00, 67.29it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 680/1143 [00:10<00:06, 67.94it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 68.58it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 676/1143 [00:10<00:06, 67.59it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 67.63it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 684/1143 [00:10<00:06, 68.40it/s, epoch=10/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.53it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 691/1143 [00:10<00:06, 69.07it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 68.93it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 675/1143 [00:10<00:06, 67.46it/s, epoch=12/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:16<00:00, 67.83it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 680/1143 [00:10<00:06, 67.99it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.00it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 692/1143 [00:10<00:06, 69.20it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.03it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 687/1143 [00:10<00:06, 68.65it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.13it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 691/1143 [00:10<00:06, 69.03it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.16it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 694/1143 [00:10<00:06, 69.33it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 69.79it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 690/1143 [00:10<00:06, 68.97it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.89it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 59%|█████▉    | 678/1143 [00:10<00:06, 67.79it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.68it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 695/1143 [00:10<00:06, 69.48it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.48it/s, epoch=20/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 695/1143 [00:10<00:06, 69.46it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:16<00:00, 69.03it/s, epoch=21/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 693/1143 [00:10<00:06, 69.26it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.03it/s, epoch=22/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 704/1143 [00:10<00:06, 70.34it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:16<00:00, 70.27it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 707/1143 [00:10<00:06, 70.69it/s, epoch=24/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 70.22it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████▏   | 701/1143 [00:10<00:06, 70.01it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.99it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 695/1143 [00:10<00:06, 69.41it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.91it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 703/1143 [00:10<00:06, 70.23it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:16<00:00, 70.24it/s, epoch=27/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 699/1143 [00:10<00:06, 69.86it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.96it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████▏   | 702/1143 [00:10<00:06, 70.18it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:16<00:00, 70.15it/s, epoch=29/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 704/1143 [00:10<00:06, 70.40it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 70.48it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 698/1143 [00:10<00:06, 69.73it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 70.07it/s, epoch=31/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 682/1143 [00:10<00:06, 68.16it/s, epoch=32/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:16<00:00, 68.63it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 694/1143 [00:10<00:06, 69.30it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.09it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 694/1143 [00:10<00:06, 69.38it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:16<00:00, 69.46it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 692/1143 [00:10<00:06, 69.14it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.15it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|█████▉    | 681/1143 [00:10<00:06, 68.07it/s, epoch=36/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 68.71it/s, epoch=36/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████▏   | 701/1143 [00:10<00:06, 70.02it/s, epoch=37/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.68it/s, epoch=37/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 699/1143 [00:10<00:06, 69.82it/s, epoch=38/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.86it/s, epoch=38/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 694/1143 [00:10<00:06, 69.36it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.74it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 696/1143 [00:10<00:06, 69.60it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:16<00:00, 69.86it/s, epoch=40/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 704/1143 [00:10<00:06, 70.34it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 70.19it/s, epoch=41/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 694/1143 [00:10<00:06, 69.33it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.38it/s, epoch=42/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████▏   | 702/1143 [00:10<00:06, 70.11it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.69it/s, epoch=43/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████▏   | 701/1143 [00:10<00:06, 70.03it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 70.14it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 695/1143 [00:10<00:06, 69.45it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:16<00:00, 69.56it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 694/1143 [00:10<00:06, 69.39it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.67it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 60%|██████    | 691/1143 [00:10<00:06, 69.10it/s, epoch=47/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 69.72it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 62%|██████▏   | 704/1143 [00:10<00:06, 70.37it/s, epoch=48/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:16<00:00, 70.67it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 698/1143 [00:10<00:06, 69.71it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:16<00:00, 69.73it/s, epoch=49/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 61%|██████    | 700/1143 [00:10<00:06, 69.97it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:16<00:00, 68.93it/s, epoch=50/50, avg_epoch_loss=0.178]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 85.4350123628974 seconds
Parameter global_layers with value 1 had evaluation 3.4000201348726886
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 2, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 826.430599488318 seconds
Creating forecasts took 145.09527573175728 seconds
 Start rescaling
Rescaling took 398.2682527024299 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 612/1143 [00:10<00:08, 61.19it/s, epoch=1/50, avg_epoch_loss=0.251]100%|██████████| 1143/1143 [00:18<00:00, 61.61it/s, epoch=1/50, avg_epoch_loss=0.22]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 619/1143 [00:10<00:08, 61.84it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:18<00:00, 61.98it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 620/1143 [00:10<00:08, 61.97it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 61.33it/s, epoch=3/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 616/1143 [00:10<00:08, 61.51it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 61.65it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 628/1143 [00:10<00:08, 62.70it/s, epoch=5/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 62.26it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 620/1143 [00:10<00:08, 62.00it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 62.18it/s, epoch=6/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 623/1143 [00:10<00:08, 62.28it/s, epoch=7/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 62.02it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 618/1143 [00:10<00:08, 61.75it/s, epoch=8/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 61.71it/s, epoch=8/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 619/1143 [00:10<00:08, 61.83it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 61.60it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 625/1143 [00:10<00:08, 62.47it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.51it/s, epoch=10/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 618/1143 [00:10<00:08, 61.78it/s, epoch=11/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 61.53it/s, epoch=11/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 617/1143 [00:10<00:08, 61.61it/s, epoch=12/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 61.63it/s, epoch=12/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 612/1143 [00:10<00:08, 61.19it/s, epoch=13/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 61.67it/s, epoch=13/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 617/1143 [00:10<00:08, 61.69it/s, epoch=14/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 62.02it/s, epoch=14/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 616/1143 [00:10<00:08, 61.59it/s, epoch=15/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 61.90it/s, epoch=15/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 615/1143 [00:10<00:08, 61.46it/s, epoch=16/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 61.66it/s, epoch=16/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 612/1143 [00:10<00:08, 61.13it/s, epoch=17/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 61.60it/s, epoch=17/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 628/1143 [00:10<00:08, 62.76it/s, epoch=18/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 62.35it/s, epoch=18/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 619/1143 [00:10<00:08, 61.89it/s, epoch=19/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 61.88it/s, epoch=19/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 618/1143 [00:10<00:08, 61.72it/s, epoch=20/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 62.44it/s, epoch=20/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 619/1143 [00:10<00:08, 61.80it/s, epoch=21/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.45it/s, epoch=21/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 626/1143 [00:10<00:08, 62.53it/s, epoch=22/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 62.59it/s, epoch=22/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 620/1143 [00:10<00:08, 61.91it/s, epoch=23/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 62.06it/s, epoch=23/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 627/1143 [00:10<00:08, 62.64it/s, epoch=24/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 62.63it/s, epoch=24/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 630/1143 [00:10<00:08, 62.96it/s, epoch=25/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 62.54it/s, epoch=25/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 613/1143 [00:10<00:08, 61.27it/s, epoch=26/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 60.95it/s, epoch=26/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 613/1143 [00:10<00:08, 61.23it/s, epoch=27/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.23it/s, epoch=27/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 603/1143 [00:10<00:08, 60.28it/s, epoch=28/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 60.87it/s, epoch=28/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 605/1143 [00:10<00:08, 60.43it/s, epoch=29/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.24it/s, epoch=29/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 615/1143 [00:10<00:08, 61.40it/s, epoch=30/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 60.82it/s, epoch=30/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.30it/s, epoch=31/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.66it/s, epoch=31/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 624/1143 [00:10<00:08, 62.39it/s, epoch=32/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 61.66it/s, epoch=32/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 624/1143 [00:10<00:08, 62.37it/s, epoch=33/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 62.39it/s, epoch=33/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 630/1143 [00:10<00:08, 62.95it/s, epoch=34/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 62.44it/s, epoch=34/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 613/1143 [00:10<00:08, 61.29it/s, epoch=35/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 61.98it/s, epoch=35/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 626/1143 [00:10<00:08, 62.55it/s, epoch=36/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.58it/s, epoch=36/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 619/1143 [00:10<00:08, 61.88it/s, epoch=37/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.14it/s, epoch=37/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 616/1143 [00:10<00:08, 61.56it/s, epoch=38/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 61.83it/s, epoch=38/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 617/1143 [00:10<00:08, 61.69it/s, epoch=39/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.02it/s, epoch=39/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 629/1143 [00:10<00:08, 62.82it/s, epoch=40/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.90it/s, epoch=40/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 641/1143 [00:10<00:07, 64.04it/s, epoch=41/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 63.23it/s, epoch=41/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 623/1143 [00:10<00:08, 62.29it/s, epoch=42/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.26it/s, epoch=42/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 630/1143 [00:10<00:08, 62.99it/s, epoch=43/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.67it/s, epoch=43/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 636/1143 [00:10<00:07, 63.54it/s, epoch=44/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 63.30it/s, epoch=44/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 626/1143 [00:10<00:08, 62.57it/s, epoch=45/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 62.50it/s, epoch=45/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 622/1143 [00:10<00:08, 62.17it/s, epoch=46/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.34it/s, epoch=46/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 625/1143 [00:10<00:08, 62.42it/s, epoch=47/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 62.05it/s, epoch=47/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 635/1143 [00:10<00:08, 63.44it/s, epoch=48/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 63.32it/s, epoch=48/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 626/1143 [00:10<00:08, 62.59it/s, epoch=49/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 62.91it/s, epoch=49/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 625/1143 [00:10<00:08, 62.43it/s, epoch=50/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 62.64it/s, epoch=50/50, avg_epoch_loss=0.179]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 87.3995326589793 seconds
Parameter global_layers with value 2 had evaluation 2.7144414973288598
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 3, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 921.7438566535711 seconds
Creating forecasts took 157.00471038743854 seconds
 Start rescaling
Rescaling took 399.2068788781762 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.09it/s, epoch=1/50, avg_epoch_loss=0.242]100%|██████████| 1143/1143 [00:19<00:00, 59.68it/s, epoch=1/50, avg_epoch_loss=0.215]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 593/1143 [00:10<00:09, 59.26it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:19<00:00, 59.46it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 593/1143 [00:10<00:09, 59.25it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.73it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 59.95it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.98it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 603/1143 [00:10<00:08, 60.27it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 60.18it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.08it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 60.66it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 612/1143 [00:10<00:08, 61.17it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 60.33it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 608/1143 [00:10<00:08, 60.72it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.88it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.20it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.87it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 609/1143 [00:10<00:08, 60.81it/s, epoch=10/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.26it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 60.00it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.25it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 602/1143 [00:10<00:08, 60.14it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.28it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 621/1143 [00:10<00:08, 62.06it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.67it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.06it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 60.07it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 610/1143 [00:10<00:08, 60.93it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.47it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.13it/s, epoch=16/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.70it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 625/1143 [00:10<00:08, 62.45it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 62.69it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 631/1143 [00:10<00:08, 63.09it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 63.68it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 643/1143 [00:10<00:07, 64.24it/s, epoch=19/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 64.62it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 647/1143 [00:10<00:07, 64.65it/s, epoch=20/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 64.61it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 648/1143 [00:10<00:07, 64.79it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 64.34it/s, epoch=21/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 648/1143 [00:10<00:07, 64.73it/s, epoch=22/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 64.83it/s, epoch=22/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 637/1143 [00:10<00:07, 63.63it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 63.71it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 641/1143 [00:10<00:07, 64.02it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 62.99it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 633/1143 [00:10<00:08, 63.23it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 63.67it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 57%|█████▋    | 650/1143 [00:10<00:07, 65.00it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 64.28it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 632/1143 [00:10<00:08, 63.13it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 63.11it/s, epoch=27/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 633/1143 [00:10<00:08, 63.29it/s, epoch=28/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:17<00:00, 63.77it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 633/1143 [00:10<00:08, 63.23it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 63.70it/s, epoch=29/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 629/1143 [00:10<00:08, 62.81it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 63.24it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 633/1143 [00:10<00:08, 63.25it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 63.42it/s, epoch=31/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 626/1143 [00:10<00:08, 62.53it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 63.16it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 642/1143 [00:10<00:07, 64.14it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 63.75it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 629/1143 [00:10<00:08, 62.83it/s, epoch=34/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 63.01it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 631/1143 [00:10<00:08, 63.04it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 62.70it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 628/1143 [00:10<00:08, 62.77it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 62.69it/s, epoch=36/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 634/1143 [00:10<00:08, 63.37it/s, epoch=37/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 63.60it/s, epoch=37/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 633/1143 [00:10<00:08, 63.25it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 62.96it/s, epoch=38/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 637/1143 [00:10<00:07, 63.60it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 63.72it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 633/1143 [00:10<00:08, 63.21it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 62.42it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 619/1143 [00:10<00:08, 61.83it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.61it/s, epoch=41/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▍    | 623/1143 [00:10<00:08, 62.27it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 62.12it/s, epoch=42/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 619/1143 [00:10<00:08, 61.89it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 62.55it/s, epoch=43/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 611/1143 [00:10<00:08, 61.01it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 62.40it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 638/1143 [00:10<00:07, 63.74it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 62.10it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 622/1143 [00:10<00:08, 62.10it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.86it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 633/1143 [00:10<00:08, 63.21it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 63.64it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▌    | 636/1143 [00:10<00:07, 63.55it/s, epoch=48/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 63.80it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 55%|█████▌    | 632/1143 [00:10<00:08, 63.11it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:17<00:00, 63.89it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 56%|█████▋    | 645/1143 [00:10<00:07, 64.42it/s, epoch=50/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:17<00:00, 63.82it/s, epoch=50/50, avg_epoch_loss=0.178]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 88.31344764865935 seconds
Parameter global_layers with value 3 had evaluation 2.897408857051485
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 4, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 918.0961900074035 seconds
Creating forecasts took 157.5154482088983 seconds
 Start rescaling
Rescaling took 399.0946493279189 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.32it/s, epoch=1/50, avg_epoch_loss=0.25]100%|██████████| 1143/1143 [00:18<00:00, 60.69it/s, epoch=1/50, avg_epoch_loss=0.218]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 606/1143 [00:10<00:08, 60.51it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 60.73it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 596/1143 [00:10<00:09, 59.59it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.95it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.02it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:18<00:00, 60.22it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 607/1143 [00:10<00:08, 60.62it/s, epoch=5/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 60.12it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 602/1143 [00:10<00:08, 60.14it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 59.54it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.65it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.45it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 59.98it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:18<00:00, 60.41it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 587/1143 [00:10<00:09, 58.66it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.48it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 579/1143 [00:10<00:09, 57.80it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.92it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 595/1143 [00:10<00:09, 59.47it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.12it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.71it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.50it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.39it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.39it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 608/1143 [00:10<00:08, 60.75it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.22it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 608/1143 [00:10<00:08, 60.71it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.04it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 603/1143 [00:10<00:08, 60.26it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.67it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▍    | 615/1143 [00:10<00:08, 61.43it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.58it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 607/1143 [00:10<00:08, 60.60it/s, epoch=18/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.71it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.78it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.43it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 603/1143 [00:10<00:08, 60.24it/s, epoch=20/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.27it/s, epoch=20/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 593/1143 [00:10<00:09, 59.26it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.52it/s, epoch=21/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 587/1143 [00:10<00:09, 58.66it/s, epoch=22/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.08it/s, epoch=22/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 602/1143 [00:10<00:08, 60.17it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.88it/s, epoch=23/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 605/1143 [00:10<00:08, 60.48it/s, epoch=24/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.56it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.31it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.47it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.00it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.87it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 608/1143 [00:10<00:08, 60.80it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.99it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 603/1143 [00:10<00:08, 60.22it/s, epoch=28/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.16it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.01it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.52it/s, epoch=29/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 606/1143 [00:10<00:08, 60.58it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.51it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.79it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.52it/s, epoch=31/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.31it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.35it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 596/1143 [00:10<00:09, 59.51it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.56it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.31it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 60.00it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 612/1143 [00:10<00:08, 61.12it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.52it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 609/1143 [00:10<00:08, 60.81it/s, epoch=36/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.70it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.63it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 60.06it/s, epoch=37/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 611/1143 [00:10<00:08, 61.05it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.79it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.74it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.84it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.31it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.26it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 611/1143 [00:10<00:08, 61.00it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.27it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 608/1143 [00:10<00:08, 60.79it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.17it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 609/1143 [00:10<00:08, 60.89it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.58it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 602/1143 [00:10<00:08, 60.18it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.89it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 575/1143 [00:10<00:09, 57.44it/s, epoch=45/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 57.95it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 582/1143 [00:10<00:09, 58.18it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.26it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.34it/s, epoch=47/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:18<00:00, 60.35it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 606/1143 [00:10<00:08, 60.51it/s, epoch=48/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.58it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.09it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.43it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 54%|█████▎    | 614/1143 [00:10<00:08, 61.37it/s, epoch=50/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 61.14it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.61013354174793 seconds
Parameter global_layers with value 4 had evaluation 2.344792857031734
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 5, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 950.40373714827 seconds
Creating forecasts took 160.70080761797726 seconds
 Start rescaling
Rescaling took 398.9642056170851 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 578/1143 [00:10<00:09, 57.78it/s, epoch=1/50, avg_epoch_loss=0.259]100%|██████████| 1143/1143 [00:19<00:00, 58.81it/s, epoch=1/50, avg_epoch_loss=0.221]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 599/1143 [00:10<00:09, 59.81it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 58.81it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.86it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.08it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 588/1143 [00:10<00:09, 58.80it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:19<00:00, 58.97it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.61it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.01it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.12it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 59.85it/s, epoch=6/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 602/1143 [00:10<00:08, 60.12it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:18<00:00, 60.23it/s, epoch=7/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.79it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.51it/s, epoch=8/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 594/1143 [00:10<00:09, 59.31it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 59.77it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 584/1143 [00:10<00:09, 58.40it/s, epoch=10/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.62it/s, epoch=10/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 591/1143 [00:10<00:09, 59.05it/s, epoch=11/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.72it/s, epoch=11/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 597/1143 [00:10<00:09, 59.60it/s, epoch=12/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.17it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.18it/s, epoch=13/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.36it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 594/1143 [00:10<00:09, 59.29it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.85it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.89it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.88it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 582/1143 [00:10<00:09, 58.15it/s, epoch=16/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.51it/s, epoch=16/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.08it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.68it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 590/1143 [00:10<00:09, 58.99it/s, epoch=18/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.30it/s, epoch=18/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 592/1143 [00:10<00:09, 59.17it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.72it/s, epoch=19/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 606/1143 [00:10<00:08, 60.59it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.90it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 593/1143 [00:10<00:09, 59.23it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.15it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 584/1143 [00:10<00:09, 58.33it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.89it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 581/1143 [00:10<00:09, 58.07it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.37it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 579/1143 [00:10<00:09, 57.86it/s, epoch=24/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.79it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 583/1143 [00:10<00:09, 58.27it/s, epoch=25/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 59.12it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 59.94it/s, epoch=26/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 60.05it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 605/1143 [00:10<00:08, 60.44it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.35it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 595/1143 [00:10<00:09, 59.47it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.23it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 600/1143 [00:10<00:09, 59.93it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.44it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 596/1143 [00:10<00:09, 59.58it/s, epoch=30/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.14it/s, epoch=30/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.81it/s, epoch=31/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.49it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 591/1143 [00:10<00:09, 59.04it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.06it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████▏    | 587/1143 [00:10<00:09, 58.67it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.14it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 599/1143 [00:10<00:09, 59.82it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.74it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 606/1143 [00:10<00:08, 60.58it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.83it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 602/1143 [00:10<00:08, 60.17it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.74it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 595/1143 [00:10<00:09, 59.42it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.89it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 601/1143 [00:10<00:09, 60.09it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.95it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 593/1143 [00:10<00:09, 59.28it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.36it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 581/1143 [00:10<00:09, 58.05it/s, epoch=40/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 58.88it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.74it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.91it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 589/1143 [00:10<00:09, 58.86it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 58.51it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.78it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.74it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 608/1143 [00:10<00:08, 60.78it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:18<00:00, 60.78it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 602/1143 [00:10<00:08, 60.19it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 60.04it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 596/1143 [00:10<00:09, 59.58it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 59.53it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 598/1143 [00:10<00:09, 59.77it/s, epoch=47/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 59.62it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.31it/s, epoch=48/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 60.06it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 52%|█████▏    | 599/1143 [00:10<00:09, 59.86it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 59.29it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 53%|█████▎    | 604/1143 [00:10<00:08, 60.37it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:18<00:00, 60.71it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.0337990950793 seconds
Parameter global_layers with value 5 had evaluation 2.354614323028361
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 6, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 963.7560143172741 seconds
Creating forecasts took 161.5418806169182 seconds
 Start rescaling
Rescaling took 398.4783351290971 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.30it/s, epoch=1/50, avg_epoch_loss=0.252] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.74it/s, epoch=1/50, avg_epoch_loss=0.217]100%|██████████| 1143/1143 [00:20<00:00, 56.69it/s, epoch=1/50, avg_epoch_loss=0.216]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 568/1143 [00:10<00:10, 56.79it/s, epoch=2/50, avg_epoch_loss=0.18] 99%|█████████▉| 1136/1143 [00:20<00:00, 56.34it/s, epoch=2/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.40it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.76it/s, epoch=3/50, avg_epoch_loss=0.18] 98%|█████████▊| 1123/1143 [00:20<00:00, 56.19it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.12it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.47it/s, epoch=4/50, avg_epoch_loss=0.18] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.41it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.45it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.26it/s, epoch=5/50, avg_epoch_loss=0.179] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.72it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.63it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 575/1143 [00:10<00:09, 57.41it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 57.47it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 579/1143 [00:10<00:09, 57.81it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 58.02it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 577/1143 [00:10<00:09, 57.61it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 57.72it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 577/1143 [00:10<00:09, 57.63it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:19<00:00, 57.37it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.37it/s, epoch=10/50, avg_epoch_loss=0.178] 99%|█████████▉| 1136/1143 [00:20<00:00, 56.81it/s, epoch=10/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.74it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.64it/s, epoch=11/50, avg_epoch_loss=0.179] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.26it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.33it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 566/1143 [00:10<00:10, 56.54it/s, epoch=12/50, avg_epoch_loss=0.178] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.19it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.26it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.21it/s, epoch=13/50, avg_epoch_loss=0.179] 99%|█████████▉| 1135/1143 [00:20<00:00, 56.77it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.71it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 573/1143 [00:10<00:09, 57.27it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.17it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.61it/s, epoch=15/50, avg_epoch_loss=0.177]100%|█████████▉| 1140/1143 [00:20<00:00, 57.00it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.93it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 582/1143 [00:10<00:09, 58.12it/s, epoch=16/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.70it/s, epoch=16/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.16it/s, epoch=17/50, avg_epoch_loss=0.178] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.37it/s, epoch=17/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.35it/s, epoch=17/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.94it/s, epoch=18/50, avg_epoch_loss=0.177] 98%|█████████▊| 1125/1143 [00:20<00:00, 56.22it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.16it/s, epoch=18/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.66it/s, epoch=19/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.26it/s, epoch=19/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.22it/s, epoch=19/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.62it/s, epoch=20/50, avg_epoch_loss=0.178] 99%|█████████▉| 1135/1143 [00:20<00:00, 56.88it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.71it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 573/1143 [00:10<00:09, 57.25it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 57.04it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 577/1143 [00:10<00:09, 57.61it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 58.07it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 576/1143 [00:10<00:09, 57.54it/s, epoch=23/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 57.33it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.16it/s, epoch=24/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 57.11it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.06it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.26it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 573/1143 [00:10<00:09, 57.21it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.33it/s, epoch=26/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.19it/s, epoch=27/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 57.35it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.08it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 57.11it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 57.10it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:10, 57.10it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.16it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 581/1143 [00:10<00:09, 58.05it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.70it/s, epoch=30/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.66it/s, epoch=31/50, avg_epoch_loss=0.178] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.09it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.17it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.36it/s, epoch=32/50, avg_epoch_loss=0.177] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.29it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.29it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.58it/s, epoch=33/50, avg_epoch_loss=0.178] 96%|█████████▌| 1093/1143 [00:20<00:00, 54.64it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.76it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.16it/s, epoch=34/50, avg_epoch_loss=0.176] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.44it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.37it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.34it/s, epoch=35/50, avg_epoch_loss=0.178] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.71it/s, epoch=35/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.69it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.85it/s, epoch=36/50, avg_epoch_loss=0.177] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.56it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.48it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.99it/s, epoch=37/50, avg_epoch_loss=0.177] 98%|█████████▊| 1121/1143 [00:20<00:00, 56.03it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.00it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.17it/s, epoch=38/50, avg_epoch_loss=0.176] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.10it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.14it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.02it/s, epoch=39/50, avg_epoch_loss=0.178] 98%|█████████▊| 1117/1143 [00:20<00:00, 55.91it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.76it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 574/1143 [00:10<00:09, 57.35it/s, epoch=40/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 57.22it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 573/1143 [00:10<00:09, 57.28it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 57.10it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.98it/s, epoch=42/50, avg_epoch_loss=0.177] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.70it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.58it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 577/1143 [00:10<00:09, 57.68it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.32it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 568/1143 [00:10<00:10, 56.72it/s, epoch=44/50, avg_epoch_loss=0.177]100%|█████████▉| 1139/1143 [00:20<00:00, 56.91it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.89it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 575/1143 [00:10<00:09, 57.46it/s, epoch=45/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:20<00:00, 56.96it/s, epoch=45/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 569/1143 [00:10<00:10, 56.85it/s, epoch=46/50, avg_epoch_loss=0.177]100%|█████████▉| 1138/1143 [00:20<00:00, 56.28it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.37it/s, epoch=46/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 566/1143 [00:10<00:10, 56.52it/s, epoch=47/50, avg_epoch_loss=0.176] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.55it/s, epoch=47/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:20<00:00, 56.54it/s, epoch=47/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 578/1143 [00:10<00:09, 57.75it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:19<00:00, 57.74it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 583/1143 [00:10<00:09, 58.25it/s, epoch=49/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 58.26it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 577/1143 [00:10<00:09, 57.66it/s, epoch=50/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:19<00:00, 57.54it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.44920267350972 seconds
Parameter global_layers with value 6 had evaluation 2.2956466759502674
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 7, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1007.5542754288763 seconds
Creating forecasts took 166.42804388143122 seconds
 Start rescaling
Rescaling took 399.70136419683695 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.16it/s, epoch=1/50, avg_epoch_loss=0.256] 93%|█████████▎| 1064/1143 [00:20<00:01, 51.98it/s, epoch=1/50, avg_epoch_loss=0.221]100%|██████████| 1143/1143 [00:21<00:00, 52.07it/s, epoch=1/50, avg_epoch_loss=0.219]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.09it/s, epoch=2/50, avg_epoch_loss=0.182] 95%|█████████▍| 1082/1143 [00:20<00:01, 53.34it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 53.52it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.53it/s, epoch=3/50, avg_epoch_loss=0.181] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.21it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.36it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.88it/s, epoch=4/50, avg_epoch_loss=0.181] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.18it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.10it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.25it/s, epoch=5/50, avg_epoch_loss=0.18] 93%|█████████▎| 1066/1143 [00:20<00:01, 53.20it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.23it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.74it/s, epoch=6/50, avg_epoch_loss=0.18] 94%|█████████▍| 1079/1143 [00:20<00:01, 53.92it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 53.93it/s, epoch=6/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.37it/s, epoch=7/50, avg_epoch_loss=0.18] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.25it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.11it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.82it/s, epoch=8/50, avg_epoch_loss=0.181] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.87it/s, epoch=8/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.82it/s, epoch=8/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.62it/s, epoch=9/50, avg_epoch_loss=0.181] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.18it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.25it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.06it/s, epoch=10/50, avg_epoch_loss=0.18] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.35it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.47it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.52it/s, epoch=11/50, avg_epoch_loss=0.181] 97%|█████████▋| 1113/1143 [00:20<00:00, 55.60it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.56it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.41it/s, epoch=12/50, avg_epoch_loss=0.179] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.76it/s, epoch=12/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.73it/s, epoch=12/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.75it/s, epoch=13/50, avg_epoch_loss=0.179] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.92it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.93it/s, epoch=13/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.85it/s, epoch=14/50, avg_epoch_loss=0.179] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.18it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.09it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.94it/s, epoch=15/50, avg_epoch_loss=0.179] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.83it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.85it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.84it/s, epoch=16/50, avg_epoch_loss=0.179] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.67it/s, epoch=16/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.68it/s, epoch=16/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.12it/s, epoch=17/50, avg_epoch_loss=0.179] 98%|█████████▊| 1124/1143 [00:20<00:00, 55.76it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.82it/s, epoch=17/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.18it/s, epoch=18/50, avg_epoch_loss=0.179] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.88it/s, epoch=18/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.96it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.18it/s, epoch=19/50, avg_epoch_loss=0.179] 98%|█████████▊| 1124/1143 [00:20<00:00, 56.11it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.13it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.17it/s, epoch=20/50, avg_epoch_loss=0.179] 97%|█████████▋| 1113/1143 [00:20<00:00, 55.67it/s, epoch=20/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.62it/s, epoch=20/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.59it/s, epoch=21/50, avg_epoch_loss=0.178] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.74it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.72it/s, epoch=21/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.16it/s, epoch=22/50, avg_epoch_loss=0.178] 98%|█████████▊| 1124/1143 [00:20<00:00, 55.86it/s, epoch=22/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.89it/s, epoch=22/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.84it/s, epoch=23/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.20it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.09it/s, epoch=23/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.30it/s, epoch=24/50, avg_epoch_loss=0.179] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.54it/s, epoch=24/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.54it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.28it/s, epoch=25/50, avg_epoch_loss=0.177] 99%|█████████▊| 1126/1143 [00:20<00:00, 55.56it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.67it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.58it/s, epoch=26/50, avg_epoch_loss=0.177] 97%|█████████▋| 1113/1143 [00:20<00:00, 55.61it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.66it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.41it/s, epoch=27/50, avg_epoch_loss=0.177] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.72it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.67it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.84it/s, epoch=28/50, avg_epoch_loss=0.178] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.42it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.40it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.61it/s, epoch=29/50, avg_epoch_loss=0.178] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.09it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.14it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.85it/s, epoch=30/50, avg_epoch_loss=0.178] 96%|█████████▋| 1101/1143 [00:20<00:00, 55.03it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.05it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.49it/s, epoch=31/50, avg_epoch_loss=0.178] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.19it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.25it/s, epoch=31/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.97it/s, epoch=32/50, avg_epoch_loss=0.179] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.48it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.44it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.12it/s, epoch=33/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.25it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.23it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.48it/s, epoch=34/50, avg_epoch_loss=0.177] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.68it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.69it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.43it/s, epoch=35/50, avg_epoch_loss=0.178] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.53it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.46it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.51it/s, epoch=36/50, avg_epoch_loss=0.177] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.49it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.42it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.50it/s, epoch=37/50, avg_epoch_loss=0.177] 97%|█████████▋| 1111/1143 [00:20<00:00, 54.98it/s, epoch=37/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.87it/s, epoch=37/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.59it/s, epoch=38/50, avg_epoch_loss=0.177] 49%|████▊     | 556/1143 [00:20<00:10, 55.59it/s, epoch=38/50, avg_epoch_loss=0.178] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.25it/s, epoch=38/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.29it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.40it/s, epoch=39/50, avg_epoch_loss=0.178] 98%|█████████▊| 1120/1143 [00:20<00:00, 56.07it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.98it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.51it/s, epoch=40/50, avg_epoch_loss=0.178] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.70it/s, epoch=40/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.69it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.81it/s, epoch=41/50, avg_epoch_loss=0.177] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.62it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.61it/s, epoch=41/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.38it/s, epoch=42/50, avg_epoch_loss=0.177] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.22it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.15it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.92it/s, epoch=43/50, avg_epoch_loss=0.178] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.54it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.60it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.31it/s, epoch=44/50, avg_epoch_loss=0.178] 95%|█████████▌| 1088/1143 [00:20<00:01, 53.90it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.86it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.60it/s, epoch=45/50, avg_epoch_loss=0.176] 93%|█████████▎| 1064/1143 [00:20<00:01, 53.25it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.19it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.47it/s, epoch=46/50, avg_epoch_loss=0.178] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.20it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.24it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.48it/s, epoch=47/50, avg_epoch_loss=0.176] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.60it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.69it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.37it/s, epoch=48/50, avg_epoch_loss=0.178] 95%|█████████▍| 1081/1143 [00:20<00:01, 54.11it/s, epoch=48/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.06it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.45it/s, epoch=49/50, avg_epoch_loss=0.177] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.79it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.78it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.11it/s, epoch=50/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.50it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.55it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 85.65669126808643 seconds
Parameter global_layers with value 7 had evaluation 2.3210243630833176
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1041.3434450104833 seconds
Creating forecasts took 177.00262403674424 seconds
 Start rescaling
Rescaling took 398.8533557523042 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.58it/s, epoch=1/50, avg_epoch_loss=0.254] 92%|█████████▏| 1057/1143 [00:20<00:01, 52.88it/s, epoch=1/50, avg_epoch_loss=0.218]100%|██████████| 1143/1143 [00:21<00:00, 52.90it/s, epoch=1/50, avg_epoch_loss=0.215]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.91it/s, epoch=2/50, avg_epoch_loss=0.181] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.64it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 53.56it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.05it/s, epoch=3/50, avg_epoch_loss=0.18] 93%|█████████▎| 1062/1143 [00:20<00:01, 52.80it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 52.90it/s, epoch=3/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.57it/s, epoch=4/50, avg_epoch_loss=0.18] 92%|█████████▏| 1052/1143 [00:20<00:01, 52.59it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 52.67it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.38it/s, epoch=5/50, avg_epoch_loss=0.18] 93%|█████████▎| 1068/1143 [00:20<00:01, 53.17it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.25it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.41it/s, epoch=6/50, avg_epoch_loss=0.18] 94%|█████████▍| 1080/1143 [00:20<00:01, 54.03it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 53.99it/s, epoch=6/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.63it/s, epoch=7/50, avg_epoch_loss=0.181] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.90it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.83it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.04it/s, epoch=8/50, avg_epoch_loss=0.181] 93%|█████████▎| 1068/1143 [00:20<00:01, 53.41it/s, epoch=8/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 53.42it/s, epoch=8/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.69it/s, epoch=9/50, avg_epoch_loss=0.181] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.18it/s, epoch=9/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 54.13it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.05it/s, epoch=10/50, avg_epoch_loss=0.18] 93%|█████████▎| 1068/1143 [00:20<00:01, 53.42it/s, epoch=10/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.24it/s, epoch=10/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 525/1143 [00:10<00:11, 52.48it/s, epoch=11/50, avg_epoch_loss=0.181] 92%|█████████▏| 1050/1143 [00:20<00:01, 52.40it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.47it/s, epoch=11/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.57it/s, epoch=12/50, avg_epoch_loss=0.179] 92%|█████████▏| 1052/1143 [00:20<00:01, 52.48it/s, epoch=12/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.46it/s, epoch=12/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 519/1143 [00:10<00:12, 51.89it/s, epoch=13/50, avg_epoch_loss=0.179] 92%|█████████▏| 1050/1143 [00:20<00:01, 52.57it/s, epoch=13/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.57it/s, epoch=13/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.71it/s, epoch=14/50, avg_epoch_loss=0.179] 92%|█████████▏| 1056/1143 [00:20<00:01, 52.73it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.76it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.53it/s, epoch=15/50, avg_epoch_loss=0.179] 92%|█████████▏| 1054/1143 [00:20<00:01, 52.68it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.61it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.72it/s, epoch=16/50, avg_epoch_loss=0.179] 92%|█████████▏| 1056/1143 [00:20<00:01, 52.31it/s, epoch=16/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.09it/s, epoch=16/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 508/1143 [00:10<00:12, 50.71it/s, epoch=17/50, avg_epoch_loss=0.179] 89%|████████▉ | 1019/1143 [00:20<00:02, 50.92it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:22<00:00, 50.92it/s, epoch=17/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.12it/s, epoch=18/50, avg_epoch_loss=0.179] 93%|█████████▎| 1064/1143 [00:20<00:01, 52.45it/s, epoch=18/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.62it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.25it/s, epoch=19/50, avg_epoch_loss=0.179] 93%|█████████▎| 1066/1143 [00:20<00:01, 53.22it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.26it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.86it/s, epoch=20/50, avg_epoch_loss=0.178] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.15it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.27it/s, epoch=20/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 520/1143 [00:10<00:11, 51.95it/s, epoch=21/50, avg_epoch_loss=0.178] 93%|█████████▎| 1060/1143 [00:20<00:01, 53.14it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.02it/s, epoch=21/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.72it/s, epoch=22/50, avg_epoch_loss=0.178] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.11it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.21it/s, epoch=22/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.98it/s, epoch=23/50, avg_epoch_loss=0.178] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.14it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.03it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.52it/s, epoch=24/50, avg_epoch_loss=0.178] 92%|█████████▏| 1055/1143 [00:20<00:01, 52.70it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.64it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.49it/s, epoch=25/50, avg_epoch_loss=0.177] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.45it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.49it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.39it/s, epoch=26/50, avg_epoch_loss=0.178] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.13it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.14it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.38it/s, epoch=27/50, avg_epoch_loss=0.177] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.93it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.89it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.85it/s, epoch=28/50, avg_epoch_loss=0.178] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.94it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.97it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.66it/s, epoch=29/50, avg_epoch_loss=0.178] 94%|█████████▍| 1074/1143 [00:20<00:01, 52.97it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.05it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.50it/s, epoch=30/50, avg_epoch_loss=0.178] 92%|█████████▏| 1055/1143 [00:20<00:01, 52.73it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.78it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.77it/s, epoch=31/50, avg_epoch_loss=0.178] 92%|█████████▏| 1056/1143 [00:20<00:01, 52.21it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.27it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.25it/s, epoch=32/50, avg_epoch_loss=0.178] 93%|█████████▎| 1066/1143 [00:20<00:01, 53.01it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.95it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.09it/s, epoch=33/50, avg_epoch_loss=0.178] 93%|█████████▎| 1068/1143 [00:20<00:01, 53.42it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.33it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.06it/s, epoch=34/50, avg_epoch_loss=0.177] 93%|█████████▎| 1068/1143 [00:20<00:01, 53.41it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.45it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 519/1143 [00:10<00:12, 51.82it/s, epoch=35/50, avg_epoch_loss=0.178] 92%|█████████▏| 1056/1143 [00:20<00:01, 52.88it/s, epoch=35/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.85it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.78it/s, epoch=36/50, avg_epoch_loss=0.177] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.30it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.32it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.66it/s, epoch=37/50, avg_epoch_loss=0.177] 94%|█████████▍| 1080/1143 [00:20<00:01, 54.03it/s, epoch=37/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.88it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.41it/s, epoch=38/50, avg_epoch_loss=0.177] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.41it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.34it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.71it/s, epoch=39/50, avg_epoch_loss=0.178] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.30it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.41it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.63it/s, epoch=40/50, avg_epoch_loss=0.177] 94%|█████████▍| 1075/1143 [00:20<00:01, 53.73it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.68it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.38it/s, epoch=41/50, avg_epoch_loss=0.177] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.45it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.39it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.67it/s, epoch=42/50, avg_epoch_loss=0.178] 94%|█████████▍| 1077/1143 [00:20<00:01, 53.86it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.78it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.63it/s, epoch=43/50, avg_epoch_loss=0.177] 94%|█████████▍| 1075/1143 [00:20<00:01, 53.71it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.72it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.82it/s, epoch=44/50, avg_epoch_loss=0.177] 93%|█████████▎| 1063/1143 [00:20<00:01, 53.10it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.09it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.34it/s, epoch=45/50, avg_epoch_loss=0.176] 47%|████▋     | 534/1143 [00:20<00:11, 53.34it/s, epoch=45/50, avg_epoch_loss=0.177] 93%|█████████▎| 1066/1143 [00:20<00:01, 53.20it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.25it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.90it/s, epoch=46/50, avg_epoch_loss=0.178] 95%|█████████▍| 1082/1143 [00:20<00:01, 54.03it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.87it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.51it/s, epoch=47/50, avg_epoch_loss=0.176] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.79it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.79it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.64it/s, epoch=48/50, avg_epoch_loss=0.177] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.45it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.47it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.74it/s, epoch=49/50, avg_epoch_loss=0.177] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.64it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.68it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.55it/s, epoch=50/50, avg_epoch_loss=0.177] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.66it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.57it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 84.41494808718562 seconds
Parameter global_layers with value 8 had evaluation 2.176482672455858
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 9, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1074.3683475945145 seconds
Creating forecasts took 179.71583505906165 seconds
 Start rescaling
Rescaling took 397.8134655468166 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 507/1143 [00:10<00:12, 50.68it/s, epoch=1/50, avg_epoch_loss=0.255] 89%|████████▉ | 1022/1143 [00:20<00:02, 51.15it/s, epoch=1/50, avg_epoch_loss=0.218]100%|██████████| 1143/1143 [00:22<00:00, 51.29it/s, epoch=1/50, avg_epoch_loss=0.215]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 512/1143 [00:10<00:12, 51.10it/s, epoch=2/50, avg_epoch_loss=0.182] 90%|████████▉ | 1024/1143 [00:20<00:02, 49.75it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:22<00:00, 49.96it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 507/1143 [00:10<00:12, 50.63it/s, epoch=3/50, avg_epoch_loss=0.181] 89%|████████▉ | 1021/1143 [00:20<00:02, 51.03it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:22<00:00, 50.39it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 469/1143 [00:10<00:14, 46.87it/s, epoch=4/50, avg_epoch_loss=0.181] 83%|████████▎ | 952/1143 [00:20<00:04, 47.67it/s, epoch=4/50, avg_epoch_loss=0.18] 100%|██████████| 1143/1143 [00:23<00:00, 48.07it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 511/1143 [00:10<00:12, 51.04it/s, epoch=5/50, avg_epoch_loss=0.18] 90%|████████▉ | 1024/1143 [00:20<00:02, 51.16it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:22<00:00, 51.28it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 521/1143 [00:10<00:11, 52.06it/s, epoch=6/50, avg_epoch_loss=0.181] 92%|█████████▏| 1050/1143 [00:20<00:01, 52.51it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 52.50it/s, epoch=6/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 524/1143 [00:10<00:11, 52.35it/s, epoch=7/50, avg_epoch_loss=0.181] 93%|█████████▎| 1058/1143 [00:20<00:01, 52.92it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.92it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.92it/s, epoch=8/50, avg_epoch_loss=0.181] 93%|█████████▎| 1060/1143 [00:20<00:01, 52.64it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.72it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 521/1143 [00:10<00:11, 52.07it/s, epoch=9/50, avg_epoch_loss=0.18] 91%|█████████▏| 1043/1143 [00:20<00:01, 52.12it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.21it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.10it/s, epoch=10/50, avg_epoch_loss=0.178] 93%|█████████▎| 1064/1143 [00:20<00:01, 53.04it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.10it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.63it/s, epoch=11/50, avg_epoch_loss=0.179] 94%|█████████▍| 1074/1143 [00:20<00:01, 52.39it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.63it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 524/1143 [00:10<00:11, 52.38it/s, epoch=12/50, avg_epoch_loss=0.178] 92%|█████████▏| 1052/1143 [00:20<00:01, 52.60it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.67it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.17it/s, epoch=13/50, avg_epoch_loss=0.179] 93%|█████████▎| 1064/1143 [00:20<00:01, 53.05it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.09it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.06it/s, epoch=14/50, avg_epoch_loss=0.178] 93%|█████████▎| 1062/1143 [00:20<00:01, 52.75it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.72it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 525/1143 [00:10<00:11, 52.41it/s, epoch=15/50, avg_epoch_loss=0.178] 92%|█████████▏| 1052/1143 [00:20<00:01, 52.57it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.60it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.08it/s, epoch=16/50, avg_epoch_loss=0.177] 93%|█████████▎| 1062/1143 [00:20<00:01, 52.84it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.90it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.10it/s, epoch=17/50, avg_epoch_loss=0.179] 93%|█████████▎| 1062/1143 [00:20<00:01, 52.70it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.72it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.07it/s, epoch=18/50, avg_epoch_loss=0.178] 93%|█████████▎| 1062/1143 [00:20<00:01, 53.06it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.10it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.32it/s, epoch=19/50, avg_epoch_loss=0.178] 93%|█████████▎| 1068/1143 [00:20<00:01, 52.81it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.78it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 520/1143 [00:10<00:11, 51.96it/s, epoch=20/50, avg_epoch_loss=0.178] 91%|█████████ | 1040/1143 [00:20<00:01, 51.59it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 51.55it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 518/1143 [00:10<00:12, 51.72it/s, epoch=21/50, avg_epoch_loss=0.178] 91%|█████████ | 1036/1143 [00:20<00:02, 51.33it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 51.49it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 511/1143 [00:10<00:12, 51.05it/s, epoch=22/50, avg_epoch_loss=0.178] 90%|█████████ | 1034/1143 [00:20<00:02, 51.77it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 51.75it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 523/1143 [00:10<00:11, 52.27it/s, epoch=23/50, avg_epoch_loss=0.176] 92%|█████████▏| 1046/1143 [00:20<00:01, 51.67it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 51.77it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 512/1143 [00:10<00:12, 51.19it/s, epoch=24/50, avg_epoch_loss=0.179] 90%|████████▉ | 1028/1143 [00:20<00:02, 51.39it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 51.13it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 519/1143 [00:10<00:12, 51.88it/s, epoch=25/50, avg_epoch_loss=0.178] 92%|█████████▏| 1047/1143 [00:20<00:01, 52.40it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.35it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.94it/s, epoch=26/50, avg_epoch_loss=0.177] 93%|█████████▎| 1063/1143 [00:20<00:01, 53.10it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.02it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.10it/s, epoch=27/50, avg_epoch_loss=0.177] 93%|█████████▎| 1064/1143 [00:20<00:01, 53.20it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.21it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 53.00it/s, epoch=28/50, avg_epoch_loss=0.178] 93%|█████████▎| 1060/1143 [00:20<00:01, 52.36it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.47it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 515/1143 [00:10<00:12, 51.43it/s, epoch=29/50, avg_epoch_loss=0.178] 91%|█████████ | 1037/1143 [00:20<00:02, 51.86it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 51.92it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 522/1143 [00:10<00:11, 52.12it/s, epoch=30/50, avg_epoch_loss=0.178] 92%|█████████▏| 1049/1143 [00:20<00:01, 52.42it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.33it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.77it/s, epoch=31/50, avg_epoch_loss=0.178] 93%|█████████▎| 1062/1143 [00:20<00:01, 53.11it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.06it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.05it/s, epoch=32/50, avg_epoch_loss=0.178] 93%|█████████▎| 1062/1143 [00:20<00:01, 52.35it/s, epoch=32/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.55it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 521/1143 [00:10<00:11, 52.07it/s, epoch=33/50, avg_epoch_loss=0.178] 92%|█████████▏| 1052/1143 [00:20<00:01, 52.66it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.47it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 527/1143 [00:10<00:11, 52.62it/s, epoch=34/50, avg_epoch_loss=0.177] 92%|█████████▏| 1057/1143 [00:20<00:01, 52.80it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.70it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 523/1143 [00:10<00:11, 52.24it/s, epoch=35/50, avg_epoch_loss=0.179] 92%|█████████▏| 1052/1143 [00:20<00:01, 52.61it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.64it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.28it/s, epoch=36/50, avg_epoch_loss=0.176] 93%|█████████▎| 1066/1143 [00:20<00:01, 53.24it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.27it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.02it/s, epoch=37/50, avg_epoch_loss=0.177] 93%|█████████▎| 1062/1143 [00:20<00:01, 52.27it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.40it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 524/1143 [00:10<00:11, 52.38it/s, epoch=38/50, avg_epoch_loss=0.177] 92%|█████████▏| 1052/1143 [00:20<00:01, 52.58it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.56it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.51it/s, epoch=39/50, avg_epoch_loss=0.177] 92%|█████████▏| 1054/1143 [00:20<00:01, 52.64it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.54it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.12it/s, epoch=40/50, avg_epoch_loss=0.177] 93%|█████████▎| 1064/1143 [00:20<00:01, 52.51it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.68it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 511/1143 [00:10<00:12, 51.05it/s, epoch=41/50, avg_epoch_loss=0.178] 91%|█████████ | 1041/1143 [00:20<00:01, 52.17it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.12it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.18it/s, epoch=42/50, avg_epoch_loss=0.177] 93%|█████████▎| 1064/1143 [00:20<00:01, 53.17it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.13it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.52it/s, epoch=43/50, avg_epoch_loss=0.178] 92%|█████████▏| 1052/1143 [00:20<00:01, 52.53it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.61it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.70it/s, epoch=44/50, avg_epoch_loss=0.177] 92%|█████████▏| 1056/1143 [00:20<00:01, 52.73it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.77it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.76it/s, epoch=45/50, avg_epoch_loss=0.177] 93%|█████████▎| 1058/1143 [00:20<00:01, 52.85it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.86it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 522/1143 [00:10<00:11, 52.14it/s, epoch=46/50, avg_epoch_loss=0.177] 92%|█████████▏| 1053/1143 [00:20<00:01, 52.67it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.59it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.90it/s, epoch=47/50, avg_epoch_loss=0.177] 93%|█████████▎| 1059/1143 [00:20<00:01, 52.83it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.89it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 521/1143 [00:10<00:11, 52.02it/s, epoch=48/50, avg_epoch_loss=0.177] 92%|█████████▏| 1053/1143 [00:20<00:01, 52.66it/s, epoch=48/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.62it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.56it/s, epoch=49/50, avg_epoch_loss=0.176] 92%|█████████▏| 1052/1143 [00:20<00:01, 52.58it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.60it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.17it/s, epoch=50/50, avg_epoch_loss=0.178] 93%|█████████▎| 1064/1143 [00:20<00:01, 52.76it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.68it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 82.74653062596917 seconds
Parameter global_layers with value 9 had evaluation 2.419553156113467
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 10, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1092.9742449764162 seconds
Creating forecasts took 181.4142378848046 seconds
 Start rescaling
Rescaling took 397.853728979826 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 524/1143 [00:10<00:11, 52.39it/s, epoch=1/50, avg_epoch_loss=0.245] 92%|█████████▏| 1057/1143 [00:20<00:01, 52.87it/s, epoch=1/50, avg_epoch_loss=0.214]100%|██████████| 1143/1143 [00:21<00:00, 52.77it/s, epoch=1/50, avg_epoch_loss=0.211]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.67it/s, epoch=2/50, avg_epoch_loss=0.18] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.52it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 53.43it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.76it/s, epoch=3/50, avg_epoch_loss=0.181] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.48it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 53.55it/s, epoch=3/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.98it/s, epoch=4/50, avg_epoch_loss=0.182] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.55it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 53.38it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.19it/s, epoch=5/50, avg_epoch_loss=0.181] 93%|█████████▎| 1064/1143 [00:20<00:01, 52.87it/s, epoch=5/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 52.94it/s, epoch=5/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.10it/s, epoch=6/50, avg_epoch_loss=0.181] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.48it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 53.41it/s, epoch=6/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.75it/s, epoch=7/50, avg_epoch_loss=0.181] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.84it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.85it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.42it/s, epoch=8/50, avg_epoch_loss=0.18] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.46it/s, epoch=8/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 53.51it/s, epoch=8/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.59it/s, epoch=9/50, avg_epoch_loss=0.181] 93%|█████████▎| 1060/1143 [00:20<00:01, 53.03it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.01it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.41it/s, epoch=10/50, avg_epoch_loss=0.18] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.41it/s, epoch=10/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.42it/s, epoch=10/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.01it/s, epoch=11/50, avg_epoch_loss=0.181] 93%|█████████▎| 1062/1143 [00:20<00:01, 52.61it/s, epoch=11/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 52.77it/s, epoch=11/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.97it/s, epoch=12/50, avg_epoch_loss=0.18] 93%|█████████▎| 1068/1143 [00:20<00:01, 53.43it/s, epoch=12/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.41it/s, epoch=12/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.04it/s, epoch=13/50, avg_epoch_loss=0.18] 93%|█████████▎| 1066/1143 [00:20<00:01, 53.25it/s, epoch=13/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.25it/s, epoch=13/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.22it/s, epoch=14/50, avg_epoch_loss=0.18] 93%|█████████▎| 1066/1143 [00:20<00:01, 52.02it/s, epoch=14/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.36it/s, epoch=14/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.07it/s, epoch=15/50, avg_epoch_loss=0.181] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.12it/s, epoch=15/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.06it/s, epoch=15/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.95it/s, epoch=16/50, avg_epoch_loss=0.179] 96%|█████████▋| 1101/1143 [00:20<00:00, 55.00it/s, epoch=16/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.97it/s, epoch=16/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.02it/s, epoch=17/50, avg_epoch_loss=0.18] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.19it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.15it/s, epoch=17/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.74it/s, epoch=18/50, avg_epoch_loss=0.179] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.09it/s, epoch=18/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.20it/s, epoch=18/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.09it/s, epoch=19/50, avg_epoch_loss=0.179] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.01it/s, epoch=19/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.07it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.82it/s, epoch=20/50, avg_epoch_loss=0.179] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.68it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.76it/s, epoch=20/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.21it/s, epoch=21/50, avg_epoch_loss=0.177] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.85it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.80it/s, epoch=21/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.18it/s, epoch=22/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.78it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.82it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.48it/s, epoch=23/50, avg_epoch_loss=0.177] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.19it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.16it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.32it/s, epoch=24/50, avg_epoch_loss=0.179] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.46it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.52it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.31it/s, epoch=25/50, avg_epoch_loss=0.177] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.03it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.13it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.50it/s, epoch=26/50, avg_epoch_loss=0.178] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.13it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.22it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.79it/s, epoch=27/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.86it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.87it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.95it/s, epoch=28/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.71it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.70it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.78it/s, epoch=29/50, avg_epoch_loss=0.178] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.97it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.97it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.11it/s, epoch=30/50, avg_epoch_loss=0.178] 93%|█████████▎| 1065/1143 [00:20<00:01, 53.17it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.25it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.34it/s, epoch=31/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.84it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.80it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.48it/s, epoch=32/50, avg_epoch_loss=0.177] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.34it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.26it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.50it/s, epoch=33/50, avg_epoch_loss=0.178] 96%|█████████▌| 1093/1143 [00:20<00:00, 54.67it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.69it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.14it/s, epoch=34/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.79it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.82it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.89it/s, epoch=35/50, avg_epoch_loss=0.178] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.66it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.74it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.48it/s, epoch=36/50, avg_epoch_loss=0.177] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.47it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.42it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.50it/s, epoch=37/50, avg_epoch_loss=0.177] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.52it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.18it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.88it/s, epoch=38/50, avg_epoch_loss=0.178] 94%|█████████▍| 1077/1143 [00:20<00:01, 54.00it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.80it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.09it/s, epoch=39/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.73it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.76it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.67it/s, epoch=40/50, avg_epoch_loss=0.177] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.69it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.68it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.66it/s, epoch=41/50, avg_epoch_loss=0.177] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.72it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.72it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.37it/s, epoch=42/50, avg_epoch_loss=0.177] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.45it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.38it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.84it/s, epoch=43/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.22it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.06it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.09it/s, epoch=44/50, avg_epoch_loss=0.178] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.24it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.22it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.93it/s, epoch=45/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.89it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.88it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.60it/s, epoch=46/50, avg_epoch_loss=0.177] 96%|█████████▌| 1095/1143 [00:20<00:00, 54.72it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.69it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.15it/s, epoch=47/50, avg_epoch_loss=0.176] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.47it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.43it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.01it/s, epoch=48/50, avg_epoch_loss=0.177] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.36it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.32it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.15it/s, epoch=49/50, avg_epoch_loss=0.176] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.84it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.87it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.54it/s, epoch=50/50, avg_epoch_loss=0.177] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.22it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.26it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 90.02797235362232 seconds
Parameter global_layers with value 10 had evaluation 2.2235178106807174
The best value for global_layers is 8 with evaluation 2.176482672455858
 md[global_layers] = 8
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 5, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1052.8954336419702 seconds
Creating forecasts took 172.96338409371674 seconds
 Start rescaling
Rescaling took 398.5213115513325 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.50it/s, epoch=1/50, avg_epoch_loss=0.248] 98%|█████████▊| 1117/1143 [00:20<00:00, 56.02it/s, epoch=1/50, avg_epoch_loss=0.215]100%|██████████| 1143/1143 [00:20<00:00, 55.84it/s, epoch=1/50, avg_epoch_loss=0.214]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.44it/s, epoch=2/50, avg_epoch_loss=0.181] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.45it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 56.42it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.93it/s, epoch=3/50, avg_epoch_loss=0.18] 98%|█████████▊| 1123/1143 [00:20<00:00, 56.14it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.08it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.97it/s, epoch=4/50, avg_epoch_loss=0.181] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.98it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 56.00it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.63it/s, epoch=5/50, avg_epoch_loss=0.181] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.25it/s, epoch=5/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 56.32it/s, epoch=5/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 568/1143 [00:10<00:10, 56.77it/s, epoch=6/50, avg_epoch_loss=0.18] 99%|█████████▉| 1136/1143 [00:20<00:00, 56.33it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.40it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.19it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.55it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 569/1143 [00:10<00:10, 56.85it/s, epoch=8/50, avg_epoch_loss=0.181]100%|█████████▉| 1138/1143 [00:20<00:00, 56.36it/s, epoch=8/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 56.43it/s, epoch=8/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.47it/s, epoch=9/50, avg_epoch_loss=0.181] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.44it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.45it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.69it/s, epoch=10/50, avg_epoch_loss=0.179] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.28it/s, epoch=10/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.36it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.09it/s, epoch=11/50, avg_epoch_loss=0.18] 98%|█████████▊| 1125/1143 [00:20<00:00, 56.27it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.24it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.90it/s, epoch=12/50, avg_epoch_loss=0.179] 99%|█████████▊| 1127/1143 [00:20<00:00, 56.33it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.29it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.06it/s, epoch=13/50, avg_epoch_loss=0.179] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.79it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.85it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.17it/s, epoch=14/50, avg_epoch_loss=0.178] 98%|█████████▊| 1124/1143 [00:20<00:00, 56.08it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.08it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.73it/s, epoch=15/50, avg_epoch_loss=0.179] 98%|█████████▊| 1121/1143 [00:20<00:00, 56.02it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.00it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.45it/s, epoch=16/50, avg_epoch_loss=0.178] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.06it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.14it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.76it/s, epoch=17/50, avg_epoch_loss=0.178] 98%|█████████▊| 1117/1143 [00:20<00:00, 55.83it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.82it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.33it/s, epoch=18/50, avg_epoch_loss=0.178] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.15it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.19it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.24it/s, epoch=19/50, avg_epoch_loss=0.178] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.48it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.45it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.92it/s, epoch=20/50, avg_epoch_loss=0.178] 98%|█████████▊| 1123/1143 [00:20<00:00, 56.13it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.05it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.21it/s, epoch=21/50, avg_epoch_loss=0.177] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.02it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.07it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.05it/s, epoch=22/50, avg_epoch_loss=0.178] 99%|█████████▊| 1127/1143 [00:20<00:00, 56.35it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.29it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.10it/s, epoch=23/50, avg_epoch_loss=0.177] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.41it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.37it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.77it/s, epoch=24/50, avg_epoch_loss=0.178] 98%|█████████▊| 1121/1143 [00:20<00:00, 56.04it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.97it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.83it/s, epoch=25/50, avg_epoch_loss=0.178] 49%|████▉     | 559/1143 [00:20<00:10, 55.83it/s, epoch=25/50, avg_epoch_loss=0.177] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.22it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.36it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.78it/s, epoch=26/50, avg_epoch_loss=0.178] 98%|█████████▊| 1117/1143 [00:20<00:00, 55.82it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.84it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 566/1143 [00:10<00:10, 56.56it/s, epoch=27/50, avg_epoch_loss=0.178] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.43it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.42it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.58it/s, epoch=28/50, avg_epoch_loss=0.178] 98%|█████████▊| 1121/1143 [00:20<00:00, 56.08it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.98it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.88it/s, epoch=29/50, avg_epoch_loss=0.177] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.84it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.88it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.35it/s, epoch=30/50, avg_epoch_loss=0.178] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.18it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.22it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.22it/s, epoch=31/50, avg_epoch_loss=0.177] 99%|█████████▊| 1126/1143 [00:20<00:00, 55.61it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.67it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.18it/s, epoch=32/50, avg_epoch_loss=0.178] 98%|█████████▊| 1124/1143 [00:20<00:00, 56.19it/s, epoch=32/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.13it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.31it/s, epoch=33/50, avg_epoch_loss=0.179] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.83it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.78it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.82it/s, epoch=34/50, avg_epoch_loss=0.178] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.94it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.94it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.54it/s, epoch=35/50, avg_epoch_loss=0.178] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.27it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.21it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.39it/s, epoch=36/50, avg_epoch_loss=0.177] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.49it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.56it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.92it/s, epoch=37/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.62it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.67it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.91it/s, epoch=38/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.18it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.18it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.74it/s, epoch=39/50, avg_epoch_loss=0.177] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.41it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.51it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.10it/s, epoch=40/50, avg_epoch_loss=0.177] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.77it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.77it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.46it/s, epoch=41/50, avg_epoch_loss=0.177] 99%|█████████▉| 1130/1143 [00:20<00:00, 55.67it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.80it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.46it/s, epoch=42/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.09it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.11it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.29it/s, epoch=43/50, avg_epoch_loss=0.177] 48%|████▊     | 554/1143 [00:20<00:10, 55.29it/s, epoch=43/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.93it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.01it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.38it/s, epoch=44/50, avg_epoch_loss=0.178] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.04it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.04it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.12it/s, epoch=45/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.94it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.02it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.27it/s, epoch=46/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.84it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.95it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.83it/s, epoch=47/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.63it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.66it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.25it/s, epoch=48/50, avg_epoch_loss=0.178] 95%|█████████▌| 1087/1143 [00:20<00:01, 54.30it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.36it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.77it/s, epoch=49/50, avg_epoch_loss=0.177] 95%|█████████▍| 1081/1143 [00:20<00:01, 54.08it/s, epoch=49/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:21<00:00, 53.80it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.89it/s, epoch=50/50, avg_epoch_loss=0.177] 93%|█████████▎| 1067/1143 [00:20<00:01, 53.40it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.37it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.92584415897727 seconds
Parameter factors with value 5 had evaluation 2.1925394347899196
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 10, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1026.2795340176672 seconds
Creating forecasts took 172.9870835673064 seconds
 Start rescaling
Rescaling took 398.55122212693095 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.59it/s, epoch=1/50, avg_epoch_loss=0.25] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.75it/s, epoch=1/50, avg_epoch_loss=0.216]100%|██████████| 1143/1143 [00:20<00:00, 54.64it/s, epoch=1/50, avg_epoch_loss=0.215]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.68it/s, epoch=2/50, avg_epoch_loss=0.18] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.22it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.16it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.43it/s, epoch=3/50, avg_epoch_loss=0.18] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.14it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.15it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.95it/s, epoch=4/50, avg_epoch_loss=0.181] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.36it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.27it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.91it/s, epoch=5/50, avg_epoch_loss=0.18] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.89it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.76it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.95it/s, epoch=6/50, avg_epoch_loss=0.181] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.22it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.17it/s, epoch=6/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.79it/s, epoch=7/50, avg_epoch_loss=0.18] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.41it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.39it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.29it/s, epoch=8/50, avg_epoch_loss=0.18] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.47it/s, epoch=8/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.44it/s, epoch=8/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.69it/s, epoch=9/50, avg_epoch_loss=0.18] 96%|█████████▌| 1100/1143 [00:20<00:00, 55.00it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.97it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.24it/s, epoch=10/50, avg_epoch_loss=0.179] 95%|█████████▌| 1086/1143 [00:20<00:01, 53.93it/s, epoch=10/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.01it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.40it/s, epoch=11/50, avg_epoch_loss=0.181] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.34it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.32it/s, epoch=11/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.60it/s, epoch=12/50, avg_epoch_loss=0.18] 95%|█████████▍| 1082/1143 [00:20<00:01, 54.12it/s, epoch=12/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.91it/s, epoch=12/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.72it/s, epoch=13/50, avg_epoch_loss=0.18] 94%|█████████▍| 1076/1143 [00:20<00:01, 52.50it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.65it/s, epoch=13/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.71it/s, epoch=14/50, avg_epoch_loss=0.18] 94%|█████████▍| 1079/1143 [00:20<00:01, 53.92it/s, epoch=14/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.93it/s, epoch=14/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.26it/s, epoch=15/50, avg_epoch_loss=0.18] 95%|█████████▌| 1086/1143 [00:20<00:01, 54.08it/s, epoch=15/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.04it/s, epoch=15/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.87it/s, epoch=16/50, avg_epoch_loss=0.179] 94%|█████████▍| 1079/1143 [00:20<00:01, 53.90it/s, epoch=16/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.96it/s, epoch=16/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.81it/s, epoch=17/50, avg_epoch_loss=0.18] 95%|█████████▌| 1089/1143 [00:20<00:00, 54.45it/s, epoch=17/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.44it/s, epoch=17/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.35it/s, epoch=18/50, avg_epoch_loss=0.18] 98%|█████████▊| 1117/1143 [00:20<00:00, 55.89it/s, epoch=18/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.83it/s, epoch=18/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.19it/s, epoch=19/50, avg_epoch_loss=0.18] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.27it/s, epoch=19/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.28it/s, epoch=19/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.18it/s, epoch=20/50, avg_epoch_loss=0.18] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.54it/s, epoch=20/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.51it/s, epoch=20/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.50it/s, epoch=21/50, avg_epoch_loss=0.179] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.51it/s, epoch=21/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.43it/s, epoch=21/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.91it/s, epoch=22/50, avg_epoch_loss=0.18] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.63it/s, epoch=22/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.63it/s, epoch=22/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.43it/s, epoch=23/50, avg_epoch_loss=0.179] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.24it/s, epoch=23/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.32it/s, epoch=23/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.47it/s, epoch=24/50, avg_epoch_loss=0.18] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.06it/s, epoch=24/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.06it/s, epoch=24/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.47it/s, epoch=25/50, avg_epoch_loss=0.179] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.45it/s, epoch=25/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.46it/s, epoch=25/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.28it/s, epoch=26/50, avg_epoch_loss=0.18] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.99it/s, epoch=26/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.88it/s, epoch=26/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.49it/s, epoch=27/50, avg_epoch_loss=0.179] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.21it/s, epoch=27/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.32it/s, epoch=27/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.80it/s, epoch=28/50, avg_epoch_loss=0.18] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.93it/s, epoch=28/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.91it/s, epoch=28/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.23it/s, epoch=29/50, avg_epoch_loss=0.179] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.78it/s, epoch=29/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.84it/s, epoch=29/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.92it/s, epoch=30/50, avg_epoch_loss=0.18] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.26it/s, epoch=30/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.24it/s, epoch=30/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.91it/s, epoch=31/50, avg_epoch_loss=0.179] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.13it/s, epoch=31/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.14it/s, epoch=31/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.74it/s, epoch=32/50, avg_epoch_loss=0.18] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.16it/s, epoch=32/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.09it/s, epoch=32/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.20it/s, epoch=33/50, avg_epoch_loss=0.179] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.17it/s, epoch=33/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.12it/s, epoch=33/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.24it/s, epoch=34/50, avg_epoch_loss=0.178] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.39it/s, epoch=34/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.37it/s, epoch=34/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.44it/s, epoch=35/50, avg_epoch_loss=0.18] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.53it/s, epoch=35/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.50it/s, epoch=35/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.39it/s, epoch=36/50, avg_epoch_loss=0.179] 96%|█████████▋| 1101/1143 [00:20<00:00, 55.11it/s, epoch=36/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.96it/s, epoch=36/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.97it/s, epoch=37/50, avg_epoch_loss=0.179] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.74it/s, epoch=37/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.76it/s, epoch=37/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.12it/s, epoch=38/50, avg_epoch_loss=0.179] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.36it/s, epoch=38/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.45it/s, epoch=38/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.75it/s, epoch=39/50, avg_epoch_loss=0.179] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.74it/s, epoch=39/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.79it/s, epoch=39/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.63it/s, epoch=40/50, avg_epoch_loss=0.179] 96%|█████████▌| 1095/1143 [00:20<00:00, 54.73it/s, epoch=40/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.75it/s, epoch=40/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.75it/s, epoch=41/50, avg_epoch_loss=0.179] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.91it/s, epoch=41/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.91it/s, epoch=41/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.60it/s, epoch=42/50, avg_epoch_loss=0.18] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.37it/s, epoch=42/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.40it/s, epoch=42/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.20it/s, epoch=43/50, avg_epoch_loss=0.18] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.56it/s, epoch=43/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.51it/s, epoch=43/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.45it/s, epoch=44/50, avg_epoch_loss=0.18] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.99it/s, epoch=44/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.93it/s, epoch=44/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.33it/s, epoch=45/50, avg_epoch_loss=0.178] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.82it/s, epoch=45/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.73it/s, epoch=45/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.15it/s, epoch=46/50, avg_epoch_loss=0.179] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.36it/s, epoch=46/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.33it/s, epoch=46/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.25it/s, epoch=47/50, avg_epoch_loss=0.178] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.54it/s, epoch=47/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.52it/s, epoch=47/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.44it/s, epoch=48/50, avg_epoch_loss=0.18] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.41it/s, epoch=48/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.42it/s, epoch=48/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.45it/s, epoch=49/50, avg_epoch_loss=0.179] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.15it/s, epoch=49/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.22it/s, epoch=49/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.29it/s, epoch=50/50, avg_epoch_loss=0.179] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.82it/s, epoch=50/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.88it/s, epoch=50/50, avg_epoch_loss=0.179]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 84.17802273482084 seconds
Parameter factors with value 10 had evaluation 2.396976982822097
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 15, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1042.5041861925274 seconds
Creating forecasts took 173.36499241366982 seconds
 Start rescaling
Rescaling took 397.9866289291531 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.06it/s, epoch=1/50, avg_epoch_loss=0.241] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.41it/s, epoch=1/50, avg_epoch_loss=0.212]100%|██████████| 1143/1143 [00:20<00:00, 55.40it/s, epoch=1/50, avg_epoch_loss=0.211]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.22it/s, epoch=2/50, avg_epoch_loss=0.182] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.49it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 56.43it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.44it/s, epoch=3/50, avg_epoch_loss=0.18] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.37it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 56.39it/s, epoch=3/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.00it/s, epoch=4/50, avg_epoch_loss=0.182] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.90it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.90it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 566/1143 [00:10<00:10, 56.57it/s, epoch=5/50, avg_epoch_loss=0.181] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.26it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.31it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.36it/s, epoch=6/50, avg_epoch_loss=0.181] 99%|█████████▊| 1128/1143 [00:20<00:00, 55.63it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.77it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 569/1143 [00:10<00:10, 56.82it/s, epoch=7/50, avg_epoch_loss=0.18]100%|█████████▉| 1138/1143 [00:20<00:00, 56.29it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.38it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.46it/s, epoch=8/50, avg_epoch_loss=0.18] 99%|█████████▉| 1131/1143 [00:20<00:00, 56.53it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.50it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.45it/s, epoch=9/50, avg_epoch_loss=0.18] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.32it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.35it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.44it/s, epoch=10/50, avg_epoch_loss=0.179] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.31it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.34it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.09it/s, epoch=11/50, avg_epoch_loss=0.179]100%|█████████▉| 1142/1143 [00:20<00:00, 56.46it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.56it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.42it/s, epoch=12/50, avg_epoch_loss=0.178]100%|█████████▉| 1138/1143 [00:20<00:00, 56.89it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.82it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.13it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.91it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.02it/s, epoch=14/50, avg_epoch_loss=0.178]100%|█████████▉| 1142/1143 [00:20<00:00, 55.90it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.06it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.81it/s, epoch=15/50, avg_epoch_loss=0.178] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.49it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.44it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.24it/s, epoch=16/50, avg_epoch_loss=0.178] 99%|█████████▉| 1131/1143 [00:20<00:00, 56.51it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.49it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.66it/s, epoch=17/50, avg_epoch_loss=0.178] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.18it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.26it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.65it/s, epoch=18/50, avg_epoch_loss=0.178] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.41it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.42it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.43it/s, epoch=19/50, avg_epoch_loss=0.178] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.12it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.17it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.82it/s, epoch=20/50, avg_epoch_loss=0.178] 98%|█████████▊| 1121/1143 [00:20<00:00, 55.99it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.99it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.34it/s, epoch=21/50, avg_epoch_loss=0.177] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.26it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.27it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.98it/s, epoch=22/50, avg_epoch_loss=0.178] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.61it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.67it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.01it/s, epoch=23/50, avg_epoch_loss=0.177] 99%|█████████▉| 1131/1143 [00:20<00:00, 56.55it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.47it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.62it/s, epoch=24/50, avg_epoch_loss=0.178] 99%|█████████▉| 1134/1143 [00:20<00:00, 55.95it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.05it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.28it/s, epoch=25/50, avg_epoch_loss=0.176] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.80it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.81it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.54it/s, epoch=26/50, avg_epoch_loss=0.177] 96%|█████████▋| 1101/1143 [00:20<00:00, 55.07it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.03it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.41it/s, epoch=27/50, avg_epoch_loss=0.177] 97%|█████████▋| 1110/1143 [00:20<00:00, 54.65it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.73it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.28it/s, epoch=28/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.21it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.23it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.86it/s, epoch=29/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.64it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.74it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.76it/s, epoch=30/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.58it/s, epoch=30/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.68it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.82it/s, epoch=31/50, avg_epoch_loss=0.177] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.88it/s, epoch=31/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.89it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.83it/s, epoch=32/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.58it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.51it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.71it/s, epoch=33/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 54.76it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.96it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.14it/s, epoch=34/50, avg_epoch_loss=0.177] 98%|█████████▊| 1124/1143 [00:20<00:00, 55.91it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.93it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.09it/s, epoch=35/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.28it/s, epoch=35/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.26it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.26it/s, epoch=36/50, avg_epoch_loss=0.176] 48%|████▊     | 553/1143 [00:20<00:10, 55.26it/s, epoch=36/50, avg_epoch_loss=0.177] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.05it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.05it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.18it/s, epoch=37/50, avg_epoch_loss=0.178] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.24it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.18it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.57it/s, epoch=38/50, avg_epoch_loss=0.177] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.55it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.55it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.01it/s, epoch=39/50, avg_epoch_loss=0.178] 98%|█████████▊| 1122/1143 [00:20<00:00, 56.05it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.06it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.42it/s, epoch=40/50, avg_epoch_loss=0.177] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.12it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.16it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.59it/s, epoch=41/50, avg_epoch_loss=0.177] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.68it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.69it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.06it/s, epoch=42/50, avg_epoch_loss=0.176] 98%|█████████▊| 1122/1143 [00:20<00:00, 54.86it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.02it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.08it/s, epoch=43/50, avg_epoch_loss=0.178] 98%|█████████▊| 1122/1143 [00:20<00:00, 56.07it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.04it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.57it/s, epoch=44/50, avg_epoch_loss=0.178] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.72it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.72it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.64it/s, epoch=45/50, avg_epoch_loss=0.176] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.21it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.27it/s, epoch=45/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.46it/s, epoch=46/50, avg_epoch_loss=0.178] 98%|█████████▊| 1121/1143 [00:20<00:00, 56.13it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.05it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.14it/s, epoch=47/50, avg_epoch_loss=0.176] 98%|█████████▊| 1124/1143 [00:20<00:00, 56.09it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.10it/s, epoch=47/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.44it/s, epoch=48/50, avg_epoch_loss=0.178] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.58it/s, epoch=48/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.54it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.50it/s, epoch=49/50, avg_epoch_loss=0.176] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.27it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.16it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.84it/s, epoch=50/50, avg_epoch_loss=0.177] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.63it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.67it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 84.28899094834924 seconds
Parameter factors with value 15 had evaluation 2.2633399256088755
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 20, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1024.6072754226625 seconds
Creating forecasts took 173.38127107173204 seconds
 Start rescaling
Rescaling took 398.60396357253194 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.39it/s, epoch=1/50, avg_epoch_loss=0.241] 96%|█████████▌| 1093/1143 [00:20<00:00, 54.67it/s, epoch=1/50, avg_epoch_loss=0.212]100%|██████████| 1143/1143 [00:20<00:00, 54.68it/s, epoch=1/50, avg_epoch_loss=0.21] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.81it/s, epoch=2/50, avg_epoch_loss=0.181] 96%|█████████▋| 1101/1143 [00:20<00:00, 54.99it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.97it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.96it/s, epoch=3/50, avg_epoch_loss=0.18] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.78it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.82it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.63it/s, epoch=4/50, avg_epoch_loss=0.181] 96%|█████████▋| 1101/1143 [00:20<00:00, 55.03it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.88it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.29it/s, epoch=5/50, avg_epoch_loss=0.18] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.02it/s, epoch=5/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.04it/s, epoch=5/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.70it/s, epoch=6/50, avg_epoch_loss=0.181] 96%|█████████▌| 1094/1143 [00:20<00:00, 53.61it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.80it/s, epoch=6/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.16it/s, epoch=7/50, avg_epoch_loss=0.18] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.55it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.55it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.06it/s, epoch=8/50, avg_epoch_loss=0.181] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.50it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.52it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.14it/s, epoch=9/50, avg_epoch_loss=0.18] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.48it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.47it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.17it/s, epoch=10/50, avg_epoch_loss=0.179] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.97it/s, epoch=10/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.02it/s, epoch=10/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.93it/s, epoch=11/50, avg_epoch_loss=0.181] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.95it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.95it/s, epoch=11/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.20it/s, epoch=12/50, avg_epoch_loss=0.179] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.16it/s, epoch=12/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.14it/s, epoch=12/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.09it/s, epoch=13/50, avg_epoch_loss=0.18] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.95it/s, epoch=13/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.00it/s, epoch=13/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.33it/s, epoch=14/50, avg_epoch_loss=0.179] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.41it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.39it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.39it/s, epoch=15/50, avg_epoch_loss=0.18] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.32it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.33it/s, epoch=15/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.27it/s, epoch=16/50, avg_epoch_loss=0.179] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.71it/s, epoch=16/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.65it/s, epoch=16/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.99it/s, epoch=17/50, avg_epoch_loss=0.18] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.45it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.38it/s, epoch=17/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.66it/s, epoch=18/50, avg_epoch_loss=0.18] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.29it/s, epoch=18/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.32it/s, epoch=18/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.71it/s, epoch=19/50, avg_epoch_loss=0.179] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.53it/s, epoch=19/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.52it/s, epoch=19/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.09it/s, epoch=20/50, avg_epoch_loss=0.18] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.60it/s, epoch=20/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.62it/s, epoch=20/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.81it/s, epoch=21/50, avg_epoch_loss=0.179] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.80it/s, epoch=21/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.82it/s, epoch=21/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.43it/s, epoch=22/50, avg_epoch_loss=0.18] 97%|█████████▋| 1110/1143 [00:20<00:00, 54.88it/s, epoch=22/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.98it/s, epoch=22/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.56it/s, epoch=23/50, avg_epoch_loss=0.178] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.65it/s, epoch=23/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.57it/s, epoch=23/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.33it/s, epoch=24/50, avg_epoch_loss=0.18] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.97it/s, epoch=24/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.85it/s, epoch=24/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.99it/s, epoch=25/50, avg_epoch_loss=0.179] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.67it/s, epoch=25/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.61it/s, epoch=25/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.48it/s, epoch=26/50, avg_epoch_loss=0.179] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.44it/s, epoch=26/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.41it/s, epoch=26/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.87it/s, epoch=27/50, avg_epoch_loss=0.179] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.39it/s, epoch=27/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.34it/s, epoch=27/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.99it/s, epoch=28/50, avg_epoch_loss=0.179] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.13it/s, epoch=28/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.07it/s, epoch=28/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.99it/s, epoch=29/50, avg_epoch_loss=0.178] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.77it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.82it/s, epoch=29/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.83it/s, epoch=30/50, avg_epoch_loss=0.179] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.80it/s, epoch=30/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.82it/s, epoch=30/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.38it/s, epoch=31/50, avg_epoch_loss=0.178] 97%|█████████▋| 1113/1143 [00:20<00:00, 55.68it/s, epoch=31/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.66it/s, epoch=31/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.49it/s, epoch=32/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.33it/s, epoch=32/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.38it/s, epoch=32/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.57it/s, epoch=33/50, avg_epoch_loss=0.179] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.65it/s, epoch=33/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.66it/s, epoch=33/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.75it/s, epoch=34/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.34it/s, epoch=34/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.41it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.49it/s, epoch=35/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.44it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.44it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.85it/s, epoch=36/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.65it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.73it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.82it/s, epoch=37/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.80it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.86it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.58it/s, epoch=38/50, avg_epoch_loss=0.177] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.15it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.20it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.13it/s, epoch=39/50, avg_epoch_loss=0.178] 95%|█████████▌| 1089/1143 [00:20<00:00, 54.44it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.45it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.16it/s, epoch=40/50, avg_epoch_loss=0.177] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.14it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.20it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.92it/s, epoch=41/50, avg_epoch_loss=0.178] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.71it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.79it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.35it/s, epoch=42/50, avg_epoch_loss=0.177] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.10it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.13it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.64it/s, epoch=43/50, avg_epoch_loss=0.177] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.79it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.85it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.08it/s, epoch=44/50, avg_epoch_loss=0.178] 95%|█████████▍| 1082/1143 [00:20<00:01, 53.68it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.78it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.07it/s, epoch=45/50, avg_epoch_loss=0.177] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.22it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.18it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.34it/s, epoch=46/50, avg_epoch_loss=0.178] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.73it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.85it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.30it/s, epoch=47/50, avg_epoch_loss=0.176] 99%|█████████▊| 1126/1143 [00:20<00:00, 55.81it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.89it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.68it/s, epoch=48/50, avg_epoch_loss=0.177] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.73it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.74it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.48it/s, epoch=49/50, avg_epoch_loss=0.177] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.33it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.26it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.07it/s, epoch=50/50, avg_epoch_loss=0.178] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.20it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.23it/s, epoch=50/50, avg_epoch_loss=0.178]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 85.1989572122693 seconds
Parameter factors with value 20 had evaluation 2.367062706574612
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 25, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1040.8093798682094 seconds
Creating forecasts took 172.24119464680552 seconds
 Start rescaling
Rescaling took 398.5625534746796 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.17it/s, epoch=1/50, avg_epoch_loss=0.248] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.91it/s, epoch=1/50, avg_epoch_loss=0.215]100%|██████████| 1143/1143 [00:20<00:00, 54.93it/s, epoch=1/50, avg_epoch_loss=0.214]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.38it/s, epoch=2/50, avg_epoch_loss=0.181] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.57it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.56it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.54it/s, epoch=3/50, avg_epoch_loss=0.181] 97%|█████████▋| 1112/1143 [00:20<00:00, 53.99it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.23it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.35it/s, epoch=4/50, avg_epoch_loss=0.181] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.72it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.64it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.73it/s, epoch=5/50, avg_epoch_loss=0.18] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.67it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.71it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.83it/s, epoch=6/50, avg_epoch_loss=0.18] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.90it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.73it/s, epoch=6/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.64it/s, epoch=7/50, avg_epoch_loss=0.181] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.43it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.46it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.60it/s, epoch=8/50, avg_epoch_loss=0.18] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.01it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.10it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.25it/s, epoch=9/50, avg_epoch_loss=0.18] 95%|█████████▌| 1086/1143 [00:20<00:01, 53.26it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.47it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.74it/s, epoch=10/50, avg_epoch_loss=0.18] 96%|█████████▌| 1097/1143 [00:20<00:00, 55.01it/s, epoch=10/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.83it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 568/1143 [00:10<00:10, 56.74it/s, epoch=11/50, avg_epoch_loss=0.18] 99%|█████████▉| 1136/1143 [00:20<00:00, 56.31it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.38it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.98it/s, epoch=12/50, avg_epoch_loss=0.179] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.90it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.94it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.38it/s, epoch=13/50, avg_epoch_loss=0.18] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.29it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.32it/s, epoch=13/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.75it/s, epoch=14/50, avg_epoch_loss=0.179] 98%|█████████▊| 1124/1143 [00:20<00:00, 56.22it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.17it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.39it/s, epoch=15/50, avg_epoch_loss=0.18] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.25it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.28it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 568/1143 [00:10<00:10, 56.73it/s, epoch=16/50, avg_epoch_loss=0.179] 99%|█████████▉| 1136/1143 [00:20<00:00, 56.10it/s, epoch=16/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.19it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.39it/s, epoch=17/50, avg_epoch_loss=0.179] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.05it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.11it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.45it/s, epoch=18/50, avg_epoch_loss=0.179] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.07it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.12it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.07it/s, epoch=19/50, avg_epoch_loss=0.179] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.70it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.74it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.32it/s, epoch=20/50, avg_epoch_loss=0.179] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.56it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.50it/s, epoch=20/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.05it/s, epoch=21/50, avg_epoch_loss=0.178] 98%|█████████▊| 1122/1143 [00:20<00:00, 56.05it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.06it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.07it/s, epoch=22/50, avg_epoch_loss=0.178] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.96it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.97it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 566/1143 [00:10<00:10, 56.56it/s, epoch=23/50, avg_epoch_loss=0.177] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.05it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.13it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.93it/s, epoch=24/50, avg_epoch_loss=0.178] 98%|█████████▊| 1121/1143 [00:20<00:00, 56.03it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.02it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.89it/s, epoch=25/50, avg_epoch_loss=0.178] 98%|█████████▊| 1121/1143 [00:20<00:00, 56.04it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.04it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.78it/s, epoch=26/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.55it/s, epoch=26/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.60it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.78it/s, epoch=27/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.63it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.61it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.76it/s, epoch=28/50, avg_epoch_loss=0.178] 98%|█████████▊| 1119/1143 [00:20<00:00, 55.96it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.94it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.83it/s, epoch=29/50, avg_epoch_loss=0.177] 98%|█████████▊| 1119/1143 [00:20<00:00, 55.87it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.85it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.04it/s, epoch=30/50, avg_epoch_loss=0.178] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.27it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.20it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.67it/s, epoch=31/50, avg_epoch_loss=0.178] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.71it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.64it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.99it/s, epoch=32/50, avg_epoch_loss=0.178] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.76it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.82it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.89it/s, epoch=33/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.83it/s, epoch=33/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.86it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.74it/s, epoch=34/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.53it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.49it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.25it/s, epoch=35/50, avg_epoch_loss=0.179] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.45it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.21it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.06it/s, epoch=36/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.95it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.01it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.59it/s, epoch=37/50, avg_epoch_loss=0.177] 98%|█████████▊| 1122/1143 [00:20<00:00, 56.16it/s, epoch=37/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.04it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.07it/s, epoch=38/50, avg_epoch_loss=0.177] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.96it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.97it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.61it/s, epoch=39/50, avg_epoch_loss=0.177] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.48it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.51it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.21it/s, epoch=40/50, avg_epoch_loss=0.177] 99%|█████████▉| 1129/1143 [00:20<00:00, 56.39it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.37it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.58it/s, epoch=41/50, avg_epoch_loss=0.177] 98%|█████████▊| 1119/1143 [00:20<00:00, 55.98it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.94it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.15it/s, epoch=42/50, avg_epoch_loss=0.177] 98%|█████████▊| 1124/1143 [00:20<00:00, 56.00it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.04it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.61it/s, epoch=43/50, avg_epoch_loss=0.178] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.88it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.81it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.17it/s, epoch=44/50, avg_epoch_loss=0.177] 99%|█████████▊| 1127/1143 [00:20<00:00, 56.33it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.32it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.28it/s, epoch=45/50, avg_epoch_loss=0.176] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.15it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.14it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.34it/s, epoch=46/50, avg_epoch_loss=0.178] 99%|█████████▊| 1128/1143 [00:20<00:00, 55.46it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.60it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.62it/s, epoch=47/50, avg_epoch_loss=0.176] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.55it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.62it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.08it/s, epoch=48/50, avg_epoch_loss=0.177] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.98it/s, epoch=48/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.97it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.22it/s, epoch=49/50, avg_epoch_loss=0.176] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.44it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.32it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 568/1143 [00:10<00:10, 56.75it/s, epoch=50/50, avg_epoch_loss=0.177] 99%|█████████▉| 1136/1143 [00:20<00:00, 56.64it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.66it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 84.54853282123804 seconds
Parameter factors with value 25 had evaluation 2.384954110879145
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 30, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1028.8339033983648 seconds
Creating forecasts took 174.27166692726314 seconds
 Start rescaling
Rescaling took 398.1902983635664 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.64it/s, epoch=1/50, avg_epoch_loss=0.24] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.28it/s, epoch=1/50, avg_epoch_loss=0.211]100%|██████████| 1143/1143 [00:20<00:00, 55.10it/s, epoch=1/50, avg_epoch_loss=0.21] 
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.14it/s, epoch=2/50, avg_epoch_loss=0.182] 96%|█████████▋| 1101/1143 [00:20<00:00, 55.14it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.02it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.91it/s, epoch=3/50, avg_epoch_loss=0.18] 96%|█████████▋| 1101/1143 [00:20<00:00, 55.02it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.00it/s, epoch=3/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.32it/s, epoch=4/50, avg_epoch_loss=0.181] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.94it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.05it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.23it/s, epoch=5/50, avg_epoch_loss=0.18] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.46it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.40it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.74it/s, epoch=6/50, avg_epoch_loss=0.181] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.85it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.84it/s, epoch=6/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.91it/s, epoch=7/50, avg_epoch_loss=0.18] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.54it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.56it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.35it/s, epoch=8/50, avg_epoch_loss=0.18] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.80it/s, epoch=8/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.86it/s, epoch=8/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.94it/s, epoch=9/50, avg_epoch_loss=0.181] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.48it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.42it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.57it/s, epoch=10/50, avg_epoch_loss=0.178] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.37it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.37it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.13it/s, epoch=11/50, avg_epoch_loss=0.18] 97%|█████████▋| 1104/1143 [00:20<00:00, 53.94it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.18it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.92it/s, epoch=12/50, avg_epoch_loss=0.179] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.12it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.16it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.68it/s, epoch=13/50, avg_epoch_loss=0.178] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.31it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.26it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.94it/s, epoch=14/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.06it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.10it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.95it/s, epoch=15/50, avg_epoch_loss=0.178] 96%|█████████▋| 1101/1143 [00:20<00:00, 55.01it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.02it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.04it/s, epoch=16/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.83it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.88it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.80it/s, epoch=17/50, avg_epoch_loss=0.178] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.73it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.79it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.09it/s, epoch=18/50, avg_epoch_loss=0.179] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.20it/s, epoch=18/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.23it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.41it/s, epoch=19/50, avg_epoch_loss=0.178] 95%|█████████▌| 1090/1143 [00:20<00:00, 53.85it/s, epoch=19/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.96it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.46it/s, epoch=20/50, avg_epoch_loss=0.179] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.30it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.37it/s, epoch=20/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.73it/s, epoch=21/50, avg_epoch_loss=0.178] 94%|█████████▍| 1076/1143 [00:20<00:01, 52.84it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.02it/s, epoch=21/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.94it/s, epoch=22/50, avg_epoch_loss=0.179] 93%|█████████▎| 1060/1143 [00:20<00:01, 52.52it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.67it/s, epoch=22/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.10it/s, epoch=23/50, avg_epoch_loss=0.178] 95%|█████████▍| 1082/1143 [00:20<00:01, 54.05it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.03it/s, epoch=23/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.58it/s, epoch=24/50, avg_epoch_loss=0.178] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.41it/s, epoch=24/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.46it/s, epoch=24/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.81it/s, epoch=25/50, avg_epoch_loss=0.178] 95%|█████████▍| 1081/1143 [00:20<00:01, 54.04it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.05it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.70it/s, epoch=26/50, avg_epoch_loss=0.177] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.91it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.88it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.85it/s, epoch=27/50, avg_epoch_loss=0.178] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.78it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.80it/s, epoch=27/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.97it/s, epoch=28/50, avg_epoch_loss=0.178] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.57it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.72it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.96it/s, epoch=29/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.66it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.74it/s, epoch=29/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.20it/s, epoch=30/50, avg_epoch_loss=0.179] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.69it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.80it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.29it/s, epoch=31/50, avg_epoch_loss=0.178] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.50it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.54it/s, epoch=31/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.83it/s, epoch=32/50, avg_epoch_loss=0.179] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.19it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.05it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.87it/s, epoch=33/50, avg_epoch_loss=0.178] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.78it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.86it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.46it/s, epoch=34/50, avg_epoch_loss=0.177] 94%|█████████▍| 1080/1143 [00:20<00:01, 54.02it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.96it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.72it/s, epoch=35/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.68it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.64it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.76it/s, epoch=36/50, avg_epoch_loss=0.178] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.90it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.87it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.20it/s, epoch=37/50, avg_epoch_loss=0.178] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.32it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.30it/s, epoch=37/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.12it/s, epoch=38/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.07it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.03it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.00it/s, epoch=39/50, avg_epoch_loss=0.178] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.33it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.22it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.42it/s, epoch=40/50, avg_epoch_loss=0.177] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.29it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.28it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.17it/s, epoch=41/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.96it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.98it/s, epoch=41/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.77it/s, epoch=42/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.09it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.96it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.60it/s, epoch=43/50, avg_epoch_loss=0.178] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.50it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.47it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.69it/s, epoch=44/50, avg_epoch_loss=0.178] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.67it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.72it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.65it/s, epoch=45/50, avg_epoch_loss=0.176] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.16it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.16it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.90it/s, epoch=46/50, avg_epoch_loss=0.178] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.94it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.96it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.32it/s, epoch=47/50, avg_epoch_loss=0.177] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.22it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.25it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.94it/s, epoch=48/50, avg_epoch_loss=0.177] 95%|█████████▍| 1082/1143 [00:20<00:01, 54.08it/s, epoch=48/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.08it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.43it/s, epoch=49/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.93it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.88it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.60it/s, epoch=50/50, avg_epoch_loss=0.177] 96%|█████████▌| 1095/1143 [00:20<00:00, 54.74it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.76it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 84.16120451688766 seconds
Parameter factors with value 30 had evaluation 2.241112420172424
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 35, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1048.5021178349853 seconds
Creating forecasts took 172.37208497710526 seconds
 Start rescaling
Rescaling took 398.15033517219126 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.04it/s, epoch=1/50, avg_epoch_loss=0.228] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.42it/s, epoch=1/50, avg_epoch_loss=0.205]100%|██████████| 1143/1143 [00:20<00:00, 55.28it/s, epoch=1/50, avg_epoch_loss=0.204]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.97it/s, epoch=2/50, avg_epoch_loss=0.181] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.57it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 56.50it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.84it/s, epoch=3/50, avg_epoch_loss=0.18] 98%|█████████▊| 1121/1143 [00:20<00:00, 56.04it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.04it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.69it/s, epoch=4/50, avg_epoch_loss=0.18] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.16it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.24it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.61it/s, epoch=5/50, avg_epoch_loss=0.18] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.46it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.49it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.11it/s, epoch=6/50, avg_epoch_loss=0.181] 98%|█████████▊| 1124/1143 [00:20<00:00, 56.04it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.06it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.31it/s, epoch=7/50, avg_epoch_loss=0.18] 99%|█████████▉| 1129/1143 [00:20<00:00, 56.38it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.37it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.34it/s, epoch=8/50, avg_epoch_loss=0.18] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.49it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.43it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.55it/s, epoch=9/50, avg_epoch_loss=0.181] 98%|█████████▊| 1123/1143 [00:20<00:00, 56.17it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.06it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.48it/s, epoch=10/50, avg_epoch_loss=0.179] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.57it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.56it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.93it/s, epoch=11/50, avg_epoch_loss=0.18] 98%|█████████▊| 1124/1143 [00:20<00:00, 56.15it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.13it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.29it/s, epoch=12/50, avg_epoch_loss=0.178] 99%|█████████▉| 1131/1143 [00:20<00:00, 56.54it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.51it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 569/1143 [00:10<00:10, 56.83it/s, epoch=13/50, avg_epoch_loss=0.179]100%|█████████▉| 1138/1143 [00:20<00:00, 56.42it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.49it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 566/1143 [00:10<00:10, 56.60it/s, epoch=14/50, avg_epoch_loss=0.178] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.30it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.35it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 569/1143 [00:10<00:10, 56.84it/s, epoch=15/50, avg_epoch_loss=0.178]100%|█████████▉| 1138/1143 [00:20<00:00, 56.74it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.76it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.59it/s, epoch=16/50, avg_epoch_loss=0.179] 98%|█████████▊| 1120/1143 [00:20<00:00, 56.03it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.94it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.48it/s, epoch=17/50, avg_epoch_loss=0.178] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.38it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.40it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 570/1143 [00:10<00:10, 56.91it/s, epoch=18/50, avg_epoch_loss=0.178]100%|█████████▉| 1140/1143 [00:20<00:00, 56.64it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.68it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.44it/s, epoch=19/50, avg_epoch_loss=0.178] 98%|█████████▊| 1120/1143 [00:20<00:00, 56.04it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.95it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.21it/s, epoch=20/50, avg_epoch_loss=0.178] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.04it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.03it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.99it/s, epoch=21/50, avg_epoch_loss=0.178] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.98it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.01it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.50it/s, epoch=22/50, avg_epoch_loss=0.178] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.33it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.34it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.89it/s, epoch=23/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.73it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.72it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.84it/s, epoch=24/50, avg_epoch_loss=0.178] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.02it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.15it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.71it/s, epoch=25/50, avg_epoch_loss=0.178] 98%|█████████▊| 1121/1143 [00:20<00:00, 56.02it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.99it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.15it/s, epoch=26/50, avg_epoch_loss=0.178] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.36it/s, epoch=26/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.34it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.52it/s, epoch=27/50, avg_epoch_loss=0.178] 98%|█████████▊| 1123/1143 [00:20<00:00, 56.17it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.09it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.15it/s, epoch=28/50, avg_epoch_loss=0.178] 98%|█████████▊| 1124/1143 [00:20<00:00, 55.92it/s, epoch=28/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.94it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.81it/s, epoch=29/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.09it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.01it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.06it/s, epoch=30/50, avg_epoch_loss=0.178] 95%|█████████▍| 1082/1143 [00:20<00:01, 53.82it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.95it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.48it/s, epoch=31/50, avg_epoch_loss=0.178] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.58it/s, epoch=31/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.55it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.87it/s, epoch=32/50, avg_epoch_loss=0.179] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.69it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.75it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.42it/s, epoch=33/50, avg_epoch_loss=0.178] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.32it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.35it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.25it/s, epoch=34/50, avg_epoch_loss=0.176] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.20it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.21it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.95it/s, epoch=35/50, avg_epoch_loss=0.178] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.89it/s, epoch=35/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.92it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.40it/s, epoch=36/50, avg_epoch_loss=0.177] 99%|█████████▉| 1130/1143 [00:20<00:00, 55.83it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.94it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 566/1143 [00:10<00:10, 56.51it/s, epoch=37/50, avg_epoch_loss=0.177] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.24it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.27it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.62it/s, epoch=38/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.13it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.03it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.05it/s, epoch=39/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.56it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.61it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.18it/s, epoch=40/50, avg_epoch_loss=0.177] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.07it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.15it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.60it/s, epoch=41/50, avg_epoch_loss=0.177] 96%|█████████▌| 1095/1143 [00:20<00:00, 54.74it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.70it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.48it/s, epoch=42/50, avg_epoch_loss=0.178] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.08it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.22it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.53it/s, epoch=43/50, avg_epoch_loss=0.177] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.02it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.04it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.36it/s, epoch=44/50, avg_epoch_loss=0.178] 94%|█████████▎| 1071/1143 [00:20<00:01, 53.54it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.46it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.39it/s, epoch=45/50, avg_epoch_loss=0.176] 94%|█████████▍| 1079/1143 [00:20<00:01, 53.96it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.94it/s, epoch=45/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.64it/s, epoch=46/50, avg_epoch_loss=0.177] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.18it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.14it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.25it/s, epoch=47/50, avg_epoch_loss=0.176] 99%|█████████▊| 1126/1143 [00:20<00:00, 55.73it/s, epoch=47/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:20<00:00, 55.82it/s, epoch=47/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.83it/s, epoch=48/50, avg_epoch_loss=0.178] 98%|█████████▊| 1125/1143 [00:20<00:00, 56.27it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.20it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.81it/s, epoch=49/50, avg_epoch_loss=0.177] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.83it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.81it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.94it/s, epoch=50/50, avg_epoch_loss=0.177] 98%|█████████▊| 1123/1143 [00:20<00:00, 56.15it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.11it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.01713101379573 seconds
Parameter factors with value 35 had evaluation 2.3813552438681627
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 40, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1026.29386953637 seconds
Creating forecasts took 172.4543515164405 seconds
 Start rescaling
Rescaling took 400.4093748368323 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.37it/s, epoch=1/50, avg_epoch_loss=0.249] 96%|█████████▌| 1100/1143 [00:20<00:00, 55.07it/s, epoch=1/50, avg_epoch_loss=0.216]100%|██████████| 1143/1143 [00:20<00:00, 54.96it/s, epoch=1/50, avg_epoch_loss=0.215]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.86it/s, epoch=2/50, avg_epoch_loss=0.181] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.98it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.98it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.49it/s, epoch=3/50, avg_epoch_loss=0.18] 97%|█████████▋| 1110/1143 [00:20<00:00, 54.77it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.87it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.28it/s, epoch=4/50, avg_epoch_loss=0.181] 95%|█████████▌| 1086/1143 [00:20<00:01, 53.84it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 53.88it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 517/1143 [00:10<00:12, 51.70it/s, epoch=5/50, avg_epoch_loss=0.18] 92%|█████████▏| 1054/1143 [00:20<00:01, 52.86it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.71it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.82it/s, epoch=6/50, avg_epoch_loss=0.18] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.16it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.10it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.89it/s, epoch=7/50, avg_epoch_loss=0.18] 94%|█████████▍| 1079/1143 [00:20<00:01, 53.89it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.59it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.77it/s, epoch=8/50, avg_epoch_loss=0.179] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.73it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.73it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.08it/s, epoch=9/50, avg_epoch_loss=0.179] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.44it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.54it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.18it/s, epoch=10/50, avg_epoch_loss=0.178] 95%|█████████▌| 1089/1143 [00:20<00:00, 54.47it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.46it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.40it/s, epoch=11/50, avg_epoch_loss=0.18] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.79it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.87it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.55it/s, epoch=12/50, avg_epoch_loss=0.177] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.58it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.59it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.77it/s, epoch=13/50, avg_epoch_loss=0.177] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.48it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.55it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.23it/s, epoch=14/50, avg_epoch_loss=0.178] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.51it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.49it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.49it/s, epoch=15/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.28it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.30it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.91it/s, epoch=16/50, avg_epoch_loss=0.177] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.31it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.23it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.95it/s, epoch=17/50, avg_epoch_loss=0.179] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.46it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.51it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.95it/s, epoch=18/50, avg_epoch_loss=0.178] 95%|█████████▌| 1086/1143 [00:20<00:01, 54.28it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.16it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.44it/s, epoch=19/50, avg_epoch_loss=0.178] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.48it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.44it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.25it/s, epoch=20/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.51it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.44it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.37it/s, epoch=21/50, avg_epoch_loss=0.177] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.43it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.55it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.72it/s, epoch=22/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.48it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.53it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.13it/s, epoch=23/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.75it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.84it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.97it/s, epoch=24/50, avg_epoch_loss=0.178] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.80it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.88it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.82it/s, epoch=25/50, avg_epoch_loss=0.177] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.74it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.77it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.78it/s, epoch=26/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.44it/s, epoch=26/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.51it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.51it/s, epoch=27/50, avg_epoch_loss=0.178] 97%|█████████▋| 1112/1143 [00:20<00:00, 54.56it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.65it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.98it/s, epoch=28/50, avg_epoch_loss=0.178] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.55it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.53it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.57it/s, epoch=29/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.82it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.78it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.08it/s, epoch=30/50, avg_epoch_loss=0.178] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.13it/s, epoch=30/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.15it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.76it/s, epoch=31/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.54it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.58it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.49it/s, epoch=32/50, avg_epoch_loss=0.177] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.59it/s, epoch=32/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.61it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.26it/s, epoch=33/50, avg_epoch_loss=0.177] 95%|█████████▌| 1086/1143 [00:20<00:01, 54.04it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.04it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.95it/s, epoch=34/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.95it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.97it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.03it/s, epoch=35/50, avg_epoch_loss=0.178] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.07it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.09it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.93it/s, epoch=36/50, avg_epoch_loss=0.177] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.38it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.42it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.35it/s, epoch=37/50, avg_epoch_loss=0.178] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.49it/s, epoch=37/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.48it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.54it/s, epoch=38/50, avg_epoch_loss=0.177] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.67it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.63it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.72it/s, epoch=39/50, avg_epoch_loss=0.177] 98%|█████████▊| 1117/1143 [00:20<00:00, 55.81it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.80it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.71it/s, epoch=40/50, avg_epoch_loss=0.177] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.53it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.58it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.10it/s, epoch=41/50, avg_epoch_loss=0.178] 98%|█████████▊| 1124/1143 [00:20<00:00, 55.62it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.68it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.70it/s, epoch=42/50, avg_epoch_loss=0.178] 49%|████▉     | 558/1143 [00:20<00:10, 55.70it/s, epoch=42/50, avg_epoch_loss=0.177] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.31it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.32it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.04it/s, epoch=43/50, avg_epoch_loss=0.178] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.58it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.62it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.94it/s, epoch=44/50, avg_epoch_loss=0.177] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.44it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.29it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.60it/s, epoch=45/50, avg_epoch_loss=0.176] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.49it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.53it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.23it/s, epoch=46/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.77it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.82it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.53it/s, epoch=47/50, avg_epoch_loss=0.176] 96%|█████████▌| 1100/1143 [00:20<00:00, 55.01it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.98it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.80it/s, epoch=48/50, avg_epoch_loss=0.177] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.71it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.70it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.57it/s, epoch=49/50, avg_epoch_loss=0.176] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.77it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.81it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.48it/s, epoch=50/50, avg_epoch_loss=0.177] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.76it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.69it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.89926570653915 seconds
Parameter factors with value 40 had evaluation 2.391847958757828
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 45, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1040.7358279004693 seconds
Creating forecasts took 174.2529206238687 seconds
 Start rescaling
Rescaling took 400.8584546521306 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.00it/s, epoch=1/50, avg_epoch_loss=0.231] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.19it/s, epoch=1/50, avg_epoch_loss=0.207]100%|██████████| 1143/1143 [00:20<00:00, 55.17it/s, epoch=1/50, avg_epoch_loss=0.206]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 566/1143 [00:10<00:10, 56.60it/s, epoch=2/50, avg_epoch_loss=0.181] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.31it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 56.35it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.26it/s, epoch=3/50, avg_epoch_loss=0.181] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.73it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.64it/s, epoch=3/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.29it/s, epoch=4/50, avg_epoch_loss=0.182] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.01it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 56.06it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.03it/s, epoch=5/50, avg_epoch_loss=0.18] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.93it/s, epoch=5/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.94it/s, epoch=5/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.21it/s, epoch=6/50, avg_epoch_loss=0.181] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.13it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 56.14it/s, epoch=6/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.15it/s, epoch=7/50, avg_epoch_loss=0.18] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.37it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.36it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 566/1143 [00:10<00:10, 56.53it/s, epoch=8/50, avg_epoch_loss=0.181] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.31it/s, epoch=8/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 56.35it/s, epoch=8/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.22it/s, epoch=9/50, avg_epoch_loss=0.18] 99%|█████████▊| 1126/1143 [00:20<00:00, 55.71it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.78it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.61it/s, epoch=10/50, avg_epoch_loss=0.179] 98%|█████████▊| 1120/1143 [00:20<00:00, 56.01it/s, epoch=10/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.94it/s, epoch=10/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.25it/s, epoch=11/50, avg_epoch_loss=0.181] 99%|█████████▉| 1131/1143 [00:20<00:00, 56.56it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.52it/s, epoch=11/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.14it/s, epoch=12/50, avg_epoch_loss=0.179] 98%|█████████▊| 1124/1143 [00:20<00:00, 55.72it/s, epoch=12/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.76it/s, epoch=12/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.66it/s, epoch=13/50, avg_epoch_loss=0.179] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.52it/s, epoch=13/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.51it/s, epoch=13/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.08it/s, epoch=14/50, avg_epoch_loss=0.179] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.56it/s, epoch=14/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.66it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.98it/s, epoch=15/50, avg_epoch_loss=0.179] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.94it/s, epoch=15/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.95it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.33it/s, epoch=16/50, avg_epoch_loss=0.178] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.12it/s, epoch=16/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.16it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.76it/s, epoch=17/50, avg_epoch_loss=0.178] 98%|█████████▊| 1122/1143 [00:20<00:00, 56.10it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.07it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.43it/s, epoch=18/50, avg_epoch_loss=0.179] 97%|█████████▋| 1110/1143 [00:20<00:00, 54.62it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.79it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.40it/s, epoch=19/50, avg_epoch_loss=0.178] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.68it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.67it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.85it/s, epoch=20/50, avg_epoch_loss=0.178] 94%|█████████▍| 1079/1143 [00:20<00:01, 53.89it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.82it/s, epoch=20/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.88it/s, epoch=21/50, avg_epoch_loss=0.178] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.92it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.86it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.30it/s, epoch=22/50, avg_epoch_loss=0.179] 96%|█████████▌| 1095/1143 [00:20<00:00, 54.79it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.71it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.77it/s, epoch=23/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.38it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.47it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.93it/s, epoch=24/50, avg_epoch_loss=0.178] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.90it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.86it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.38it/s, epoch=25/50, avg_epoch_loss=0.177] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.53it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.50it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.39it/s, epoch=26/50, avg_epoch_loss=0.178] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.74it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.75it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.08it/s, epoch=27/50, avg_epoch_loss=0.177] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.60it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.54it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.40it/s, epoch=28/50, avg_epoch_loss=0.178] 98%|█████████▊| 1119/1143 [00:20<00:00, 56.00it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.92it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.70it/s, epoch=29/50, avg_epoch_loss=0.178] 99%|█████████▉| 1134/1143 [00:20<00:00, 55.82it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.95it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.95it/s, epoch=30/50, avg_epoch_loss=0.178] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.58it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.69it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.17it/s, epoch=31/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.94it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.01it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.51it/s, epoch=32/50, avg_epoch_loss=0.178] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.71it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.63it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.44it/s, epoch=33/50, avg_epoch_loss=0.178] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.66it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.67it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.83it/s, epoch=34/50, avg_epoch_loss=0.178] 98%|█████████▊| 1122/1143 [00:20<00:00, 56.09it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.06it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.39it/s, epoch=35/50, avg_epoch_loss=0.178] 97%|█████████▋| 1113/1143 [00:20<00:00, 55.63it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.62it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.05it/s, epoch=36/50, avg_epoch_loss=0.177] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.76it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.81it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.07it/s, epoch=37/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.35it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.20it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.89it/s, epoch=38/50, avg_epoch_loss=0.178] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.04it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.20it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.47it/s, epoch=39/50, avg_epoch_loss=0.177] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.58it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.60it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.14it/s, epoch=40/50, avg_epoch_loss=0.177] 98%|█████████▊| 1124/1143 [00:20<00:00, 55.99it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.00it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.73it/s, epoch=41/50, avg_epoch_loss=0.177] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.67it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.62it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.59it/s, epoch=42/50, avg_epoch_loss=0.178] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.40it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.40it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.05it/s, epoch=43/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.08it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.01it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.34it/s, epoch=44/50, avg_epoch_loss=0.178] 95%|█████████▌| 1088/1143 [00:20<00:01, 53.99it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.04it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.63it/s, epoch=45/50, avg_epoch_loss=0.176] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.49it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.49it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.03it/s, epoch=46/50, avg_epoch_loss=0.177] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.21it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.14it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.43it/s, epoch=47/50, avg_epoch_loss=0.176] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.45it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.47it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.45it/s, epoch=48/50, avg_epoch_loss=0.178] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.74it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.66it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.17it/s, epoch=49/50, avg_epoch_loss=0.176] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.15it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.20it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.10it/s, epoch=50/50, avg_epoch_loss=0.177] 98%|█████████▊| 1122/1143 [00:20<00:00, 56.02it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.05it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.24265550076962 seconds
Parameter factors with value 45 had evaluation 2.215249542287415
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 50, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1031.1343422364444 seconds
Creating forecasts took 171.8322509676218 seconds
 Start rescaling
Rescaling took 398.24930277466774 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.82it/s, epoch=1/50, avg_epoch_loss=0.234] 95%|█████████▍| 1082/1143 [00:20<00:01, 54.09it/s, epoch=1/50, avg_epoch_loss=0.208]100%|██████████| 1143/1143 [00:21<00:00, 54.02it/s, epoch=1/50, avg_epoch_loss=0.207]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.71it/s, epoch=2/50, avg_epoch_loss=0.181] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.35it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 53.26it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 511/1143 [00:10<00:12, 51.07it/s, epoch=3/50, avg_epoch_loss=0.18] 92%|█████████▏| 1048/1143 [00:20<00:01, 52.57it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.49it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.92it/s, epoch=4/50, avg_epoch_loss=0.18] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.95it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 54.00it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.92it/s, epoch=5/50, avg_epoch_loss=0.18] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.13it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.10it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.24it/s, epoch=6/50, avg_epoch_loss=0.181] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.57it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.56it/s, epoch=6/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.10it/s, epoch=7/50, avg_epoch_loss=0.18] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.29it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.25it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.86it/s, epoch=8/50, avg_epoch_loss=0.181] 95%|█████████▍| 1082/1143 [00:20<00:01, 54.08it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.05it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.22it/s, epoch=9/50, avg_epoch_loss=0.18] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.88it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.97it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.04it/s, epoch=10/50, avg_epoch_loss=0.179] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.06it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.04it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.10it/s, epoch=11/50, avg_epoch_loss=0.18] 97%|█████████▋| 1103/1143 [00:20<00:00, 54.89it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.87it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.43it/s, epoch=12/50, avg_epoch_loss=0.179] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.28it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.30it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.03it/s, epoch=13/50, avg_epoch_loss=0.179] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.79it/s, epoch=13/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.80it/s, epoch=13/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.85it/s, epoch=14/50, avg_epoch_loss=0.18] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.17it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.13it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.78it/s, epoch=15/50, avg_epoch_loss=0.18] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.78it/s, epoch=15/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.71it/s, epoch=15/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.72it/s, epoch=16/50, avg_epoch_loss=0.18] 96%|█████████▌| 1096/1143 [00:20<00:00, 52.76it/s, epoch=16/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.06it/s, epoch=16/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.79it/s, epoch=17/50, avg_epoch_loss=0.179] 94%|█████████▍| 1079/1143 [00:20<00:01, 53.92it/s, epoch=17/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.88it/s, epoch=17/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.67it/s, epoch=18/50, avg_epoch_loss=0.18] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.48it/s, epoch=18/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.44it/s, epoch=18/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.92it/s, epoch=19/50, avg_epoch_loss=0.18] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.17it/s, epoch=19/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.11it/s, epoch=19/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.12it/s, epoch=20/50, avg_epoch_loss=0.179] 95%|█████████▌| 1089/1143 [00:20<00:00, 54.44it/s, epoch=20/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.42it/s, epoch=20/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.20it/s, epoch=21/50, avg_epoch_loss=0.178] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.55it/s, epoch=21/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.55it/s, epoch=21/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.02it/s, epoch=22/50, avg_epoch_loss=0.179] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.11it/s, epoch=22/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.10it/s, epoch=22/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.78it/s, epoch=23/50, avg_epoch_loss=0.179] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.66it/s, epoch=23/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.71it/s, epoch=23/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.15it/s, epoch=24/50, avg_epoch_loss=0.18] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.65it/s, epoch=24/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.72it/s, epoch=24/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.60it/s, epoch=25/50, avg_epoch_loss=0.178] 96%|█████████▌| 1100/1143 [00:20<00:00, 55.02it/s, epoch=25/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.96it/s, epoch=25/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.52it/s, epoch=26/50, avg_epoch_loss=0.179] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.79it/s, epoch=26/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.79it/s, epoch=26/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.45it/s, epoch=27/50, avg_epoch_loss=0.179] 97%|█████████▋| 1110/1143 [00:20<00:00, 54.96it/s, epoch=27/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.06it/s, epoch=27/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.06it/s, epoch=28/50, avg_epoch_loss=0.18] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.90it/s, epoch=28/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.91it/s, epoch=28/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.97it/s, epoch=29/50, avg_epoch_loss=0.179] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.87it/s, epoch=29/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.88it/s, epoch=29/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.02it/s, epoch=30/50, avg_epoch_loss=0.18] 95%|█████████▌| 1087/1143 [00:20<00:01, 54.34it/s, epoch=30/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.35it/s, epoch=30/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.01it/s, epoch=31/50, avg_epoch_loss=0.179] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.14it/s, epoch=31/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.16it/s, epoch=31/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.14it/s, epoch=32/50, avg_epoch_loss=0.18] 95%|█████████▍| 1084/1143 [00:20<00:01, 53.73it/s, epoch=32/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.87it/s, epoch=32/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.40it/s, epoch=33/50, avg_epoch_loss=0.18] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.74it/s, epoch=33/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.72it/s, epoch=33/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.56it/s, epoch=34/50, avg_epoch_loss=0.178] 96%|█████████▌| 1092/1143 [00:20<00:00, 53.90it/s, epoch=34/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.93it/s, epoch=34/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.78it/s, epoch=35/50, avg_epoch_loss=0.179] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.78it/s, epoch=35/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.73it/s, epoch=35/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 527/1143 [00:10<00:11, 52.60it/s, epoch=36/50, avg_epoch_loss=0.179] 93%|█████████▎| 1060/1143 [00:20<00:01, 53.00it/s, epoch=36/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.97it/s, epoch=36/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.23it/s, epoch=37/50, avg_epoch_loss=0.179] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.61it/s, epoch=37/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.50it/s, epoch=37/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.40it/s, epoch=38/50, avg_epoch_loss=0.178] 94%|█████████▍| 1073/1143 [00:20<00:01, 53.69it/s, epoch=38/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.64it/s, epoch=38/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.44it/s, epoch=39/50, avg_epoch_loss=0.179] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.89it/s, epoch=39/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.85it/s, epoch=39/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.07it/s, epoch=40/50, avg_epoch_loss=0.178] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.09it/s, epoch=40/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.07it/s, epoch=40/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.63it/s, epoch=41/50, avg_epoch_loss=0.179] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.40it/s, epoch=41/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.33it/s, epoch=41/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.22it/s, epoch=42/50, avg_epoch_loss=0.179] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.55it/s, epoch=42/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.35it/s, epoch=42/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.57it/s, epoch=43/50, avg_epoch_loss=0.179] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.19it/s, epoch=43/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.10it/s, epoch=43/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.67it/s, epoch=44/50, avg_epoch_loss=0.179] 95%|█████████▍| 1082/1143 [00:20<00:01, 54.12it/s, epoch=44/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.04it/s, epoch=44/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.16it/s, epoch=45/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.97it/s, epoch=45/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.00it/s, epoch=45/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.33it/s, epoch=46/50, avg_epoch_loss=0.18] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.08it/s, epoch=46/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.12it/s, epoch=46/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.59it/s, epoch=47/50, avg_epoch_loss=0.178] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.44it/s, epoch=47/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.45it/s, epoch=47/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.10it/s, epoch=48/50, avg_epoch_loss=0.179] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.20it/s, epoch=48/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.13it/s, epoch=48/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.27it/s, epoch=49/50, avg_epoch_loss=0.178] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.38it/s, epoch=49/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.35it/s, epoch=49/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.95it/s, epoch=50/50, avg_epoch_loss=0.179] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.88it/s, epoch=50/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.91it/s, epoch=50/50, avg_epoch_loss=0.179]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.88323116116226 seconds
Parameter factors with value 50 had evaluation 2.2798754734195086
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 55, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1051.6642477754503 seconds
Creating forecasts took 172.24395872280002 seconds
 Start rescaling
Rescaling took 399.27092857658863 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.07it/s, epoch=1/50, avg_epoch_loss=0.233] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.23it/s, epoch=1/50, avg_epoch_loss=0.208]100%|██████████| 1143/1143 [00:21<00:00, 54.29it/s, epoch=1/50, avg_epoch_loss=0.206]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.71it/s, epoch=2/50, avg_epoch_loss=0.181] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.26it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 54.21it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.14it/s, epoch=3/50, avg_epoch_loss=0.18] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.31it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.30it/s, epoch=3/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.68it/s, epoch=4/50, avg_epoch_loss=0.181] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.50it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.41it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.43it/s, epoch=5/50, avg_epoch_loss=0.181] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.05it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.13it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.73it/s, epoch=6/50, avg_epoch_loss=0.181] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.91it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.92it/s, epoch=6/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.94it/s, epoch=7/50, avg_epoch_loss=0.18] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.42it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.46it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.26it/s, epoch=8/50, avg_epoch_loss=0.18] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.63it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.55it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.30it/s, epoch=9/50, avg_epoch_loss=0.18] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.37it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.38it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.98it/s, epoch=10/50, avg_epoch_loss=0.179] 98%|█████████▊| 1122/1143 [00:20<00:00, 56.09it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.09it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.27it/s, epoch=11/50, avg_epoch_loss=0.181] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.21it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.21it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.46it/s, epoch=12/50, avg_epoch_loss=0.179] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.55it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.54it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.09it/s, epoch=13/50, avg_epoch_loss=0.179] 98%|█████████▊| 1122/1143 [00:20<00:00, 56.08it/s, epoch=13/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.08it/s, epoch=13/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.92it/s, epoch=14/50, avg_epoch_loss=0.179] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.24it/s, epoch=14/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.23it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.60it/s, epoch=15/50, avg_epoch_loss=0.179] 96%|█████████▌| 1093/1143 [00:20<00:00, 54.30it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.37it/s, epoch=15/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.21it/s, epoch=16/50, avg_epoch_loss=0.179] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.28it/s, epoch=16/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.29it/s, epoch=16/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.82it/s, epoch=17/50, avg_epoch_loss=0.179] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.23it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.18it/s, epoch=17/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.02it/s, epoch=18/50, avg_epoch_loss=0.178] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.86it/s, epoch=18/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.91it/s, epoch=18/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.15it/s, epoch=19/50, avg_epoch_loss=0.179] 98%|█████████▊| 1124/1143 [00:20<00:00, 55.90it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.95it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.09it/s, epoch=20/50, avg_epoch_loss=0.179] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.77it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.81it/s, epoch=20/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.90it/s, epoch=21/50, avg_epoch_loss=0.178] 98%|█████████▊| 1119/1143 [00:20<00:00, 55.34it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.39it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.48it/s, epoch=22/50, avg_epoch_loss=0.179] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.48it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.51it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.52it/s, epoch=23/50, avg_epoch_loss=0.177] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.45it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.48it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.73it/s, epoch=24/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.45it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.44it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.76it/s, epoch=25/50, avg_epoch_loss=0.178] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.87it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.85it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.39it/s, epoch=26/50, avg_epoch_loss=0.178] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.55it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.67it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.54it/s, epoch=27/50, avg_epoch_loss=0.178] 94%|█████████▍| 1075/1143 [00:20<00:01, 53.74it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.78it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.09it/s, epoch=28/50, avg_epoch_loss=0.179] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.88it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.86it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.02it/s, epoch=29/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.01it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.99it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.93it/s, epoch=30/50, avg_epoch_loss=0.178] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.76it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.80it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.93it/s, epoch=31/50, avg_epoch_loss=0.177] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.38it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.32it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.66it/s, epoch=32/50, avg_epoch_loss=0.178] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.64it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.67it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.97it/s, epoch=33/50, avg_epoch_loss=0.178] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.52it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.48it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.87it/s, epoch=34/50, avg_epoch_loss=0.178] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.70it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.70it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.15it/s, epoch=35/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.28it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.46it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.00it/s, epoch=36/50, avg_epoch_loss=0.177] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.96it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.93it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.55it/s, epoch=37/50, avg_epoch_loss=0.177] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.52it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.52it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.61it/s, epoch=38/50, avg_epoch_loss=0.178] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.61it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.65it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.22it/s, epoch=39/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.26it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.16it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.36it/s, epoch=40/50, avg_epoch_loss=0.177] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.72it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.84it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.30it/s, epoch=41/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.57it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.65it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.08it/s, epoch=42/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.70it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.78it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.01it/s, epoch=43/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.88it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.92it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.98it/s, epoch=44/50, avg_epoch_loss=0.177] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.78it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.82it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.66it/s, epoch=45/50, avg_epoch_loss=0.176] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.68it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.63it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.41it/s, epoch=46/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.24it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.25it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.60it/s, epoch=47/50, avg_epoch_loss=0.176] 98%|█████████▊| 1117/1143 [00:20<00:00, 55.82it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.77it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.38it/s, epoch=48/50, avg_epoch_loss=0.178] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.41it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.48it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.20it/s, epoch=49/50, avg_epoch_loss=0.176] 95%|█████████▍| 1084/1143 [00:20<00:01, 53.97it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.01it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.27it/s, epoch=50/50, avg_epoch_loss=0.177] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.71it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.69it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.65381211787462 seconds
Parameter factors with value 55 had evaluation 2.315852002599066
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 60, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1035.2792017515749 seconds
Creating forecasts took 174.43135178089142 seconds
 Start rescaling
Rescaling took 397.92439725622535 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.48it/s, epoch=1/50, avg_epoch_loss=0.249] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.41it/s, epoch=1/50, avg_epoch_loss=0.215]100%|██████████| 1143/1143 [00:20<00:00, 54.45it/s, epoch=1/50, avg_epoch_loss=0.214]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.07it/s, epoch=2/50, avg_epoch_loss=0.182] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.17it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 54.09it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.49it/s, epoch=3/50, avg_epoch_loss=0.18] 96%|█████████▌| 1095/1143 [00:20<00:00, 54.77it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.77it/s, epoch=3/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.02it/s, epoch=4/50, avg_epoch_loss=0.182] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.33it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.31it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.44it/s, epoch=5/50, avg_epoch_loss=0.181] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.58it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.59it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.88it/s, epoch=6/50, avg_epoch_loss=0.18] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.71it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.72it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.45it/s, epoch=7/50, avg_epoch_loss=0.181] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.53it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.54it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.15it/s, epoch=8/50, avg_epoch_loss=0.181] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.42it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.41it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.50it/s, epoch=9/50, avg_epoch_loss=0.181] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.41it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.39it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.82it/s, epoch=10/50, avg_epoch_loss=0.18] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.14it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.21it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.53it/s, epoch=11/50, avg_epoch_loss=0.18] 97%|█████████▋| 1112/1143 [00:20<00:00, 54.44it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.61it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.81it/s, epoch=12/50, avg_epoch_loss=0.178] 95%|█████████▍| 1081/1143 [00:20<00:01, 53.99it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.07it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.19it/s, epoch=13/50, avg_epoch_loss=0.179] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.12it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.04it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.83it/s, epoch=14/50, avg_epoch_loss=0.178] 93%|█████████▎| 1060/1143 [00:20<00:01, 52.98it/s, epoch=14/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.06it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.73it/s, epoch=15/50, avg_epoch_loss=0.178] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.48it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.52it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.39it/s, epoch=16/50, avg_epoch_loss=0.177] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.49it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.49it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.40it/s, epoch=17/50, avg_epoch_loss=0.178] 95%|█████████▍| 1081/1143 [00:20<00:01, 54.11it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.99it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.51it/s, epoch=18/50, avg_epoch_loss=0.178] 94%|█████████▍| 1077/1143 [00:20<00:01, 53.81it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.78it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.97it/s, epoch=19/50, avg_epoch_loss=0.179] 95%|█████████▍| 1082/1143 [00:20<00:01, 54.08it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.04it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.73it/s, epoch=20/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.49it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.53it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.24it/s, epoch=21/50, avg_epoch_loss=0.177] 95%|█████████▌| 1086/1143 [00:20<00:01, 54.17it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.26it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.70it/s, epoch=22/50, avg_epoch_loss=0.178] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.98it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.99it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.70it/s, epoch=23/50, avg_epoch_loss=0.177] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.39it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.42it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.56it/s, epoch=24/50, avg_epoch_loss=0.178] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.42it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.46it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.43it/s, epoch=25/50, avg_epoch_loss=0.177] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.48it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.46it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.43it/s, epoch=26/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.44it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.46it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.27it/s, epoch=27/50, avg_epoch_loss=0.177] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.86it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.89it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 516/1143 [00:10<00:12, 51.58it/s, epoch=28/50, avg_epoch_loss=0.177] 92%|█████████▏| 1052/1143 [00:20<00:01, 52.77it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.63it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.48it/s, epoch=29/50, avg_epoch_loss=0.178] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.32it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.23it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.65it/s, epoch=30/50, avg_epoch_loss=0.178] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.13it/s, epoch=30/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.17it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.73it/s, epoch=31/50, avg_epoch_loss=0.178] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.98it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.96it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.75it/s, epoch=32/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.42it/s, epoch=32/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.37it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.56it/s, epoch=33/50, avg_epoch_loss=0.178] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.50it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.64it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.02it/s, epoch=34/50, avg_epoch_loss=0.177] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.32it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.29it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.57it/s, epoch=35/50, avg_epoch_loss=0.178] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.65it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.59it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.06it/s, epoch=36/50, avg_epoch_loss=0.177] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.23it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.21it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.22it/s, epoch=37/50, avg_epoch_loss=0.178] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.32it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.33it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.76it/s, epoch=38/50, avg_epoch_loss=0.177] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.30it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.24it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.12it/s, epoch=39/50, avg_epoch_loss=0.178] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.45it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.37it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.77it/s, epoch=40/50, avg_epoch_loss=0.177] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.29it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.38it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.99it/s, epoch=41/50, avg_epoch_loss=0.177] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.27it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.38it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.27it/s, epoch=42/50, avg_epoch_loss=0.177] 95%|█████████▌| 1086/1143 [00:20<00:01, 54.20it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.16it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.59it/s, epoch=43/50, avg_epoch_loss=0.177] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.49it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.45it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.32it/s, epoch=44/50, avg_epoch_loss=0.178] 48%|████▊     | 554/1143 [00:20<00:10, 55.32it/s, epoch=44/50, avg_epoch_loss=0.177] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.22it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.22it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.23it/s, epoch=45/50, avg_epoch_loss=0.176] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.80it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.86it/s, epoch=45/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.77it/s, epoch=46/50, avg_epoch_loss=0.177] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.64it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.66it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.47it/s, epoch=47/50, avg_epoch_loss=0.176] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.95it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.86it/s, epoch=47/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.88it/s, epoch=48/50, avg_epoch_loss=0.177] 96%|█████████▋| 1101/1143 [00:20<00:00, 55.01it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.97it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.92it/s, epoch=49/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.59it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.66it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.31it/s, epoch=50/50, avg_epoch_loss=0.177] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.76it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.85it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 84.08142534457147 seconds
Parameter factors with value 60 had evaluation 2.346254424194877
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1044.6549385078251 seconds
Creating forecasts took 174.28002775087953 seconds
 Start rescaling
Rescaling took 397.79388093948364 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.94it/s, epoch=1/50, avg_epoch_loss=0.236] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.41it/s, epoch=1/50, avg_epoch_loss=0.209]100%|██████████| 1143/1143 [00:20<00:00, 55.35it/s, epoch=1/50, avg_epoch_loss=0.208]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.09it/s, epoch=2/50, avg_epoch_loss=0.18] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.30it/s, epoch=2/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.28it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.96it/s, epoch=3/50, avg_epoch_loss=0.18] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.71it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.78it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.19it/s, epoch=4/50, avg_epoch_loss=0.181] 98%|█████████▊| 1124/1143 [00:20<00:00, 56.10it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.12it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.24it/s, epoch=5/50, avg_epoch_loss=0.18] 99%|█████████▊| 1126/1143 [00:20<00:00, 55.50it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.56it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.91it/s, epoch=6/50, avg_epoch_loss=0.181] 98%|█████████▊| 1123/1143 [00:20<00:00, 56.10it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.06it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.85it/s, epoch=7/50, avg_epoch_loss=0.18] 97%|█████████▋| 1113/1143 [00:20<00:00, 55.74it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.65it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.97it/s, epoch=8/50, avg_epoch_loss=0.181] 98%|█████████▊| 1123/1143 [00:20<00:00, 56.16it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.15it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.44it/s, epoch=9/50, avg_epoch_loss=0.181] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.07it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.12it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.82it/s, epoch=10/50, avg_epoch_loss=0.18] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.81it/s, epoch=10/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.72it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.19it/s, epoch=11/50, avg_epoch_loss=0.18] 98%|█████████▊| 1124/1143 [00:20<00:00, 56.08it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.12it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.32it/s, epoch=12/50, avg_epoch_loss=0.179] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.44it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.44it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.25it/s, epoch=13/50, avg_epoch_loss=0.18] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.27it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.27it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.96it/s, epoch=14/50, avg_epoch_loss=0.178] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.96it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.95it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.20it/s, epoch=15/50, avg_epoch_loss=0.179] 98%|█████████▊| 1124/1143 [00:20<00:00, 55.76it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.79it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.77it/s, epoch=16/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.61it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.62it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.08it/s, epoch=17/50, avg_epoch_loss=0.179] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.73it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.75it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.54it/s, epoch=18/50, avg_epoch_loss=0.178] 96%|█████████▌| 1092/1143 [00:20<00:00, 53.78it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.76it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.89it/s, epoch=19/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.35it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.30it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.62it/s, epoch=20/50, avg_epoch_loss=0.178] 98%|█████████▊| 1117/1143 [00:20<00:00, 55.82it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.82it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.42it/s, epoch=21/50, avg_epoch_loss=0.177] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.72it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.72it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 566/1143 [00:10<00:10, 56.52it/s, epoch=22/50, avg_epoch_loss=0.178] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.42it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.42it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.44it/s, epoch=23/50, avg_epoch_loss=0.177] 99%|█████████▉| 1130/1143 [00:20<00:00, 54.74it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.00it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.95it/s, epoch=24/50, avg_epoch_loss=0.178] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.67it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.72it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.13it/s, epoch=25/50, avg_epoch_loss=0.177] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.54it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.54it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.03it/s, epoch=26/50, avg_epoch_loss=0.177] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.09it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.11it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.62it/s, epoch=27/50, avg_epoch_loss=0.178] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.89it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.84it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.91it/s, epoch=28/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.59it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.58it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.18it/s, epoch=29/50, avg_epoch_loss=0.177] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.40it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.38it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.81it/s, epoch=30/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.40it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.46it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.49it/s, epoch=31/50, avg_epoch_loss=0.178] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.94it/s, epoch=31/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.91it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.39it/s, epoch=32/50, avg_epoch_loss=0.177] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.26it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.26it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.64it/s, epoch=33/50, avg_epoch_loss=0.178] 96%|█████████▌| 1097/1143 [00:20<00:00, 54.82it/s, epoch=33/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.83it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.09it/s, epoch=34/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.82it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.76it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.64it/s, epoch=35/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 55.00it/s, epoch=35/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.95it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.55it/s, epoch=36/50, avg_epoch_loss=0.176] 98%|█████████▊| 1117/1143 [00:20<00:00, 55.82it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.81it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.38it/s, epoch=37/50, avg_epoch_loss=0.177] 99%|█████████▉| 1129/1143 [00:20<00:00, 56.39it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.40it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.57it/s, epoch=38/50, avg_epoch_loss=0.177] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.45it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.48it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.05it/s, epoch=39/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.67it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.77it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.10it/s, epoch=40/50, avg_epoch_loss=0.176] 93%|█████████▎| 1063/1143 [00:20<00:01, 53.13it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.18it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.16it/s, epoch=41/50, avg_epoch_loss=0.178] 94%|█████████▍| 1079/1143 [00:20<00:01, 54.04it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.00it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.54it/s, epoch=42/50, avg_epoch_loss=0.178] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.89it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.84it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.36it/s, epoch=43/50, avg_epoch_loss=0.177] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.20it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.20it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.28it/s, epoch=44/50, avg_epoch_loss=0.177] 49%|████▉     | 563/1143 [00:20<00:10, 56.28it/s, epoch=44/50, avg_epoch_loss=0.177] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.73it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.82it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.24it/s, epoch=45/50, avg_epoch_loss=0.176] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.07it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.11it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.73it/s, epoch=46/50, avg_epoch_loss=0.177] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.63it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.66it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.27it/s, epoch=47/50, avg_epoch_loss=0.176] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.73it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.70it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.43it/s, epoch=48/50, avg_epoch_loss=0.178] 99%|█████████▉| 1131/1143 [00:20<00:00, 56.49it/s, epoch=48/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.49it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.70it/s, epoch=49/50, avg_epoch_loss=0.177] 98%|█████████▊| 1119/1143 [00:20<00:00, 55.95it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.92it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.84it/s, epoch=50/50, avg_epoch_loss=0.177] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.72it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.75it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.45719739422202 seconds
Parameter factors with value 65 had evaluation 2.1381705561630633
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 70, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1030.6788904499263 seconds
Creating forecasts took 171.694113092497 seconds
 Start rescaling
Rescaling took 398.40568451583385 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 520/1143 [00:10<00:11, 51.93it/s, epoch=1/50, avg_epoch_loss=0.235] 92%|█████████▏| 1053/1143 [00:20<00:01, 52.72it/s, epoch=1/50, avg_epoch_loss=0.209]100%|██████████| 1143/1143 [00:21<00:00, 52.64it/s, epoch=1/50, avg_epoch_loss=0.207]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.02it/s, epoch=2/50, avg_epoch_loss=0.182] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.17it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 54.20it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 521/1143 [00:10<00:11, 52.07it/s, epoch=3/50, avg_epoch_loss=0.18] 91%|█████████▏| 1045/1143 [00:20<00:01, 52.22it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 51.99it/s, epoch=3/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.72it/s, epoch=4/50, avg_epoch_loss=0.181] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.28it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 54.23it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.17it/s, epoch=5/50, avg_epoch_loss=0.18] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.53it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.53it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.69it/s, epoch=6/50, avg_epoch_loss=0.181] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.46it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.47it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.93it/s, epoch=7/50, avg_epoch_loss=0.179] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.05it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.01it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.83it/s, epoch=8/50, avg_epoch_loss=0.18] 95%|█████████▌| 1086/1143 [00:20<00:01, 54.29it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.24it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.11it/s, epoch=9/50, avg_epoch_loss=0.179] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.12it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.14it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.22it/s, epoch=10/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.88it/s, epoch=10/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.96it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.51it/s, epoch=11/50, avg_epoch_loss=0.179] 97%|█████████▋| 1112/1143 [00:20<00:00, 54.95it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.98it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.67it/s, epoch=12/50, avg_epoch_loss=0.179] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.59it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.65it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.43it/s, epoch=13/50, avg_epoch_loss=0.179] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.46it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.45it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.47it/s, epoch=14/50, avg_epoch_loss=0.178] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.45it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.51it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.74it/s, epoch=15/50, avg_epoch_loss=0.179] 96%|█████████▌| 1097/1143 [00:20<00:00, 54.83it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.79it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.74it/s, epoch=16/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.73it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.78it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.96it/s, epoch=17/50, avg_epoch_loss=0.179] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.60it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.65it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.70it/s, epoch=18/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.21it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.10it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.13it/s, epoch=19/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.58it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.67it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.21it/s, epoch=20/50, avg_epoch_loss=0.178] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.28it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.27it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.22it/s, epoch=21/50, avg_epoch_loss=0.177] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.00it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.04it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.11it/s, epoch=22/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.97it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.91it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.18it/s, epoch=23/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.79it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.78it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 527/1143 [00:10<00:11, 52.67it/s, epoch=24/50, avg_epoch_loss=0.178] 92%|█████████▏| 1054/1143 [00:20<00:01, 52.54it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.49it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.71it/s, epoch=25/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.30it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.37it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.71it/s, epoch=26/50, avg_epoch_loss=0.178] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.83it/s, epoch=26/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.82it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.23it/s, epoch=27/50, avg_epoch_loss=0.177] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.71it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.67it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.10it/s, epoch=28/50, avg_epoch_loss=0.178] 95%|█████████▍| 1084/1143 [00:20<00:01, 53.99it/s, epoch=28/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.09it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.47it/s, epoch=29/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.16it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.20it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.86it/s, epoch=30/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.11it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.06it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.52it/s, epoch=31/50, avg_epoch_loss=0.178] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.57it/s, epoch=31/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.57it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.19it/s, epoch=32/50, avg_epoch_loss=0.178] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.23it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.22it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.84it/s, epoch=33/50, avg_epoch_loss=0.177] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.50it/s, epoch=33/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.53it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.27it/s, epoch=34/50, avg_epoch_loss=0.176] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.25it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.26it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.87it/s, epoch=35/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.11it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.09it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.88it/s, epoch=36/50, avg_epoch_loss=0.177] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.38it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.38it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.20it/s, epoch=37/50, avg_epoch_loss=0.178] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.29it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.29it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.09it/s, epoch=38/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.80it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.84it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.27it/s, epoch=39/50, avg_epoch_loss=0.177] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.65it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.69it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.37it/s, epoch=40/50, avg_epoch_loss=0.177] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.49it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.45it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.79it/s, epoch=41/50, avg_epoch_loss=0.177] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.66it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.71it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.28it/s, epoch=42/50, avg_epoch_loss=0.177] 95%|█████████▌| 1086/1143 [00:20<00:01, 53.97it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.99it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.27it/s, epoch=43/50, avg_epoch_loss=0.177] 95%|█████████▌| 1087/1143 [00:20<00:01, 54.31it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.35it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.07it/s, epoch=44/50, avg_epoch_loss=0.178] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.15it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.10it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.68it/s, epoch=45/50, avg_epoch_loss=0.176] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.89it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.85it/s, epoch=45/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.05it/s, epoch=46/50, avg_epoch_loss=0.177] 95%|█████████▍| 1082/1143 [00:20<00:01, 53.23it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.18it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 527/1143 [00:10<00:11, 52.64it/s, epoch=47/50, avg_epoch_loss=0.176] 92%|█████████▏| 1056/1143 [00:20<00:01, 52.79it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.77it/s, epoch=47/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.26it/s, epoch=48/50, avg_epoch_loss=0.178] 95%|█████████▌| 1086/1143 [00:20<00:01, 54.14it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.21it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.05it/s, epoch=49/50, avg_epoch_loss=0.176] 95%|█████████▍| 1082/1143 [00:20<00:01, 54.05it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.14it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.43it/s, epoch=50/50, avg_epoch_loss=0.177] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.89it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.78it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 85.19402551464736 seconds
Parameter factors with value 70 had evaluation 2.317182843962488
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 75, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1050.0060040690005 seconds
Creating forecasts took 172.36173410899937 seconds
 Start rescaling
Rescaling took 398.0033237878233 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.37it/s, epoch=1/50, avg_epoch_loss=0.225] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.55it/s, epoch=1/50, avg_epoch_loss=0.203]100%|██████████| 1143/1143 [00:20<00:00, 55.48it/s, epoch=1/50, avg_epoch_loss=0.202]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.45it/s, epoch=2/50, avg_epoch_loss=0.181] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.51it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.46it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.27it/s, epoch=3/50, avg_epoch_loss=0.181] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.76it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.69it/s, epoch=3/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.62it/s, epoch=4/50, avg_epoch_loss=0.181] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.15it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.13it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.26it/s, epoch=5/50, avg_epoch_loss=0.18] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.25it/s, epoch=5/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 56.24it/s, epoch=5/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.35it/s, epoch=6/50, avg_epoch_loss=0.181] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.20it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.22it/s, epoch=6/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.77it/s, epoch=7/50, avg_epoch_loss=0.181] 98%|█████████▊| 1116/1143 [00:20<00:00, 54.96it/s, epoch=7/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.06it/s, epoch=7/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.90it/s, epoch=8/50, avg_epoch_loss=0.181] 96%|█████████▌| 1093/1143 [00:20<00:00, 54.90it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.63it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.98it/s, epoch=9/50, avg_epoch_loss=0.181] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.59it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.51it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.23it/s, epoch=10/50, avg_epoch_loss=0.179] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.22it/s, epoch=10/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.19it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.21it/s, epoch=11/50, avg_epoch_loss=0.181] 99%|█████████▊| 1126/1143 [00:20<00:00, 55.57it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.65it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.58it/s, epoch=12/50, avg_epoch_loss=0.179] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.69it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.70it/s, epoch=12/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.46it/s, epoch=13/50, avg_epoch_loss=0.18] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.23it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.32it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.05it/s, epoch=14/50, avg_epoch_loss=0.178] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.31it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.44it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.80it/s, epoch=15/50, avg_epoch_loss=0.179] 95%|█████████▌| 1089/1143 [00:20<00:00, 54.56it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.40it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.30it/s, epoch=16/50, avg_epoch_loss=0.178] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.20it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.23it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.04it/s, epoch=17/50, avg_epoch_loss=0.179] 98%|█████████▊| 1121/1143 [00:20<00:00, 56.18it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.05it/s, epoch=17/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 570/1143 [00:10<00:10, 56.93it/s, epoch=18/50, avg_epoch_loss=0.178]100%|█████████▉| 1141/1143 [00:20<00:00, 57.01it/s, epoch=18/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.99it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.24it/s, epoch=19/50, avg_epoch_loss=0.179] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.39it/s, epoch=19/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.35it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.39it/s, epoch=20/50, avg_epoch_loss=0.179] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.70it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.83it/s, epoch=20/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.78it/s, epoch=21/50, avg_epoch_loss=0.177] 97%|█████████▋| 1113/1143 [00:20<00:00, 55.76it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.65it/s, epoch=21/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 570/1143 [00:10<00:10, 56.94it/s, epoch=22/50, avg_epoch_loss=0.179]100%|█████████▉| 1140/1143 [00:20<00:00, 55.19it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.45it/s, epoch=22/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.67it/s, epoch=23/50, avg_epoch_loss=0.177] 96%|█████████▌| 1097/1143 [00:20<00:00, 54.85it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.85it/s, epoch=23/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.42it/s, epoch=24/50, avg_epoch_loss=0.179] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.47it/s, epoch=24/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.49it/s, epoch=24/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.07it/s, epoch=25/50, avg_epoch_loss=0.178] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.33it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.28it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.22it/s, epoch=26/50, avg_epoch_loss=0.178] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.55it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.45it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.13it/s, epoch=27/50, avg_epoch_loss=0.177] 98%|█████████▊| 1124/1143 [00:20<00:00, 55.90it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.91it/s, epoch=27/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.24it/s, epoch=28/50, avg_epoch_loss=0.179] 98%|█████████▊| 1119/1143 [00:20<00:00, 55.99it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.90it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.06it/s, epoch=29/50, avg_epoch_loss=0.177] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.99it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.02it/s, epoch=29/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.10it/s, epoch=30/50, avg_epoch_loss=0.179] 95%|█████████▍| 1084/1143 [00:20<00:01, 53.45it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.67it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.52it/s, epoch=31/50, avg_epoch_loss=0.179] 97%|█████████▋| 1112/1143 [00:20<00:00, 54.98it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.03it/s, epoch=31/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.58it/s, epoch=32/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.81it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.84it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.34it/s, epoch=33/50, avg_epoch_loss=0.179] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.15it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.16it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.35it/s, epoch=34/50, avg_epoch_loss=0.177] 96%|█████████▌| 1097/1143 [00:20<00:00, 54.88it/s, epoch=34/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.84it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.62it/s, epoch=35/50, avg_epoch_loss=0.178] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.91it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.90it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.70it/s, epoch=36/50, avg_epoch_loss=0.178] 96%|█████████▌| 1100/1143 [00:20<00:00, 55.00it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.98it/s, epoch=36/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.69it/s, epoch=37/50, avg_epoch_loss=0.177] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.77it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.76it/s, epoch=37/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.54it/s, epoch=38/50, avg_epoch_loss=0.177] 98%|█████████▊| 1119/1143 [00:20<00:00, 55.94it/s, epoch=38/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.89it/s, epoch=38/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.91it/s, epoch=39/50, avg_epoch_loss=0.177] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.27it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.19it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.54it/s, epoch=40/50, avg_epoch_loss=0.178] 97%|█████████▋| 1113/1143 [00:20<00:00, 55.62it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.63it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.73it/s, epoch=41/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.71it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.71it/s, epoch=41/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.42it/s, epoch=42/50, avg_epoch_loss=0.178] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.18it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.22it/s, epoch=42/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.81it/s, epoch=43/50, avg_epoch_loss=0.177] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.95it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.89it/s, epoch=43/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.70it/s, epoch=44/50, avg_epoch_loss=0.178] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.29it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.36it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.11it/s, epoch=45/50, avg_epoch_loss=0.177] 98%|█████████▊| 1124/1143 [00:20<00:00, 55.58it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.67it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.87it/s, epoch=46/50, avg_epoch_loss=0.177] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.14it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.13it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.75it/s, epoch=47/50, avg_epoch_loss=0.177] 98%|█████████▊| 1116/1143 [00:20<00:00, 54.98it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.06it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.78it/s, epoch=48/50, avg_epoch_loss=0.177] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.36it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.43it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.62it/s, epoch=49/50, avg_epoch_loss=0.178] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.19it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.17it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.47it/s, epoch=50/50, avg_epoch_loss=0.177] 96%|█████████▌| 1093/1143 [00:20<00:00, 54.66it/s, epoch=50/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.63it/s, epoch=50/50, avg_epoch_loss=0.178]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 82.72551749274135 seconds
Parameter factors with value 75 had evaluation 2.353100049294247
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 80, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1033.437008984387 seconds
Creating forecasts took 171.2821844033897 seconds
 Start rescaling
Rescaling took 398.7355516497046 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.02it/s, epoch=1/50, avg_epoch_loss=0.244] 95%|█████████▍| 1082/1143 [00:20<00:01, 53.30it/s, epoch=1/50, avg_epoch_loss=0.213]100%|██████████| 1143/1143 [00:21<00:00, 53.42it/s, epoch=1/50, avg_epoch_loss=0.211]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.58it/s, epoch=2/50, avg_epoch_loss=0.18] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.26it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.28it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.74it/s, epoch=3/50, avg_epoch_loss=0.18] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.48it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.54it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.47it/s, epoch=4/50, avg_epoch_loss=0.18] 96%|█████████▌| 1100/1143 [00:20<00:00, 55.05it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.97it/s, epoch=4/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.93it/s, epoch=5/50, avg_epoch_loss=0.179] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.13it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.09it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.63it/s, epoch=6/50, avg_epoch_loss=0.18] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.48it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.46it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.52it/s, epoch=7/50, avg_epoch_loss=0.18] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.07it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.13it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.50it/s, epoch=8/50, avg_epoch_loss=0.18] 95%|█████████▍| 1082/1143 [00:20<00:01, 54.14it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.91it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.93it/s, epoch=9/50, avg_epoch_loss=0.18] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.77it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.76it/s, epoch=9/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.25it/s, epoch=10/50, avg_epoch_loss=0.178] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.35it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.39it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.32it/s, epoch=11/50, avg_epoch_loss=0.18] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.10it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.09it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.96it/s, epoch=12/50, avg_epoch_loss=0.179] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.43it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.34it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.17it/s, epoch=13/50, avg_epoch_loss=0.179] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.89it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.00it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.03it/s, epoch=14/50, avg_epoch_loss=0.178] 95%|█████████▍| 1082/1143 [00:20<00:01, 53.54it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.66it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.93it/s, epoch=15/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.04it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.07it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.50it/s, epoch=16/50, avg_epoch_loss=0.177] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.51it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.53it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.63it/s, epoch=17/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.34it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.24it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.66it/s, epoch=18/50, avg_epoch_loss=0.178] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.36it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.38it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.18it/s, epoch=19/50, avg_epoch_loss=0.179] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.33it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.29it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.41it/s, epoch=20/50, avg_epoch_loss=0.179] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.40it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.43it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.72it/s, epoch=21/50, avg_epoch_loss=0.177] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.75it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.76it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.11it/s, epoch=22/50, avg_epoch_loss=0.178] 95%|█████████▌| 1089/1143 [00:20<00:00, 54.41it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.33it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.39it/s, epoch=23/50, avg_epoch_loss=0.177] 93%|█████████▎| 1068/1143 [00:20<00:01, 53.01it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.00it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.03it/s, epoch=24/50, avg_epoch_loss=0.178] 93%|█████████▎| 1067/1143 [00:20<00:01, 53.36it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.16it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.79it/s, epoch=25/50, avg_epoch_loss=0.178] 93%|█████████▎| 1062/1143 [00:20<00:01, 53.07it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.01it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.99it/s, epoch=26/50, avg_epoch_loss=0.177] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.79it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.75it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.36it/s, epoch=27/50, avg_epoch_loss=0.177] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.57it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.59it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.46it/s, epoch=28/50, avg_epoch_loss=0.178] 94%|█████████▍| 1075/1143 [00:20<00:01, 53.77it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.69it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.28it/s, epoch=29/50, avg_epoch_loss=0.177] 93%|█████████▎| 1066/1143 [00:20<00:01, 53.28it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.25it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.35it/s, epoch=30/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.83it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.78it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.87it/s, epoch=31/50, avg_epoch_loss=0.177] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.70it/s, epoch=31/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.73it/s, epoch=31/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.93it/s, epoch=32/50, avg_epoch_loss=0.179] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.90it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.90it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.37it/s, epoch=33/50, avg_epoch_loss=0.179] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.82it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.69it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.09it/s, epoch=34/50, avg_epoch_loss=0.177] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.46it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.39it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.01it/s, epoch=35/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.06it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.90it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 523/1143 [00:10<00:11, 52.27it/s, epoch=36/50, avg_epoch_loss=0.176] 92%|█████████▏| 1046/1143 [00:20<00:01, 51.97it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.02it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.91it/s, epoch=37/50, avg_epoch_loss=0.177] 93%|█████████▎| 1060/1143 [00:20<00:01, 52.20it/s, epoch=37/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.15it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 511/1143 [00:10<00:12, 51.08it/s, epoch=38/50, avg_epoch_loss=0.177] 92%|█████████▏| 1054/1143 [00:20<00:01, 52.92it/s, epoch=38/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.83it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.09it/s, epoch=39/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.18it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.19it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.11it/s, epoch=40/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.01it/s, epoch=40/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.03it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.48it/s, epoch=41/50, avg_epoch_loss=0.177] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.43it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.44it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.96it/s, epoch=42/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.90it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.86it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.32it/s, epoch=43/50, avg_epoch_loss=0.177] 96%|█████████▌| 1093/1143 [00:20<00:00, 54.66it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.56it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.21it/s, epoch=44/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.94it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.96it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.88it/s, epoch=45/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.96it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.93it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.36it/s, epoch=46/50, avg_epoch_loss=0.178] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.12it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.18it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.95it/s, epoch=47/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.96it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.97it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.22it/s, epoch=48/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.91it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.97it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.55it/s, epoch=49/50, avg_epoch_loss=0.177] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.45it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.44it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.48it/s, epoch=50/50, avg_epoch_loss=0.177] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.79it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.77it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.66310580447316 seconds
Parameter factors with value 80 had evaluation 2.1709928008545245
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 85, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1049.2796046584845 seconds
Creating forecasts took 172.7424698844552 seconds
 Start rescaling
Rescaling took 397.97240738384426 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.26it/s, epoch=1/50, avg_epoch_loss=0.236] 94%|█████████▍| 1079/1143 [00:20<00:01, 53.99it/s, epoch=1/50, avg_epoch_loss=0.208]100%|██████████| 1143/1143 [00:21<00:00, 53.85it/s, epoch=1/50, avg_epoch_loss=0.207]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.49it/s, epoch=2/50, avg_epoch_loss=0.181] 94%|█████████▍| 1077/1143 [00:20<00:01, 53.88it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 53.93it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.75it/s, epoch=3/50, avg_epoch_loss=0.18] 96%|█████████▌| 1096/1143 [00:20<00:00, 53.65it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 53.80it/s, epoch=3/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.66it/s, epoch=4/50, avg_epoch_loss=0.181] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.43it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.44it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.50it/s, epoch=5/50, avg_epoch_loss=0.181] 94%|█████████▎| 1071/1143 [00:20<00:01, 53.53it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.51it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.22it/s, epoch=6/50, avg_epoch_loss=0.181] 95%|█████████▌| 1087/1143 [00:20<00:01, 54.28it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.30it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.66it/s, epoch=7/50, avg_epoch_loss=0.181] 96%|█████████▌| 1097/1143 [00:20<00:00, 54.85it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.86it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.02it/s, epoch=8/50, avg_epoch_loss=0.181] 98%|█████████▊| 1123/1143 [00:20<00:00, 56.07it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.06it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 568/1143 [00:10<00:10, 56.74it/s, epoch=9/50, avg_epoch_loss=0.18] 99%|█████████▉| 1136/1143 [00:20<00:00, 56.40it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.46it/s, epoch=9/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.10it/s, epoch=10/50, avg_epoch_loss=0.18] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.28it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.27it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.04it/s, epoch=11/50, avg_epoch_loss=0.18] 98%|█████████▊| 1125/1143 [00:20<00:00, 56.25it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.22it/s, epoch=11/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.64it/s, epoch=12/50, avg_epoch_loss=0.179] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.89it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.87it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 566/1143 [00:10<00:10, 56.52it/s, epoch=13/50, avg_epoch_loss=0.179] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.49it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.47it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.12it/s, epoch=14/50, avg_epoch_loss=0.178] 98%|█████████▊| 1124/1143 [00:20<00:00, 56.16it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.17it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.59it/s, epoch=15/50, avg_epoch_loss=0.178] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.70it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.69it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.98it/s, epoch=16/50, avg_epoch_loss=0.178] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.32it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.25it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.04it/s, epoch=17/50, avg_epoch_loss=0.179] 98%|█████████▊| 1124/1143 [00:20<00:00, 56.19it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.18it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.65it/s, epoch=18/50, avg_epoch_loss=0.178] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.46it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.50it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.19it/s, epoch=19/50, avg_epoch_loss=0.179] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.29it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.28it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.62it/s, epoch=20/50, avg_epoch_loss=0.179] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.51it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.42it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.80it/s, epoch=21/50, avg_epoch_loss=0.178] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.58it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.65it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.84it/s, epoch=22/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 55.04it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.91it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.87it/s, epoch=23/50, avg_epoch_loss=0.178] 98%|█████████▊| 1124/1143 [00:20<00:00, 56.19it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.16it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.38it/s, epoch=24/50, avg_epoch_loss=0.179] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.77it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.73it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.36it/s, epoch=25/50, avg_epoch_loss=0.177] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.75it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.66it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.86it/s, epoch=26/50, avg_epoch_loss=0.178] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.83it/s, epoch=26/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.82it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.23it/s, epoch=27/50, avg_epoch_loss=0.177] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.33it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.28it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.94it/s, epoch=28/50, avg_epoch_loss=0.178] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.77it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.83it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.28it/s, epoch=29/50, avg_epoch_loss=0.177] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.04it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.96it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.45it/s, epoch=30/50, avg_epoch_loss=0.177] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.57it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.57it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.73it/s, epoch=31/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.69it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.71it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.81it/s, epoch=32/50, avg_epoch_loss=0.179] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.82it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.76it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.91it/s, epoch=33/50, avg_epoch_loss=0.178] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.47it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.64it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.49it/s, epoch=34/50, avg_epoch_loss=0.177] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.71it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.70it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.52it/s, epoch=35/50, avg_epoch_loss=0.178] 49%|████▊     | 556/1143 [00:20<00:10, 55.52it/s, epoch=35/50, avg_epoch_loss=0.177] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.84it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.90it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.48it/s, epoch=36/50, avg_epoch_loss=0.177] 98%|█████████▊| 1119/1143 [00:20<00:00, 55.93it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.83it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.17it/s, epoch=37/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.95it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.00it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.91it/s, epoch=38/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.84it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.89it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.25it/s, epoch=39/50, avg_epoch_loss=0.178] 97%|█████████▋| 1113/1143 [00:20<00:00, 55.64it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.55it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.75it/s, epoch=40/50, avg_epoch_loss=0.177] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.61it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.65it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.56it/s, epoch=41/50, avg_epoch_loss=0.177] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.51it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.53it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.37it/s, epoch=42/50, avg_epoch_loss=0.177] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.75it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.76it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.70it/s, epoch=43/50, avg_epoch_loss=0.177] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.36it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.36it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.04it/s, epoch=44/50, avg_epoch_loss=0.178] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.43it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.39it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.10it/s, epoch=45/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.00it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.97it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.26it/s, epoch=46/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.22it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.23it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.42it/s, epoch=47/50, avg_epoch_loss=0.176] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.43it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.45it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.42it/s, epoch=48/50, avg_epoch_loss=0.178] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.21it/s, epoch=48/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.19it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.40it/s, epoch=49/50, avg_epoch_loss=0.177] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.60it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.64it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.45it/s, epoch=50/50, avg_epoch_loss=0.177] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.32it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.35it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 85.66029877960682 seconds
Parameter factors with value 85 had evaluation 2.2281461089961887
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 90, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1035.448052695021 seconds
Creating forecasts took 172.74149199575186 seconds
 Start rescaling
Rescaling took 398.154422134161 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.58it/s, epoch=1/50, avg_epoch_loss=0.229] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.50it/s, epoch=1/50, avg_epoch_loss=0.205]100%|██████████| 1143/1143 [00:21<00:00, 54.37it/s, epoch=1/50, avg_epoch_loss=0.204]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.32it/s, epoch=2/50, avg_epoch_loss=0.181] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.53it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.46it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.99it/s, epoch=3/50, avg_epoch_loss=0.18] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.25it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 54.13it/s, epoch=3/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.23it/s, epoch=4/50, avg_epoch_loss=0.181] 95%|█████████▌| 1086/1143 [00:20<00:01, 53.95it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.06it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.73it/s, epoch=5/50, avg_epoch_loss=0.18] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.74it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.76it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.69it/s, epoch=6/50, avg_epoch_loss=0.18] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.60it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.69it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.89it/s, epoch=7/50, avg_epoch_loss=0.18] 93%|█████████▎| 1058/1143 [00:20<00:01, 52.65it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.71it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 519/1143 [00:10<00:12, 51.88it/s, epoch=8/50, avg_epoch_loss=0.181] 92%|█████████▏| 1057/1143 [00:20<00:01, 52.97it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.93it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.27it/s, epoch=9/50, avg_epoch_loss=0.179] 95%|█████████▌| 1086/1143 [00:20<00:01, 53.69it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.75it/s, epoch=9/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.14it/s, epoch=10/50, avg_epoch_loss=0.178] 47%|████▋     | 542/1143 [00:20<00:11, 54.14it/s, epoch=10/50, avg_epoch_loss=0.179] 95%|█████████▍| 1082/1143 [00:20<00:01, 53.14it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.34it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.37it/s, epoch=11/50, avg_epoch_loss=0.18] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.95it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.96it/s, epoch=11/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.28it/s, epoch=12/50, avg_epoch_loss=0.178] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.60it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.50it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.77it/s, epoch=13/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.66it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.66it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.16it/s, epoch=14/50, avg_epoch_loss=0.178] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.24it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.26it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.79it/s, epoch=15/50, avg_epoch_loss=0.179] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.21it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.19it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.92it/s, epoch=16/50, avg_epoch_loss=0.177] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.18it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.11it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.34it/s, epoch=17/50, avg_epoch_loss=0.178] 95%|█████████▌| 1088/1143 [00:20<00:01, 53.15it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.21it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.46it/s, epoch=18/50, avg_epoch_loss=0.179] 95%|█████████▌| 1090/1143 [00:20<00:00, 53.95it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.95it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.09it/s, epoch=19/50, avg_epoch_loss=0.178] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.52it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.40it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.29it/s, epoch=20/50, avg_epoch_loss=0.178] 93%|█████████▎| 1066/1143 [00:20<00:01, 52.95it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.89it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 525/1143 [00:10<00:11, 52.44it/s, epoch=21/50, avg_epoch_loss=0.177] 92%|█████████▏| 1050/1143 [00:20<00:01, 51.92it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.05it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 527/1143 [00:10<00:11, 52.61it/s, epoch=22/50, avg_epoch_loss=0.178] 92%|█████████▏| 1054/1143 [00:20<00:01, 52.26it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.27it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 514/1143 [00:10<00:12, 51.31it/s, epoch=23/50, avg_epoch_loss=0.177] 90%|█████████ | 1032/1143 [00:20<00:02, 51.55it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 51.57it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.11it/s, epoch=24/50, avg_epoch_loss=0.179] 93%|█████████▎| 1064/1143 [00:20<00:01, 53.09it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.04it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.45it/s, epoch=25/50, avg_epoch_loss=0.177] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.54it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.50it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.35it/s, epoch=26/50, avg_epoch_loss=0.178] 95%|█████████▌| 1088/1143 [00:20<00:01, 53.77it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.71it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.74it/s, epoch=27/50, avg_epoch_loss=0.178] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.99it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.04it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.50it/s, epoch=28/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.84it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.80it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.16it/s, epoch=29/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.77it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.80it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.13it/s, epoch=30/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.16it/s, epoch=30/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.19it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.89it/s, epoch=31/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.81it/s, epoch=31/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.84it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.29it/s, epoch=32/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.01it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.07it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.39it/s, epoch=33/50, avg_epoch_loss=0.179] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.02it/s, epoch=33/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.07it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.05it/s, epoch=34/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.09it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.26it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.72it/s, epoch=35/50, avg_epoch_loss=0.177] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.21it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.05it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.87it/s, epoch=36/50, avg_epoch_loss=0.177] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.12it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.01it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.54it/s, epoch=37/50, avg_epoch_loss=0.177] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.67it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.68it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.60it/s, epoch=38/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.72it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.73it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.05it/s, epoch=39/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.18it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.19it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.78it/s, epoch=40/50, avg_epoch_loss=0.177] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.79it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.83it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.64it/s, epoch=41/50, avg_epoch_loss=0.177] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.60it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.66it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.35it/s, epoch=42/50, avg_epoch_loss=0.177] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.95it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.03it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.64it/s, epoch=43/50, avg_epoch_loss=0.177] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.63it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.60it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.46it/s, epoch=44/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 54.78it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.82it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.12it/s, epoch=45/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.86it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.93it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.04it/s, epoch=46/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.90it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.95it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.91it/s, epoch=47/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 53.42it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.62it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.65it/s, epoch=48/50, avg_epoch_loss=0.177] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.18it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.30it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.49it/s, epoch=49/50, avg_epoch_loss=0.176] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.23it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.27it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.43it/s, epoch=50/50, avg_epoch_loss=0.177] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.52it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.53it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.25718040391803 seconds
Parameter factors with value 90 had evaluation 2.4076262482918147
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 95, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1057.1450663451105 seconds
Creating forecasts took 170.86037853732705 seconds
 Start rescaling
Rescaling took 398.3773733526468 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.74it/s, epoch=1/50, avg_epoch_loss=0.227] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.14it/s, epoch=1/50, avg_epoch_loss=0.204]100%|██████████| 1143/1143 [00:20<00:00, 55.05it/s, epoch=1/50, avg_epoch_loss=0.203]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.48it/s, epoch=2/50, avg_epoch_loss=0.181] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.32it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 56.32it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.34it/s, epoch=3/50, avg_epoch_loss=0.18] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.75it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.64it/s, epoch=3/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.14it/s, epoch=4/50, avg_epoch_loss=0.181] 98%|█████████▊| 1124/1143 [00:20<00:00, 55.97it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 56.00it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.93it/s, epoch=5/50, avg_epoch_loss=0.18] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.78it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.84it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.34it/s, epoch=6/50, avg_epoch_loss=0.181] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.06it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.06it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 56.00it/s, epoch=7/50, avg_epoch_loss=0.18] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.84it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.88it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.91it/s, epoch=8/50, avg_epoch_loss=0.181] 98%|█████████▊| 1122/1143 [00:20<00:00, 56.06it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.06it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.73it/s, epoch=9/50, avg_epoch_loss=0.18] 98%|█████████▊| 1116/1143 [00:20<00:00, 54.90it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.06it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.98it/s, epoch=10/50, avg_epoch_loss=0.179] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.77it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.81it/s, epoch=10/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.54it/s, epoch=11/50, avg_epoch_loss=0.18] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.65it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.63it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.47it/s, epoch=12/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.36it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.32it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.60it/s, epoch=13/50, avg_epoch_loss=0.178] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.72it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.71it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.25it/s, epoch=14/50, avg_epoch_loss=0.178] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.45it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.44it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.89it/s, epoch=15/50, avg_epoch_loss=0.178] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.87it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.87it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.98it/s, epoch=16/50, avg_epoch_loss=0.178] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.80it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.78it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.38it/s, epoch=17/50, avg_epoch_loss=0.178] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.53it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.51it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.61it/s, epoch=18/50, avg_epoch_loss=0.179] 98%|█████████▊| 1117/1143 [00:20<00:00, 55.79it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.75it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.11it/s, epoch=19/50, avg_epoch_loss=0.179] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.79it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.68it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.20it/s, epoch=20/50, avg_epoch_loss=0.178] 95%|█████████▍| 1085/1143 [00:20<00:01, 53.41it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.64it/s, epoch=20/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.75it/s, epoch=21/50, avg_epoch_loss=0.177] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.56it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.53it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.73it/s, epoch=22/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.09it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.02it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.39it/s, epoch=23/50, avg_epoch_loss=0.177] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.16it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.03it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.06it/s, epoch=24/50, avg_epoch_loss=0.178] 95%|█████████▍| 1082/1143 [00:20<00:01, 54.02it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.12it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.30it/s, epoch=25/50, avg_epoch_loss=0.177] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.60it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.55it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.13it/s, epoch=26/50, avg_epoch_loss=0.178] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.43it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.41it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.06it/s, epoch=27/50, avg_epoch_loss=0.177] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.36it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.32it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.04it/s, epoch=28/50, avg_epoch_loss=0.179] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.52it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.57it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.66it/s, epoch=29/50, avg_epoch_loss=0.178] 96%|█████████▋| 1101/1143 [00:20<00:00, 55.08it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.97it/s, epoch=29/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.20it/s, epoch=30/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.84it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.81it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.78it/s, epoch=31/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.60it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.57it/s, epoch=31/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.78it/s, epoch=32/50, avg_epoch_loss=0.178] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.21it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.15it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.95it/s, epoch=33/50, avg_epoch_loss=0.178] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.61it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.57it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.75it/s, epoch=34/50, avg_epoch_loss=0.178] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.51it/s, epoch=34/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.50it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.06it/s, epoch=35/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.92it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.93it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.51it/s, epoch=36/50, avg_epoch_loss=0.177] 96%|█████████▌| 1097/1143 [00:20<00:00, 54.81it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.81it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.17it/s, epoch=37/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.25it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.26it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.95it/s, epoch=38/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.94it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.93it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.55it/s, epoch=39/50, avg_epoch_loss=0.177] 97%|█████████▋| 1113/1143 [00:20<00:00, 55.60it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.59it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.66it/s, epoch=40/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.75it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.69it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.66it/s, epoch=41/50, avg_epoch_loss=0.178] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.25it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.24it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.11it/s, epoch=42/50, avg_epoch_loss=0.177] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.19it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.27it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.66it/s, epoch=43/50, avg_epoch_loss=0.177] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.80it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.82it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.38it/s, epoch=44/50, avg_epoch_loss=0.178] 96%|█████████▌| 1097/1143 [00:20<00:00, 54.87it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.83it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.80it/s, epoch=45/50, avg_epoch_loss=0.176] 96%|█████████▌| 1096/1143 [00:20<00:00, 53.98it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.03it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.46it/s, epoch=46/50, avg_epoch_loss=0.178] 94%|█████████▎| 1071/1143 [00:20<00:01, 53.52it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.51it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.62it/s, epoch=47/50, avg_epoch_loss=0.176] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.76it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.78it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.60it/s, epoch=48/50, avg_epoch_loss=0.178] 94%|█████████▍| 1080/1143 [00:20<00:01, 54.02it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.03it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.97it/s, epoch=49/50, avg_epoch_loss=0.177] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.78it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.63it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.53it/s, epoch=50/50, avg_epoch_loss=0.177] 96%|█████████▌| 1095/1143 [00:20<00:00, 54.70it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.66it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 84.08975632302463 seconds
Parameter factors with value 95 had evaluation 2.2588144610541963
The best value for factors is 65 with evaluation 2.1381705561630633
 md[factors] = 65
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 5, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1038.5328532271087 seconds
Creating forecasts took 171.36467131972313 seconds
 Start rescaling
Rescaling took 398.4676812775433 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.93it/s, epoch=1/50, avg_epoch_loss=0.229] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.44it/s, epoch=1/50, avg_epoch_loss=0.205]100%|██████████| 1143/1143 [00:20<00:00, 55.33it/s, epoch=1/50, avg_epoch_loss=0.204]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.86it/s, epoch=2/50, avg_epoch_loss=0.181] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.33it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.29it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.13it/s, epoch=3/50, avg_epoch_loss=0.18] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.58it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.53it/s, epoch=3/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.07it/s, epoch=4/50, avg_epoch_loss=0.181] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.94it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.97it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.14it/s, epoch=5/50, avg_epoch_loss=0.18] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.17it/s, epoch=5/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.03it/s, epoch=5/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.02it/s, epoch=6/50, avg_epoch_loss=0.181] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.21it/s, epoch=6/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 54.25it/s, epoch=6/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.72it/s, epoch=7/50, avg_epoch_loss=0.18] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.85it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.84it/s, epoch=7/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.72it/s, epoch=8/50, avg_epoch_loss=0.18] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.70it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.62it/s, epoch=8/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.52it/s, epoch=9/50, avg_epoch_loss=0.18] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.49it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.51it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.46it/s, epoch=10/50, avg_epoch_loss=0.179] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.71it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.69it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.85it/s, epoch=11/50, avg_epoch_loss=0.18] 96%|█████████▌| 1098/1143 [00:20<00:00, 53.95it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.11it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.94it/s, epoch=12/50, avg_epoch_loss=0.178] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.64it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.69it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.05it/s, epoch=13/50, avg_epoch_loss=0.178] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.81it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.86it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.79it/s, epoch=14/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.31it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.32it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.54it/s, epoch=15/50, avg_epoch_loss=0.178] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.64it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.59it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.15it/s, epoch=16/50, avg_epoch_loss=0.178] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.23it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.10it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.48it/s, epoch=17/50, avg_epoch_loss=0.178] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.83it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.80it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.62it/s, epoch=18/50, avg_epoch_loss=0.178] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.63it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.57it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.50it/s, epoch=19/50, avg_epoch_loss=0.178] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.27it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.17it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.59it/s, epoch=20/50, avg_epoch_loss=0.179] 92%|█████████▏| 1056/1143 [00:20<00:01, 52.83it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.73it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.39it/s, epoch=21/50, avg_epoch_loss=0.177] 94%|█████████▍| 1073/1143 [00:20<00:01, 53.64it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.69it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.45it/s, epoch=22/50, avg_epoch_loss=0.179] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.18it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.34it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.85it/s, epoch=23/50, avg_epoch_loss=0.178] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.14it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.24it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.89it/s, epoch=24/50, avg_epoch_loss=0.178] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.42it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.35it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.82it/s, epoch=25/50, avg_epoch_loss=0.178] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.95it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.00it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.77it/s, epoch=26/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.21it/s, epoch=26/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.27it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.64it/s, epoch=27/50, avg_epoch_loss=0.178] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.56it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.59it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.75it/s, epoch=28/50, avg_epoch_loss=0.178] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.43it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.29it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.17it/s, epoch=29/50, avg_epoch_loss=0.178] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.55it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.50it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.68it/s, epoch=30/50, avg_epoch_loss=0.178] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.62it/s, epoch=30/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.64it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.72it/s, epoch=31/50, avg_epoch_loss=0.178] 96%|█████████▌| 1097/1143 [00:20<00:00, 54.82it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.84it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.53it/s, epoch=32/50, avg_epoch_loss=0.178] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.67it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.70it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.17it/s, epoch=33/50, avg_epoch_loss=0.178] 95%|█████████▍| 1084/1143 [00:20<00:01, 53.65it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.65it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.17it/s, epoch=34/50, avg_epoch_loss=0.177] 93%|█████████▎| 1067/1143 [00:20<00:01, 53.35it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.40it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.89it/s, epoch=35/50, avg_epoch_loss=0.178] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.21it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.15it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.96it/s, epoch=36/50, avg_epoch_loss=0.177] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.49it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.57it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.14it/s, epoch=37/50, avg_epoch_loss=0.178] 95%|█████████▍| 1084/1143 [00:20<00:01, 53.72it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.82it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.74it/s, epoch=38/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.21it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.08it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.10it/s, epoch=39/50, avg_epoch_loss=0.178] 95%|█████████▍| 1082/1143 [00:20<00:01, 53.64it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.75it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.43it/s, epoch=40/50, avg_epoch_loss=0.176] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.58it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.58it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.43it/s, epoch=41/50, avg_epoch_loss=0.177] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.17it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.23it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.22it/s, epoch=42/50, avg_epoch_loss=0.177] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.33it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.31it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.50it/s, epoch=43/50, avg_epoch_loss=0.178] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.67it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.66it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.64it/s, epoch=44/50, avg_epoch_loss=0.178] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.34it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.39it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.87it/s, epoch=45/50, avg_epoch_loss=0.177] 96%|█████████▋| 1101/1143 [00:20<00:00, 55.01it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.00it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.62it/s, epoch=46/50, avg_epoch_loss=0.177] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.74it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.74it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.46it/s, epoch=47/50, avg_epoch_loss=0.176] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.12it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.16it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.10it/s, epoch=48/50, avg_epoch_loss=0.178] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.17it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.22it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.22it/s, epoch=49/50, avg_epoch_loss=0.176] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.69it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.62it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.93it/s, epoch=50/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.16it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.16it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 82.85650461167097 seconds
Parameter local_units with value 5 had evaluation 2.3776050443826913
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 10, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1046.6362486016005 seconds
Creating forecasts took 172.29348293878138 seconds
 Start rescaling
Rescaling took 398.06841659732163 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.84it/s, epoch=1/50, avg_epoch_loss=0.227] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.23it/s, epoch=1/50, avg_epoch_loss=0.204]100%|██████████| 1143/1143 [00:21<00:00, 54.18it/s, epoch=1/50, avg_epoch_loss=0.203]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.62it/s, epoch=2/50, avg_epoch_loss=0.181] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.72it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 55.67it/s, epoch=2/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.38it/s, epoch=3/50, avg_epoch_loss=0.18] 96%|█████████▌| 1097/1143 [00:20<00:00, 54.90it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.81it/s, epoch=3/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.91it/s, epoch=4/50, avg_epoch_loss=0.181] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.37it/s, epoch=4/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.44it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.75it/s, epoch=5/50, avg_epoch_loss=0.18] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.91it/s, epoch=5/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.93it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.39it/s, epoch=6/50, avg_epoch_loss=0.179] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.53it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.50it/s, epoch=6/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.34it/s, epoch=7/50, avg_epoch_loss=0.179] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.70it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.77it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.48it/s, epoch=8/50, avg_epoch_loss=0.179] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.13it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.21it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.62it/s, epoch=9/50, avg_epoch_loss=0.179] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.86it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.79it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.27it/s, epoch=10/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.08it/s, epoch=10/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.06it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.97it/s, epoch=11/50, avg_epoch_loss=0.179] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.11it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.12it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.85it/s, epoch=12/50, avg_epoch_loss=0.179] 94%|█████████▎| 1071/1143 [00:20<00:01, 53.63it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.64it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.22it/s, epoch=13/50, avg_epoch_loss=0.179] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.61it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.60it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.51it/s, epoch=14/50, avg_epoch_loss=0.178] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.53it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.49it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.27it/s, epoch=15/50, avg_epoch_loss=0.179] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.82it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.77it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.11it/s, epoch=16/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.23it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.21it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.69it/s, epoch=17/50, avg_epoch_loss=0.178] 96%|█████████▋| 1101/1143 [00:20<00:00, 55.06it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.00it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.90it/s, epoch=18/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.29it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.21it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.20it/s, epoch=19/50, avg_epoch_loss=0.178] 97%|█████████▋| 1105/1143 [00:20<00:00, 54.68it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.79it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.51it/s, epoch=20/50, avg_epoch_loss=0.179] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.34it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.27it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.60it/s, epoch=21/50, avg_epoch_loss=0.177] 48%|████▊     | 546/1143 [00:20<00:10, 54.60it/s, epoch=21/50, avg_epoch_loss=0.178] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.96it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.85it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.87it/s, epoch=22/50, avg_epoch_loss=0.178] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.52it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.60it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.46it/s, epoch=23/50, avg_epoch_loss=0.177] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.28it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.29it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.59it/s, epoch=24/50, avg_epoch_loss=0.178] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.91it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.87it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.89it/s, epoch=25/50, avg_epoch_loss=0.178] 96%|█████████▌| 1093/1143 [00:20<00:00, 54.73it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.70it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.04it/s, epoch=26/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.78it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.87it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.20it/s, epoch=27/50, avg_epoch_loss=0.177] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.30it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.31it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.36it/s, epoch=28/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.45it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.45it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.89it/s, epoch=29/50, avg_epoch_loss=0.177] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.83it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.68it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.25it/s, epoch=30/50, avg_epoch_loss=0.178] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.40it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.43it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.70it/s, epoch=31/50, avg_epoch_loss=0.178] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.26it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.17it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.12it/s, epoch=32/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.85it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.92it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.81it/s, epoch=33/50, avg_epoch_loss=0.177] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.46it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.34it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.46it/s, epoch=34/50, avg_epoch_loss=0.177] 98%|█████████▊| 1117/1143 [00:20<00:00, 55.85it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.81it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.60it/s, epoch=35/50, avg_epoch_loss=0.178] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.84it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.81it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.73it/s, epoch=36/50, avg_epoch_loss=0.177] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.95it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.94it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.86it/s, epoch=37/50, avg_epoch_loss=0.177] 98%|█████████▊| 1119/1143 [00:20<00:00, 55.92it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.92it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.66it/s, epoch=38/50, avg_epoch_loss=0.178] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.47it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.52it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.59it/s, epoch=39/50, avg_epoch_loss=0.177] 97%|█████████▋| 1113/1143 [00:20<00:00, 55.61it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.59it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.54it/s, epoch=40/50, avg_epoch_loss=0.177] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.54it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.52it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.02it/s, epoch=41/50, avg_epoch_loss=0.178] 98%|█████████▊| 1123/1143 [00:20<00:00, 56.08it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.09it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.01it/s, epoch=42/50, avg_epoch_loss=0.177] 98%|█████████▊| 1122/1143 [00:20<00:00, 55.66it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.68it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.12it/s, epoch=43/50, avg_epoch_loss=0.178] 98%|█████████▊| 1124/1143 [00:20<00:00, 55.75it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.80it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.51it/s, epoch=44/50, avg_epoch_loss=0.178] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.63it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.62it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.39it/s, epoch=45/50, avg_epoch_loss=0.176] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.48it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.37it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.09it/s, epoch=46/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.07it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.09it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.96it/s, epoch=47/50, avg_epoch_loss=0.177] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.76it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.81it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.46it/s, epoch=48/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.82it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.76it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.59it/s, epoch=49/50, avg_epoch_loss=0.176] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.47it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.49it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.96it/s, epoch=50/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.58it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.66it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.2991031780839 seconds
Parameter local_units with value 10 had evaluation 2.505220207587449
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 15, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1036.854223811999 seconds
Creating forecasts took 169.93300778605044 seconds
 Start rescaling
Rescaling took 396.74350639246404 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.15it/s, epoch=1/50, avg_epoch_loss=0.223] 95%|█████████▌| 1086/1143 [00:20<00:01, 54.23it/s, epoch=1/50, avg_epoch_loss=0.203]100%|██████████| 1143/1143 [00:21<00:00, 54.19it/s, epoch=1/50, avg_epoch_loss=0.202]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.97it/s, epoch=2/50, avg_epoch_loss=0.181] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.86it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:20<00:00, 54.91it/s, epoch=2/50, avg_epoch_loss=0.182]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.60it/s, epoch=3/50, avg_epoch_loss=0.181] 96%|█████████▌| 1092/1143 [00:20<00:00, 52.87it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.06it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.68it/s, epoch=4/50, avg_epoch_loss=0.18] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.37it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.46it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.24it/s, epoch=5/50, avg_epoch_loss=0.179] 95%|█████████▌| 1086/1143 [00:20<00:01, 54.26it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.29it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.97it/s, epoch=6/50, avg_epoch_loss=0.18] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.13it/s, epoch=6/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.13it/s, epoch=6/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.09it/s, epoch=7/50, avg_epoch_loss=0.179] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.22it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.19it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.01it/s, epoch=8/50, avg_epoch_loss=0.18] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.73it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.66it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.00it/s, epoch=9/50, avg_epoch_loss=0.179] 95%|█████████▌| 1087/1143 [00:20<00:01, 54.35it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.35it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.82it/s, epoch=10/50, avg_epoch_loss=0.179] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.45it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.54it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.08it/s, epoch=11/50, avg_epoch_loss=0.179] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.32it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.29it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.85it/s, epoch=12/50, avg_epoch_loss=0.178] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.79it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.79it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.79it/s, epoch=13/50, avg_epoch_loss=0.178] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.94it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.95it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.31it/s, epoch=14/50, avg_epoch_loss=0.178] 96%|█████████▌| 1095/1143 [00:20<00:00, 54.74it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.62it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.63it/s, epoch=15/50, avg_epoch_loss=0.177] 96%|█████████▌| 1097/1143 [00:20<00:00, 54.82it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.84it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.77it/s, epoch=16/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.38it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.42it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.71it/s, epoch=17/50, avg_epoch_loss=0.178] 98%|█████████▊| 1117/1143 [00:20<00:00, 55.80it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.78it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.04it/s, epoch=18/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.31it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.27it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.70it/s, epoch=19/50, avg_epoch_loss=0.178] 96%|█████████▌| 1095/1143 [00:20<00:00, 54.75it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.63it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.87it/s, epoch=20/50, avg_epoch_loss=0.178] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.99it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.05it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.24it/s, epoch=21/50, avg_epoch_loss=0.177] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.48it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.50it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.57it/s, epoch=22/50, avg_epoch_loss=0.179] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.00it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.10it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.23it/s, epoch=23/50, avg_epoch_loss=0.177] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.81it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.72it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.41it/s, epoch=24/50, avg_epoch_loss=0.179] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.77it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.75it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.70it/s, epoch=25/50, avg_epoch_loss=0.178] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.99it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.95it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.34it/s, epoch=26/50, avg_epoch_loss=0.178] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.88it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.95it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.94it/s, epoch=27/50, avg_epoch_loss=0.177] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.11it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.08it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.96it/s, epoch=28/50, avg_epoch_loss=0.178] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.14it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.14it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.27it/s, epoch=29/50, avg_epoch_loss=0.177] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.41it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.42it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.16it/s, epoch=30/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.27it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.21it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.09it/s, epoch=31/50, avg_epoch_loss=0.178] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.38it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.34it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.76it/s, epoch=32/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.14it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.19it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.41it/s, epoch=33/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.31it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.25it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.98it/s, epoch=34/50, avg_epoch_loss=0.177] 94%|█████████▎| 1069/1143 [00:20<00:01, 53.52it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.46it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.23it/s, epoch=35/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.97it/s, epoch=35/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.02it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.52it/s, epoch=36/50, avg_epoch_loss=0.176] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.46it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.52it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.73it/s, epoch=37/50, avg_epoch_loss=0.176] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.40it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.46it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.30it/s, epoch=38/50, avg_epoch_loss=0.177] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.48it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.47it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.66it/s, epoch=39/50, avg_epoch_loss=0.177] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.34it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.33it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.89it/s, epoch=40/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.60it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.67it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.22it/s, epoch=41/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.84it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.83it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.85it/s, epoch=42/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.64it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.68it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.56it/s, epoch=43/50, avg_epoch_loss=0.178] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.49it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.45it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.06it/s, epoch=44/50, avg_epoch_loss=0.178] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.58it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.46it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.39it/s, epoch=45/50, avg_epoch_loss=0.176] 97%|█████████▋| 1109/1143 [00:20<00:00, 55.40it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.39it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.67it/s, epoch=46/50, avg_epoch_loss=0.177] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.61it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.55it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.73it/s, epoch=47/50, avg_epoch_loss=0.177] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.61it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.58it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.24it/s, epoch=48/50, avg_epoch_loss=0.178] 93%|█████████▎| 1068/1143 [00:20<00:01, 53.39it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.40it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.80it/s, epoch=49/50, avg_epoch_loss=0.177] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.14it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.17it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.91it/s, epoch=50/50, avg_epoch_loss=0.177] 95%|█████████▍| 1081/1143 [00:20<00:01, 53.98it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.92it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 84.82639878988266 seconds
Parameter local_units with value 15 had evaluation 2.3048064749175285
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 20, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1045.6218272149563 seconds
Creating forecasts took 171.93568232655525 seconds
 Start rescaling
Rescaling took 398.0948225520551 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.89it/s, epoch=1/50, avg_epoch_loss=0.228] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.90it/s, epoch=1/50, avg_epoch_loss=0.205]100%|██████████| 1143/1143 [00:20<00:00, 54.92it/s, epoch=1/50, avg_epoch_loss=0.204]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.10it/s, epoch=2/50, avg_epoch_loss=0.182] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.12it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:20<00:00, 55.09it/s, epoch=2/50, avg_epoch_loss=0.182]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.23it/s, epoch=3/50, avg_epoch_loss=0.181] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.34it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.31it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.44it/s, epoch=4/50, avg_epoch_loss=0.18] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.91it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.80it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.04it/s, epoch=5/50, avg_epoch_loss=0.178] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.37it/s, epoch=5/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.28it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.35it/s, epoch=6/50, avg_epoch_loss=0.179] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.91it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.80it/s, epoch=6/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.70it/s, epoch=7/50, avg_epoch_loss=0.179] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.32it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.17it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.89it/s, epoch=8/50, avg_epoch_loss=0.18] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.25it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.13it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.10it/s, epoch=9/50, avg_epoch_loss=0.179] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.93it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.99it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.12it/s, epoch=10/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.04it/s, epoch=10/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.08it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.23it/s, epoch=11/50, avg_epoch_loss=0.179] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.11it/s, epoch=11/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.09it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.57it/s, epoch=12/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.15it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.05it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.38it/s, epoch=13/50, avg_epoch_loss=0.179] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.32it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.28it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.16it/s, epoch=14/50, avg_epoch_loss=0.177] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.22it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.22it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.04it/s, epoch=15/50, avg_epoch_loss=0.179] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.79it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.76it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.30it/s, epoch=16/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.87it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.89it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.79it/s, epoch=17/50, avg_epoch_loss=0.178] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.53it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.58it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.04it/s, epoch=18/50, avg_epoch_loss=0.178] 93%|█████████▎| 1064/1143 [00:20<00:01, 53.18it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.02it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.12it/s, epoch=19/50, avg_epoch_loss=0.179] 95%|█████████▍| 1084/1143 [00:20<00:01, 53.74it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.70it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.54it/s, epoch=20/50, avg_epoch_loss=0.179] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.52it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.61it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.04it/s, epoch=21/50, avg_epoch_loss=0.177] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.22it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.21it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.69it/s, epoch=22/50, avg_epoch_loss=0.178] 96%|█████████▌| 1100/1143 [00:20<00:00, 55.04it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.95it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.62it/s, epoch=23/50, avg_epoch_loss=0.177] 96%|█████████▌| 1095/1143 [00:20<00:00, 54.69it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.70it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.29it/s, epoch=24/50, avg_epoch_loss=0.179] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.54it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.52it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.68it/s, epoch=25/50, avg_epoch_loss=0.178] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.52it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.48it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.97it/s, epoch=26/50, avg_epoch_loss=0.178] 93%|█████████▎| 1060/1143 [00:20<00:01, 52.87it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.91it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.85it/s, epoch=27/50, avg_epoch_loss=0.177] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.18it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.16it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.30it/s, epoch=28/50, avg_epoch_loss=0.178] 95%|█████████▌| 1087/1143 [00:20<00:01, 53.98it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.04it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.04it/s, epoch=29/50, avg_epoch_loss=0.177] 95%|█████████▍| 1082/1143 [00:20<00:01, 53.71it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.73it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 523/1143 [00:10<00:11, 52.21it/s, epoch=30/50, avg_epoch_loss=0.178] 92%|█████████▏| 1055/1143 [00:20<00:01, 52.77it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.70it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 524/1143 [00:10<00:11, 52.39it/s, epoch=31/50, avg_epoch_loss=0.178] 92%|█████████▏| 1056/1143 [00:20<00:01, 52.82it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.80it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.60it/s, epoch=32/50, avg_epoch_loss=0.178] 94%|█████████▍| 1074/1143 [00:20<00:01, 52.99it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.15it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.61it/s, epoch=33/50, avg_epoch_loss=0.178] 95%|█████████▍| 1081/1143 [00:20<00:01, 54.07it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.08it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.95it/s, epoch=34/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.92it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.95it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.58it/s, epoch=35/50, avg_epoch_loss=0.178] 96%|█████████▌| 1093/1143 [00:20<00:00, 54.64it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.66it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.05it/s, epoch=36/50, avg_epoch_loss=0.177] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.39it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.36it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.75it/s, epoch=37/50, avg_epoch_loss=0.177] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.72it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.77it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.23it/s, epoch=38/50, avg_epoch_loss=0.177] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.93it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.99it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.08it/s, epoch=39/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.85it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.92it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.84it/s, epoch=40/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.75it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.73it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.86it/s, epoch=41/50, avg_epoch_loss=0.177] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.89it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.91it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.69it/s, epoch=42/50, avg_epoch_loss=0.178] 96%|█████████▌| 1095/1143 [00:20<00:00, 54.73it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.76it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.34it/s, epoch=43/50, avg_epoch_loss=0.177] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.24it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.13it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.10it/s, epoch=44/50, avg_epoch_loss=0.178] 93%|█████████▎| 1064/1143 [00:20<00:01, 53.17it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.27it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.88it/s, epoch=45/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.18it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.18it/s, epoch=45/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.69it/s, epoch=46/50, avg_epoch_loss=0.177] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.20it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.42it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.18it/s, epoch=47/50, avg_epoch_loss=0.176] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.26it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.28it/s, epoch=47/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.51it/s, epoch=48/50, avg_epoch_loss=0.177] 96%|█████████▌| 1095/1143 [00:20<00:00, 54.69it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.70it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.89it/s, epoch=49/50, avg_epoch_loss=0.177] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.18it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.13it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.63it/s, epoch=50/50, avg_epoch_loss=0.176] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.42it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.47it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.36447357572615 seconds
Parameter local_units with value 20 had evaluation 2.4476335204324227
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 25, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1050.091244129464 seconds
Creating forecasts took 170.0316184014082 seconds
 Start rescaling
Rescaling took 397.5692309383303 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.71it/s, epoch=1/50, avg_epoch_loss=0.223] 94%|█████████▍| 1078/1143 [00:20<00:01, 54.01it/s, epoch=1/50, avg_epoch_loss=0.203]100%|██████████| 1143/1143 [00:21<00:00, 53.85it/s, epoch=1/50, avg_epoch_loss=0.201]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.75it/s, epoch=2/50, avg_epoch_loss=0.182] 94%|█████████▍| 1079/1143 [00:20<00:01, 53.91it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:21<00:00, 53.97it/s, epoch=2/50, avg_epoch_loss=0.182]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.95it/s, epoch=3/50, avg_epoch_loss=0.181] 94%|█████████▍| 1080/1143 [00:20<00:01, 52.55it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 52.78it/s, epoch=3/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 523/1143 [00:10<00:11, 52.29it/s, epoch=4/50, avg_epoch_loss=0.181] 92%|█████████▏| 1056/1143 [00:20<00:01, 52.83it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.84it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.68it/s, epoch=5/50, avg_epoch_loss=0.18] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.21it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.32it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.45it/s, epoch=6/50, avg_epoch_loss=0.18] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.79it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 54.78it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.50it/s, epoch=7/50, avg_epoch_loss=0.18] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.09it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.17it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.23it/s, epoch=8/50, avg_epoch_loss=0.18] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.79it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.89it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.35it/s, epoch=9/50, avg_epoch_loss=0.18] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.34it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.35it/s, epoch=9/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.26it/s, epoch=10/50, avg_epoch_loss=0.178] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.30it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.28it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.73it/s, epoch=11/50, avg_epoch_loss=0.179] 96%|█████████▋| 1101/1143 [00:20<00:00, 55.04it/s, epoch=11/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.02it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 559/1143 [00:10<00:10, 55.86it/s, epoch=12/50, avg_epoch_loss=0.179] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.49it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.53it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.39it/s, epoch=13/50, avg_epoch_loss=0.179] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.13it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.12it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.43it/s, epoch=14/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 54.91it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.01it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.98it/s, epoch=15/50, avg_epoch_loss=0.179] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.21it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.21it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.50it/s, epoch=16/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 54.96it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.85it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.62it/s, epoch=17/50, avg_epoch_loss=0.179] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.14it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.33it/s, epoch=17/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.19it/s, epoch=18/50, avg_epoch_loss=0.179] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.06it/s, epoch=18/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.11it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.82it/s, epoch=19/50, avg_epoch_loss=0.179] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.73it/s, epoch=19/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.76it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.20it/s, epoch=20/50, avg_epoch_loss=0.178] 94%|█████████▎| 1071/1143 [00:20<00:01, 53.53it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.59it/s, epoch=20/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.24it/s, epoch=21/50, avg_epoch_loss=0.177] 95%|█████████▌| 1086/1143 [00:20<00:01, 54.17it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.16it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.53it/s, epoch=22/50, avg_epoch_loss=0.179] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.55it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.56it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.11it/s, epoch=23/50, avg_epoch_loss=0.177] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.34it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.33it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.45it/s, epoch=24/50, avg_epoch_loss=0.179] 97%|█████████▋| 1110/1143 [00:20<00:00, 54.89it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.97it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.44it/s, epoch=25/50, avg_epoch_loss=0.177] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.21it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.22it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.07it/s, epoch=26/50, avg_epoch_loss=0.177] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.11it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.11it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.16it/s, epoch=27/50, avg_epoch_loss=0.177] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.33it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.30it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.22it/s, epoch=28/50, avg_epoch_loss=0.178] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.28it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.26it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.89it/s, epoch=29/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.83it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.82it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.13it/s, epoch=30/50, avg_epoch_loss=0.178] 97%|█████████▋| 1107/1143 [00:20<00:00, 55.32it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.27it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.87it/s, epoch=31/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.22it/s, epoch=31/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.34it/s, epoch=31/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.26it/s, epoch=32/50, avg_epoch_loss=0.178] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.58it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.57it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.18it/s, epoch=33/50, avg_epoch_loss=0.178] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.22it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.11it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.13it/s, epoch=34/50, avg_epoch_loss=0.177] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.19it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.16it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.46it/s, epoch=35/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.20it/s, epoch=35/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.21it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.76it/s, epoch=36/50, avg_epoch_loss=0.177] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.68it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.62it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.08it/s, epoch=37/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.05it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.04it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.07it/s, epoch=38/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.93it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.91it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.53it/s, epoch=39/50, avg_epoch_loss=0.177] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.93it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.91it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.51it/s, epoch=40/50, avg_epoch_loss=0.177] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.19it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.25it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.54it/s, epoch=41/50, avg_epoch_loss=0.177] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.90it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.86it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.20it/s, epoch=42/50, avg_epoch_loss=0.177] 97%|█████████▋| 1106/1143 [00:20<00:00, 55.28it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.26it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.29it/s, epoch=43/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.00it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.16it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.45it/s, epoch=44/50, avg_epoch_loss=0.178] 95%|█████████▌| 1090/1143 [00:20<00:00, 53.97it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.91it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.26it/s, epoch=45/50, avg_epoch_loss=0.176] 93%|█████████▎| 1066/1143 [00:20<00:01, 52.77it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.93it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.17it/s, epoch=46/50, avg_epoch_loss=0.177] 93%|█████████▎| 1064/1143 [00:20<00:01, 52.66it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.80it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.86it/s, epoch=47/50, avg_epoch_loss=0.177] 93%|█████████▎| 1064/1143 [00:20<00:01, 53.17it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.15it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.27it/s, epoch=48/50, avg_epoch_loss=0.178] 93%|█████████▎| 1066/1143 [00:20<00:01, 52.96it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.85it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.73it/s, epoch=49/50, avg_epoch_loss=0.177] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.75it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.75it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.34it/s, epoch=50/50, avg_epoch_loss=0.177] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.24it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.03it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 84.93252056092024 seconds
Parameter local_units with value 25 had evaluation 2.441721746359383
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 30, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1049.44941207394 seconds
Creating forecasts took 172.13918306306005 seconds
 Start rescaling
Rescaling took 397.70379028096795 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.92it/s, epoch=1/50, avg_epoch_loss=0.225] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.74it/s, epoch=1/50, avg_epoch_loss=0.204]100%|██████████| 1143/1143 [00:20<00:00, 55.62it/s, epoch=1/50, avg_epoch_loss=0.203]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.53it/s, epoch=2/50, avg_epoch_loss=0.182] 97%|█████████▋| 1113/1143 [00:20<00:00, 55.61it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:20<00:00, 55.63it/s, epoch=2/50, avg_epoch_loss=0.182]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.90it/s, epoch=3/50, avg_epoch_loss=0.181] 99%|█████████▊| 1127/1143 [00:20<00:00, 56.35it/s, epoch=3/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:20<00:00, 56.30it/s, epoch=3/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.11it/s, epoch=4/50, avg_epoch_loss=0.181] 98%|█████████▊| 1124/1143 [00:20<00:00, 56.14it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.14it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.08it/s, epoch=5/50, avg_epoch_loss=0.179] 99%|█████████▊| 1127/1143 [00:20<00:00, 56.37it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.34it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.01it/s, epoch=6/50, avg_epoch_loss=0.18]100%|█████████▉| 1142/1143 [00:20<00:00, 56.83it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.86it/s, epoch=6/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.43it/s, epoch=7/50, avg_epoch_loss=0.18] 99%|█████████▉| 1130/1143 [00:20<00:00, 56.09it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.15it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.83it/s, epoch=8/50, avg_epoch_loss=0.18] 97%|█████████▋| 1105/1143 [00:20<00:00, 55.23it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.23it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.16it/s, epoch=9/50, avg_epoch_loss=0.179] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.79it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.85it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.94it/s, epoch=10/50, avg_epoch_loss=0.179] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.58it/s, epoch=10/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.50it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.11it/s, epoch=11/50, avg_epoch_loss=0.179] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.63it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.61it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.90it/s, epoch=12/50, avg_epoch_loss=0.179] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.19it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.11it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.11it/s, epoch=13/50, avg_epoch_loss=0.179] 98%|█████████▊| 1124/1143 [00:20<00:00, 55.66it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.71it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.48it/s, epoch=14/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.46it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.48it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.93it/s, epoch=15/50, avg_epoch_loss=0.178] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.86it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.92it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.06it/s, epoch=16/50, avg_epoch_loss=0.177] 96%|█████████▌| 1097/1143 [00:20<00:00, 54.93it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.80it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.13it/s, epoch=17/50, avg_epoch_loss=0.179] 99%|█████████▊| 1126/1143 [00:20<00:00, 56.25it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.20it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.26it/s, epoch=18/50, avg_epoch_loss=0.178] 99%|█████████▊| 1126/1143 [00:20<00:00, 55.48it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.60it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.65it/s, epoch=19/50, avg_epoch_loss=0.178] 98%|█████████▊| 1121/1143 [00:20<00:00, 56.08it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.03it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.72it/s, epoch=20/50, avg_epoch_loss=0.178] 94%|█████████▍| 1077/1143 [00:20<00:01, 53.81it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.84it/s, epoch=20/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.39it/s, epoch=21/50, avg_epoch_loss=0.177] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.86it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.85it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.93it/s, epoch=22/50, avg_epoch_loss=0.178] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.22it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.15it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.24it/s, epoch=23/50, avg_epoch_loss=0.177] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.65it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.73it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.90it/s, epoch=24/50, avg_epoch_loss=0.178] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.99it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.96it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.72it/s, epoch=25/50, avg_epoch_loss=0.178] 96%|█████████▌| 1097/1143 [00:20<00:00, 54.78it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.81it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.28it/s, epoch=26/50, avg_epoch_loss=0.178] 95%|█████████▌| 1086/1143 [00:20<00:01, 53.53it/s, epoch=26/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.70it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.11it/s, epoch=27/50, avg_epoch_loss=0.177] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.10it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.04it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.95it/s, epoch=28/50, avg_epoch_loss=0.178] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.72it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.71it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.33it/s, epoch=29/50, avg_epoch_loss=0.177] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.92it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.96it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.20it/s, epoch=30/50, avg_epoch_loss=0.178] 96%|█████████▌| 1093/1143 [00:20<00:00, 54.70it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.55it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.99it/s, epoch=31/50, avg_epoch_loss=0.177] 93%|█████████▎| 1064/1143 [00:20<00:01, 53.21it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.20it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.52it/s, epoch=32/50, avg_epoch_loss=0.178] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.91it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.95it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 525/1143 [00:10<00:11, 52.49it/s, epoch=33/50, avg_epoch_loss=0.178] 92%|█████████▏| 1055/1143 [00:20<00:01, 52.79it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.80it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.84it/s, epoch=34/50, avg_epoch_loss=0.178] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.76it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.71it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.64it/s, epoch=35/50, avg_epoch_loss=0.177] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.55it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.51it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.77it/s, epoch=36/50, avg_epoch_loss=0.177] 95%|█████████▌| 1087/1143 [00:20<00:01, 54.42it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.29it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.66it/s, epoch=37/50, avg_epoch_loss=0.177] 94%|█████████▍| 1079/1143 [00:20<00:01, 53.92it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.99it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.91it/s, epoch=38/50, avg_epoch_loss=0.177] 93%|█████████▎| 1060/1143 [00:20<00:01, 52.41it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.70it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 527/1143 [00:10<00:11, 52.67it/s, epoch=39/50, avg_epoch_loss=0.177] 93%|█████████▎| 1067/1143 [00:20<00:01, 53.41it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.38it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.72it/s, epoch=40/50, avg_epoch_loss=0.177] 92%|█████████▏| 1056/1143 [00:20<00:01, 52.62it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.67it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.62it/s, epoch=41/50, avg_epoch_loss=0.177] 94%|█████████▍| 1077/1143 [00:20<00:01, 53.80it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.65it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.09it/s, epoch=42/50, avg_epoch_loss=0.177] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.66it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.52it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.79it/s, epoch=43/50, avg_epoch_loss=0.177] 93%|█████████▎| 1068/1143 [00:20<00:01, 53.44it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.34it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.56it/s, epoch=44/50, avg_epoch_loss=0.178] 97%|█████████▋| 1112/1143 [00:20<00:00, 54.85it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.96it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.54it/s, epoch=45/50, avg_epoch_loss=0.176] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.54it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.35it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.97it/s, epoch=46/50, avg_epoch_loss=0.178] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.65it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.83it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.06it/s, epoch=47/50, avg_epoch_loss=0.176] 95%|█████████▍| 1082/1143 [00:20<00:01, 54.04it/s, epoch=47/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:21<00:00, 54.01it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.44it/s, epoch=48/50, avg_epoch_loss=0.178] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.34it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.34it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.02it/s, epoch=49/50, avg_epoch_loss=0.176] 95%|█████████▍| 1082/1143 [00:20<00:01, 53.99it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.02it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.39it/s, epoch=50/50, avg_epoch_loss=0.177] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.29it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.36it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.08922122605145 seconds
Parameter local_units with value 30 had evaluation 2.3547989679583368
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 35, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1048.0902394466102 seconds
Creating forecasts took 170.35661789402366 seconds
 Start rescaling
Rescaling took 399.384435961023 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.91it/s, epoch=1/50, avg_epoch_loss=0.229] 95%|█████████▍| 1081/1143 [00:20<00:01, 54.00it/s, epoch=1/50, avg_epoch_loss=0.206]100%|██████████| 1143/1143 [00:21<00:00, 53.92it/s, epoch=1/50, avg_epoch_loss=0.205]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.07it/s, epoch=2/50, avg_epoch_loss=0.183] 93%|█████████▎| 1062/1143 [00:20<00:01, 52.97it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:21<00:00, 52.95it/s, epoch=2/50, avg_epoch_loss=0.182]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.52it/s, epoch=3/50, avg_epoch_loss=0.182] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.14it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:21<00:00, 53.17it/s, epoch=3/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.70it/s, epoch=4/50, avg_epoch_loss=0.181] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.63it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.64it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.54it/s, epoch=5/50, avg_epoch_loss=0.18] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.57it/s, epoch=5/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.61it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 522/1143 [00:10<00:11, 52.18it/s, epoch=6/50, avg_epoch_loss=0.18] 92%|█████████▏| 1051/1143 [00:20<00:01, 52.56it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.59it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▎     | 499/1143 [00:10<00:12, 49.88it/s, epoch=7/50, avg_epoch_loss=0.179] 91%|█████████ | 1035/1143 [00:20<00:02, 52.04it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:22<00:00, 51.93it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.50it/s, epoch=8/50, avg_epoch_loss=0.179] 94%|█████████▎| 1070/1143 [00:20<00:01, 52.84it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.89it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.57it/s, epoch=9/50, avg_epoch_loss=0.18] 94%|█████████▍| 1072/1143 [00:20<00:01, 52.79it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.89it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.94it/s, epoch=10/50, avg_epoch_loss=0.179] 93%|█████████▎| 1066/1143 [00:20<00:01, 53.30it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.39it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.59it/s, epoch=11/50, avg_epoch_loss=0.18] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.40it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.49it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 515/1143 [00:10<00:12, 51.43it/s, epoch=12/50, avg_epoch_loss=0.178] 91%|█████████▏| 1043/1143 [00:20<00:01, 52.20it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.39it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.23it/s, epoch=13/50, avg_epoch_loss=0.179] 93%|█████████▎| 1066/1143 [00:20<00:01, 53.20it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.38it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 523/1143 [00:10<00:11, 52.24it/s, epoch=14/50, avg_epoch_loss=0.178] 93%|█████████▎| 1063/1143 [00:20<00:01, 53.27it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.14it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.40it/s, epoch=15/50, avg_epoch_loss=0.178] 93%|█████████▎| 1068/1143 [00:20<00:01, 52.56it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.86it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 523/1143 [00:10<00:11, 52.29it/s, epoch=16/50, avg_epoch_loss=0.177] 92%|█████████▏| 1055/1143 [00:20<00:01, 52.77it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.92it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.67it/s, epoch=17/50, avg_epoch_loss=0.178] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.51it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.50it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.73it/s, epoch=18/50, avg_epoch_loss=0.178] 93%|█████████▎| 1060/1143 [00:20<00:01, 52.95it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.84it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.93it/s, epoch=19/50, avg_epoch_loss=0.179] 47%|████▋     | 540/1143 [00:20<00:11, 53.93it/s, epoch=19/50, avg_epoch_loss=0.178] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.87it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.67it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 510/1143 [00:10<00:12, 50.97it/s, epoch=20/50, avg_epoch_loss=0.178] 91%|█████████▏| 1045/1143 [00:20<00:01, 52.44it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.26it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 527/1143 [00:10<00:11, 52.64it/s, epoch=21/50, avg_epoch_loss=0.177] 93%|█████████▎| 1060/1143 [00:20<00:01, 53.03it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.15it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.61it/s, epoch=22/50, avg_epoch_loss=0.178] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.52it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.49it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 523/1143 [00:10<00:11, 52.28it/s, epoch=23/50, avg_epoch_loss=0.176] 93%|█████████▎| 1063/1143 [00:20<00:01, 53.24it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.28it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 523/1143 [00:10<00:11, 52.21it/s, epoch=24/50, avg_epoch_loss=0.179] 92%|█████████▏| 1053/1143 [00:20<00:01, 52.63it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.50it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.06it/s, epoch=25/50, avg_epoch_loss=0.177] 94%|█████████▍| 1075/1143 [00:20<00:01, 53.79it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.56it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.95it/s, epoch=26/50, avg_epoch_loss=0.177] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.77it/s, epoch=26/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.75it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.03it/s, epoch=27/50, avg_epoch_loss=0.177] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.10it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.10it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.65it/s, epoch=28/50, avg_epoch_loss=0.178] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.35it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.41it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 557/1143 [00:10<00:10, 55.66it/s, epoch=29/50, avg_epoch_loss=0.178] 97%|█████████▋| 1114/1143 [00:20<00:00, 55.55it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.57it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.97it/s, epoch=30/50, avg_epoch_loss=0.178] 98%|█████████▊| 1120/1143 [00:20<00:00, 55.81it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.84it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.28it/s, epoch=31/50, avg_epoch_loss=0.177] 99%|█████████▊| 1126/1143 [00:20<00:00, 55.33it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.47it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.22it/s, epoch=32/50, avg_epoch_loss=0.178] 93%|█████████▎| 1066/1143 [00:20<00:01, 52.27it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.57it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.80it/s, epoch=33/50, avg_epoch_loss=0.178] 95%|█████████▌| 1086/1143 [00:20<00:01, 54.35it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.38it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.09it/s, epoch=34/50, avg_epoch_loss=0.177] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.11it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.03it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.98it/s, epoch=35/50, avg_epoch_loss=0.178] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.08it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.07it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.54it/s, epoch=36/50, avg_epoch_loss=0.176] 97%|█████████▋| 1112/1143 [00:20<00:00, 55.44it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.36it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.69it/s, epoch=37/50, avg_epoch_loss=0.177] 48%|████▊     | 547/1143 [00:20<00:10, 54.69it/s, epoch=37/50, avg_epoch_loss=0.177] 96%|█████████▌| 1093/1143 [00:20<00:00, 54.19it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.30it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.00it/s, epoch=38/50, avg_epoch_loss=0.177] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.11it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.17it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.53it/s, epoch=39/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.26it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.13it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.74it/s, epoch=40/50, avg_epoch_loss=0.177] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.54it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.57it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.48it/s, epoch=41/50, avg_epoch_loss=0.177] 97%|█████████▋| 1111/1143 [00:20<00:00, 55.53it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.52it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.44it/s, epoch=42/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.78it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.71it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.24it/s, epoch=43/50, avg_epoch_loss=0.177] 95%|█████████▌| 1086/1143 [00:20<00:01, 54.44it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.32it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.56it/s, epoch=44/50, avg_epoch_loss=0.178] 98%|█████████▊| 1115/1143 [00:20<00:00, 55.71it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.69it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.36it/s, epoch=45/50, avg_epoch_loss=0.176] 97%|█████████▋| 1108/1143 [00:20<00:00, 55.12it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.09it/s, epoch=45/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.69it/s, epoch=46/50, avg_epoch_loss=0.177] 96%|█████████▌| 1094/1143 [00:20<00:00, 53.46it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.61it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.60it/s, epoch=47/50, avg_epoch_loss=0.176] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.72it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.75it/s, epoch=47/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.12it/s, epoch=48/50, avg_epoch_loss=0.178] 93%|█████████▎| 1065/1143 [00:20<00:01, 53.21it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.25it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.39it/s, epoch=49/50, avg_epoch_loss=0.176] 93%|█████████▎| 1068/1143 [00:20<00:01, 52.73it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.85it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 515/1143 [00:10<00:12, 51.43it/s, epoch=50/50, avg_epoch_loss=0.177] 92%|█████████▏| 1048/1143 [00:20<00:01, 52.48it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.63it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.95029536634684 seconds
Parameter local_units with value 35 had evaluation 2.3893552024317355
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 40, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1062.1490900404751 seconds
Creating forecasts took 171.10634095035493 seconds
 Start rescaling
Rescaling took 397.4024836476892 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 520/1143 [00:10<00:11, 51.99it/s, epoch=1/50, avg_epoch_loss=0.226] 92%|█████████▏| 1047/1143 [00:20<00:01, 52.38it/s, epoch=1/50, avg_epoch_loss=0.205]100%|██████████| 1143/1143 [00:21<00:00, 52.47it/s, epoch=1/50, avg_epoch_loss=0.203]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.64it/s, epoch=2/50, avg_epoch_loss=0.182] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.63it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:21<00:00, 53.67it/s, epoch=2/50, avg_epoch_loss=0.182]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.87it/s, epoch=3/50, avg_epoch_loss=0.18] 93%|█████████▎| 1058/1143 [00:20<00:01, 52.64it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.71it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.21it/s, epoch=4/50, avg_epoch_loss=0.181] 95%|█████████▌| 1086/1143 [00:20<00:01, 54.08it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.08it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.88it/s, epoch=5/50, avg_epoch_loss=0.179] 93%|█████████▎| 1061/1143 [00:20<00:01, 53.04it/s, epoch=5/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.96it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 527/1143 [00:10<00:11, 52.61it/s, epoch=6/50, avg_epoch_loss=0.18] 93%|█████████▎| 1060/1143 [00:20<00:01, 53.00it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.92it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.82it/s, epoch=7/50, avg_epoch_loss=0.179] 93%|█████████▎| 1066/1143 [00:20<00:01, 52.36it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.47it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.44it/s, epoch=8/50, avg_epoch_loss=0.179] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.37it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.32it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.57it/s, epoch=9/50, avg_epoch_loss=0.18] 92%|█████████▏| 1052/1143 [00:20<00:01, 52.45it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.59it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.71it/s, epoch=10/50, avg_epoch_loss=0.179] 92%|█████████▏| 1056/1143 [00:20<00:01, 52.38it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.33it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 527/1143 [00:10<00:11, 52.68it/s, epoch=11/50, avg_epoch_loss=0.179] 92%|█████████▏| 1054/1143 [00:20<00:01, 52.28it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.46it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.15it/s, epoch=12/50, avg_epoch_loss=0.178] 96%|█████████▌| 1093/1143 [00:20<00:00, 54.65it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.64it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.81it/s, epoch=13/50, avg_epoch_loss=0.179] 97%|█████████▋| 1103/1143 [00:20<00:00, 55.14it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.11it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.66it/s, epoch=14/50, avg_epoch_loss=0.179] 96%|█████████▌| 1097/1143 [00:20<00:00, 54.85it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.86it/s, epoch=14/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.59it/s, epoch=15/50, avg_epoch_loss=0.178] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.66it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.64it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.82it/s, epoch=16/50, avg_epoch_loss=0.178] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.40it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.37it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.59it/s, epoch=17/50, avg_epoch_loss=0.178] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.82it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.82it/s, epoch=17/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.37it/s, epoch=18/50, avg_epoch_loss=0.178] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.54it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.43it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.56it/s, epoch=19/50, avg_epoch_loss=0.179] 96%|█████████▌| 1095/1143 [00:20<00:00, 54.71it/s, epoch=19/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.71it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.62it/s, epoch=20/50, avg_epoch_loss=0.179] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.46it/s, epoch=20/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.44it/s, epoch=20/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.88it/s, epoch=21/50, avg_epoch_loss=0.178] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.81it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.85it/s, epoch=21/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 549/1143 [00:10<00:10, 54.87it/s, epoch=22/50, avg_epoch_loss=0.178] 96%|█████████▌| 1098/1143 [00:20<00:00, 54.65it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.60it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.48it/s, epoch=23/50, avg_epoch_loss=0.177] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.39it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.45it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.13it/s, epoch=24/50, avg_epoch_loss=0.179] 95%|█████████▍| 1084/1143 [00:20<00:01, 53.71it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.82it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.80it/s, epoch=25/50, avg_epoch_loss=0.178] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.54it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.53it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.25it/s, epoch=26/50, avg_epoch_loss=0.178] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.54it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.52it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.99it/s, epoch=27/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.52it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.63it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 553/1143 [00:10<00:10, 55.21it/s, epoch=28/50, avg_epoch_loss=0.178] 97%|█████████▋| 1106/1143 [00:20<00:00, 54.65it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.74it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 548/1143 [00:10<00:10, 54.74it/s, epoch=29/50, avg_epoch_loss=0.178] 96%|█████████▌| 1099/1143 [00:20<00:00, 54.91it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.91it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.24it/s, epoch=30/50, avg_epoch_loss=0.178] 96%|█████████▌| 1097/1143 [00:20<00:00, 54.88it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.76it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.20it/s, epoch=31/50, avg_epoch_loss=0.177] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.06it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.01it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.12it/s, epoch=32/50, avg_epoch_loss=0.178] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.08it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.91it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.05it/s, epoch=33/50, avg_epoch_loss=0.178] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.40it/s, epoch=33/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.35it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.20it/s, epoch=34/50, avg_epoch_loss=0.177] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.46it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.42it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.12it/s, epoch=35/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 55.00it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.03it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.01it/s, epoch=36/50, avg_epoch_loss=0.177] 96%|█████████▋| 1102/1143 [00:20<00:00, 54.62it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.55it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.99it/s, epoch=37/50, avg_epoch_loss=0.177] 94%|█████████▍| 1080/1143 [00:20<00:01, 52.89it/s, epoch=37/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.09it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.83it/s, epoch=38/50, avg_epoch_loss=0.177] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.82it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.63it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.77it/s, epoch=39/50, avg_epoch_loss=0.177] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.16it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.06it/s, epoch=39/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.94it/s, epoch=40/50, avg_epoch_loss=0.177] 96%|█████████▋| 1101/1143 [00:20<00:00, 54.98it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.99it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.40it/s, epoch=41/50, avg_epoch_loss=0.177] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.25it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.40it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.94it/s, epoch=42/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.75it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.79it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 543/1143 [00:10<00:11, 54.20it/s, epoch=43/50, avg_epoch_loss=0.178] 95%|█████████▌| 1091/1143 [00:20<00:00, 54.50it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.51it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 552/1143 [00:10<00:10, 55.10it/s, epoch=44/50, avg_epoch_loss=0.178] 97%|█████████▋| 1104/1143 [00:20<00:00, 54.64it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.72it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.47it/s, epoch=45/50, avg_epoch_loss=0.177] 95%|█████████▌| 1090/1143 [00:20<00:00, 54.31it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.32it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.63it/s, epoch=46/50, avg_epoch_loss=0.177] 96%|█████████▌| 1094/1143 [00:20<00:00, 54.57it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.59it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.92it/s, epoch=47/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.80it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.83it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 525/1143 [00:10<00:11, 52.45it/s, epoch=48/50, avg_epoch_loss=0.178] 93%|█████████▎| 1067/1143 [00:20<00:01, 53.43it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.23it/s, epoch=48/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 547/1143 [00:10<00:10, 54.61it/s, epoch=49/50, avg_epoch_loss=0.177] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.98it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.88it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.60it/s, epoch=50/50, avg_epoch_loss=0.177] 96%|█████████▌| 1092/1143 [00:20<00:00, 53.87it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.93it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 85.06497544981539 seconds
Parameter local_units with value 40 had evaluation 2.303230515931753
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 45, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1057.4452600330114 seconds
Creating forecasts took 175.10933100245893 seconds
 Start rescaling
Rescaling took 398.57008270174265 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.13it/s, epoch=1/50, avg_epoch_loss=0.226] 93%|█████████▎| 1064/1143 [00:20<00:01, 52.98it/s, epoch=1/50, avg_epoch_loss=0.205]100%|██████████| 1143/1143 [00:21<00:00, 53.14it/s, epoch=1/50, avg_epoch_loss=0.204]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.75it/s, epoch=2/50, avg_epoch_loss=0.183] 93%|█████████▎| 1063/1143 [00:20<00:01, 53.16it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:21<00:00, 53.13it/s, epoch=2/50, avg_epoch_loss=0.183]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.94it/s, epoch=3/50, avg_epoch_loss=0.18] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.93it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.95it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.32it/s, epoch=4/50, avg_epoch_loss=0.181] 95%|█████████▌| 1088/1143 [00:20<00:01, 53.77it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.88it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.00it/s, epoch=5/50, avg_epoch_loss=0.179] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.15it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 54.13it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 544/1143 [00:10<00:11, 54.30it/s, epoch=6/50, avg_epoch_loss=0.18] 95%|█████████▌| 1088/1143 [00:20<00:01, 53.53it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.72it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 524/1143 [00:10<00:11, 52.39it/s, epoch=7/50, avg_epoch_loss=0.18] 93%|█████████▎| 1062/1143 [00:20<00:01, 53.19it/s, epoch=7/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.10it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.91it/s, epoch=8/50, avg_epoch_loss=0.18] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.82it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.71it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.88it/s, epoch=9/50, avg_epoch_loss=0.179] 93%|█████████▎| 1062/1143 [00:20<00:01, 53.09it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.14it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.50it/s, epoch=10/50, avg_epoch_loss=0.178] 94%|█████████▎| 1070/1143 [00:20<00:01, 52.79it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.94it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 523/1143 [00:10<00:11, 52.25it/s, epoch=11/50, avg_epoch_loss=0.18] 92%|█████████▏| 1056/1143 [00:20<00:01, 52.83it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.83it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.32it/s, epoch=12/50, avg_epoch_loss=0.178] 93%|█████████▎| 1068/1143 [00:20<00:01, 52.88it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.95it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.02it/s, epoch=13/50, avg_epoch_loss=0.178] 93%|█████████▎| 1063/1143 [00:20<00:01, 53.11it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.20it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.01it/s, epoch=14/50, avg_epoch_loss=0.178] 95%|█████████▍| 1082/1143 [00:20<00:01, 53.86it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.92it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 546/1143 [00:10<00:10, 54.59it/s, epoch=15/50, avg_epoch_loss=0.178] 96%|█████████▌| 1092/1143 [00:20<00:00, 54.45it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.43it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.96it/s, epoch=16/50, avg_epoch_loss=0.177] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.79it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.83it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.96it/s, epoch=17/50, avg_epoch_loss=0.179] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.78it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.87it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.56it/s, epoch=18/50, avg_epoch_loss=0.178] 94%|█████████▍| 1073/1143 [00:20<00:01, 53.59it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.48it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.25it/s, epoch=19/50, avg_epoch_loss=0.178] 93%|█████████▎| 1066/1143 [00:20<00:01, 52.59it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.52it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 524/1143 [00:10<00:11, 52.40it/s, epoch=20/50, avg_epoch_loss=0.179] 92%|█████████▏| 1051/1143 [00:20<00:01, 52.55it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.56it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.57it/s, epoch=21/50, avg_epoch_loss=0.177] 92%|█████████▏| 1057/1143 [00:20<00:01, 52.87it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.78it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.72it/s, epoch=22/50, avg_epoch_loss=0.178] 92%|█████████▏| 1056/1143 [00:20<00:01, 52.60it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.67it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.06it/s, epoch=23/50, avg_epoch_loss=0.177] 93%|█████████▎| 1062/1143 [00:20<00:01, 53.05it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.95it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 527/1143 [00:10<00:11, 52.63it/s, epoch=24/50, avg_epoch_loss=0.178] 92%|█████████▏| 1054/1143 [00:20<00:01, 52.59it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.67it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.15it/s, epoch=25/50, avg_epoch_loss=0.177] 93%|█████████▎| 1064/1143 [00:20<00:01, 53.18it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.25it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.04it/s, epoch=26/50, avg_epoch_loss=0.178] 93%|█████████▎| 1062/1143 [00:20<00:01, 53.02it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.11it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.59it/s, epoch=27/50, avg_epoch_loss=0.178] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.31it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.38it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.07it/s, epoch=28/50, avg_epoch_loss=0.179] 93%|█████████▎| 1062/1143 [00:20<00:01, 52.63it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.52it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 511/1143 [00:10<00:12, 51.04it/s, epoch=29/50, avg_epoch_loss=0.178] 90%|█████████ | 1029/1143 [00:20<00:02, 51.46it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 51.42it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.29it/s, epoch=30/50, avg_epoch_loss=0.178] 93%|█████████▎| 1066/1143 [00:20<00:01, 52.95it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.05it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.90it/s, epoch=31/50, avg_epoch_loss=0.177] 93%|█████████▎| 1059/1143 [00:20<00:01, 51.79it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.09it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.85it/s, epoch=32/50, avg_epoch_loss=0.179] 93%|█████████▎| 1059/1143 [00:20<00:01, 52.91it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.80it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 525/1143 [00:10<00:11, 52.47it/s, epoch=33/50, avg_epoch_loss=0.178] 92%|█████████▏| 1053/1143 [00:20<00:01, 52.63it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.68it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.78it/s, epoch=34/50, avg_epoch_loss=0.177] 94%|█████████▍| 1073/1143 [00:20<00:01, 53.75it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.61it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 524/1143 [00:10<00:11, 52.32it/s, epoch=35/50, avg_epoch_loss=0.178] 92%|█████████▏| 1048/1143 [00:20<00:01, 51.28it/s, epoch=35/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 51.41it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.88it/s, epoch=36/50, avg_epoch_loss=0.177] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.99it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.01it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.98it/s, epoch=37/50, avg_epoch_loss=0.177] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.67it/s, epoch=37/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.70it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.45it/s, epoch=38/50, avg_epoch_loss=0.177] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.66it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.55it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.34it/s, epoch=39/50, avg_epoch_loss=0.177] 93%|█████████▎| 1068/1143 [00:20<00:01, 53.06it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.17it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.84it/s, epoch=40/50, avg_epoch_loss=0.177] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.56it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.51it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.16it/s, epoch=41/50, avg_epoch_loss=0.178] 95%|█████████▌| 1087/1143 [00:20<00:01, 54.34it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.31it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.15it/s, epoch=42/50, avg_epoch_loss=0.177] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.19it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.19it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.14it/s, epoch=43/50, avg_epoch_loss=0.178] 93%|█████████▎| 1066/1143 [00:20<00:01, 53.28it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.22it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 525/1143 [00:10<00:11, 52.49it/s, epoch=44/50, avg_epoch_loss=0.178] 92%|█████████▏| 1052/1143 [00:20<00:01, 52.55it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.50it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 525/1143 [00:10<00:11, 52.50it/s, epoch=45/50, avg_epoch_loss=0.176] 92%|█████████▏| 1055/1143 [00:20<00:01, 52.78it/s, epoch=45/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:21<00:00, 52.80it/s, epoch=45/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 542/1143 [00:10<00:11, 54.19it/s, epoch=46/50, avg_epoch_loss=0.177] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.17it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 54.02it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 516/1143 [00:10<00:12, 51.50it/s, epoch=47/50, avg_epoch_loss=0.176] 91%|█████████ | 1039/1143 [00:20<00:02, 51.94it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 51.89it/s, epoch=47/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.04it/s, epoch=48/50, avg_epoch_loss=0.177] 93%|█████████▎| 1064/1143 [00:20<00:01, 53.14it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.12it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.71it/s, epoch=49/50, avg_epoch_loss=0.177] 93%|█████████▎| 1066/1143 [00:20<00:01, 53.35it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.28it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.22it/s, epoch=50/50, avg_epoch_loss=0.177] 94%|█████████▎| 1071/1143 [00:20<00:01, 53.51it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.53it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.62521954625845 seconds
Parameter local_units with value 45 had evaluation 2.2551426032437223
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 50, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1075.075936621055 seconds
Creating forecasts took 171.21709799952805 seconds
 Start rescaling
Rescaling took 398.37042840383947 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 520/1143 [00:10<00:11, 51.99it/s, epoch=1/50, avg_epoch_loss=0.225] 92%|█████████▏| 1047/1143 [00:20<00:01, 52.37it/s, epoch=1/50, avg_epoch_loss=0.204]100%|██████████| 1143/1143 [00:21<00:00, 52.48it/s, epoch=1/50, avg_epoch_loss=0.202]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.08it/s, epoch=2/50, avg_epoch_loss=0.182] 96%|█████████▌| 1096/1143 [00:20<00:00, 54.90it/s, epoch=2/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:20<00:00, 54.89it/s, epoch=2/50, avg_epoch_loss=0.182]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.35it/s, epoch=3/50, avg_epoch_loss=0.18] 97%|█████████▋| 1113/1143 [00:20<00:00, 55.64it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 55.65it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 570/1143 [00:10<00:10, 56.99it/s, epoch=4/50, avg_epoch_loss=0.18]100%|█████████▉| 1140/1143 [00:20<00:00, 56.66it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:20<00:00, 56.71it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 556/1143 [00:10<00:10, 55.58it/s, epoch=5/50, avg_epoch_loss=0.18] 98%|█████████▊| 1118/1143 [00:20<00:00, 55.89it/s, epoch=5/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.83it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 545/1143 [00:10<00:10, 54.49it/s, epoch=6/50, avg_epoch_loss=0.179] 96%|█████████▋| 1102/1143 [00:20<00:00, 55.15it/s, epoch=6/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 54.93it/s, epoch=6/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 550/1143 [00:10<00:10, 54.97it/s, epoch=7/50, avg_epoch_loss=0.179] 96%|█████████▌| 1100/1143 [00:20<00:00, 54.36it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.42it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.96it/s, epoch=8/50, avg_epoch_loss=0.18] 95%|█████████▌| 1088/1143 [00:20<00:01, 54.41it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 54.42it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.31it/s, epoch=9/50, avg_epoch_loss=0.18] 99%|█████████▊| 1128/1143 [00:20<00:00, 55.02it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.24it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 570/1143 [00:10<00:10, 56.92it/s, epoch=10/50, avg_epoch_loss=0.178]100%|█████████▉| 1140/1143 [00:20<00:00, 55.62it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 55.82it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 565/1143 [00:10<00:10, 56.43it/s, epoch=11/50, avg_epoch_loss=0.18] 99%|█████████▉| 1136/1143 [00:20<00:00, 56.76it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.68it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 561/1143 [00:10<00:10, 56.09it/s, epoch=12/50, avg_epoch_loss=0.178] 99%|█████████▊| 1127/1143 [00:20<00:00, 56.38it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 56.34it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.68it/s, epoch=13/50, avg_epoch_loss=0.178]100%|█████████▉| 1139/1143 [00:20<00:00, 56.94it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.90it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 574/1143 [00:10<00:09, 57.38it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.31it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 51%|█████     | 579/1143 [00:10<00:09, 57.82it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.45it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 569/1143 [00:10<00:10, 56.80it/s, epoch=16/50, avg_epoch_loss=0.178]100%|█████████▉| 1138/1143 [00:20<00:00, 56.64it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.66it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 571/1143 [00:10<00:10, 57.05it/s, epoch=17/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:19<00:00, 57.41it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 568/1143 [00:10<00:10, 56.75it/s, epoch=18/50, avg_epoch_loss=0.178] 99%|█████████▉| 1137/1143 [00:20<00:00, 56.80it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.78it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 568/1143 [00:10<00:10, 56.80it/s, epoch=19/50, avg_epoch_loss=0.178]100%|█████████▉| 1138/1143 [00:20<00:00, 56.90it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.89it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 574/1143 [00:10<00:09, 57.34it/s, epoch=20/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 57.10it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 573/1143 [00:10<00:09, 57.29it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.98it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 551/1143 [00:10<00:10, 55.10it/s, epoch=22/50, avg_epoch_loss=0.178] 97%|█████████▋| 1110/1143 [00:20<00:00, 55.53it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.50it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 558/1143 [00:10<00:10, 55.79it/s, epoch=23/50, avg_epoch_loss=0.178] 98%|█████████▊| 1116/1143 [00:20<00:00, 55.69it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.69it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.21it/s, epoch=24/50, avg_epoch_loss=0.179] 99%|█████████▉| 1129/1143 [00:20<00:00, 56.42it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.37it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▊     | 555/1143 [00:10<00:10, 55.46it/s, epoch=25/50, avg_epoch_loss=0.177] 98%|█████████▊| 1119/1143 [00:20<00:00, 55.98it/s, epoch=25/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 55.91it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 569/1143 [00:10<00:10, 56.86it/s, epoch=26/50, avg_epoch_loss=0.178]100%|█████████▉| 1138/1143 [00:20<00:00, 56.86it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.86it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 560/1143 [00:10<00:10, 55.96it/s, epoch=27/50, avg_epoch_loss=0.177] 98%|█████████▊| 1121/1143 [00:20<00:00, 56.01it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.03it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.14it/s, epoch=28/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:20<00:00, 57.12it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 570/1143 [00:10<00:10, 56.94it/s, epoch=29/50, avg_epoch_loss=0.177]100%|█████████▉| 1140/1143 [00:20<00:00, 56.57it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.63it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 570/1143 [00:10<00:10, 56.90it/s, epoch=30/50, avg_epoch_loss=0.179]100%|█████████▉| 1140/1143 [00:20<00:00, 54.34it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 54.71it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.27it/s, epoch=31/50, avg_epoch_loss=0.177] 99%|█████████▉| 1131/1143 [00:20<00:00, 56.57it/s, epoch=31/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.52it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.19it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.90it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 569/1143 [00:10<00:10, 56.90it/s, epoch=33/50, avg_epoch_loss=0.178]100%|█████████▉| 1138/1143 [00:20<00:00, 56.48it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:20<00:00, 56.54it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 564/1143 [00:10<00:10, 56.38it/s, epoch=34/50, avg_epoch_loss=0.176] 99%|█████████▉| 1134/1143 [00:20<00:00, 56.71it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.65it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 575/1143 [00:10<00:09, 57.46it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:19<00:00, 57.46it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.24it/s, epoch=36/50, avg_epoch_loss=0.176] 99%|█████████▊| 1126/1143 [00:20<00:00, 55.89it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 55.96it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.22it/s, epoch=37/50, avg_epoch_loss=0.178] 99%|█████████▊| 1127/1143 [00:20<00:00, 56.30it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.29it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.13it/s, epoch=38/50, avg_epoch_loss=0.177] 99%|█████████▉| 1131/1143 [00:20<00:00, 56.57it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.48it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 563/1143 [00:10<00:10, 56.27it/s, epoch=39/50, avg_epoch_loss=0.178] 99%|█████████▉| 1133/1143 [00:20<00:00, 56.66it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.58it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 49%|████▉     | 562/1143 [00:10<00:10, 56.14it/s, epoch=40/50, avg_epoch_loss=0.176] 99%|█████████▊| 1128/1143 [00:20<00:00, 56.39it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.34it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 575/1143 [00:10<00:09, 57.43it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 57.12it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 573/1143 [00:10<00:09, 57.24it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.92it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.60it/s, epoch=43/50, avg_epoch_loss=0.177]100%|█████████▉| 1138/1143 [00:20<00:00, 56.84it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.79it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 567/1143 [00:10<00:10, 56.62it/s, epoch=44/50, avg_epoch_loss=0.178]100%|█████████▉| 1138/1143 [00:20<00:00, 56.89it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.85it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 569/1143 [00:10<00:10, 56.87it/s, epoch=45/50, avg_epoch_loss=0.177]100%|█████████▉| 1138/1143 [00:20<00:00, 56.85it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.86it/s, epoch=45/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 573/1143 [00:10<00:09, 57.28it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.76it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 568/1143 [00:10<00:10, 56.78it/s, epoch=47/50, avg_epoch_loss=0.177] 99%|█████████▉| 1136/1143 [00:20<00:00, 56.43it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.47it/s, epoch=47/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|█████     | 572/1143 [00:10<00:09, 57.15it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 57.08it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 50%|████▉     | 566/1143 [00:10<00:10, 56.54it/s, epoch=49/50, avg_epoch_loss=0.176] 99%|█████████▉| 1132/1143 [00:20<00:00, 56.05it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 56.12it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 48%|████▊     | 554/1143 [00:10<00:10, 55.36it/s, epoch=50/50, avg_epoch_loss=0.177] 97%|█████████▋| 1108/1143 [00:20<00:00, 54.85it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:20<00:00, 54.78it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 85.96064600534737 seconds
Parameter local_units with value 50 had evaluation 2.3302862643589997
The best value for local_units is 45 with evaluation 2.2551426032437223
 md[local_units] = 45
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 45, 'local_layers': 1, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1016.5110011398792 seconds
Creating forecasts took 172.26166681200266 seconds
 Start rescaling
Rescaling took 399.17120378650725 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.87it/s, epoch=1/50, avg_epoch_loss=0.223] 94%|█████████▎| 1070/1143 [00:20<00:01, 53.57it/s, epoch=1/50, avg_epoch_loss=0.203]100%|██████████| 1143/1143 [00:21<00:00, 53.49it/s, epoch=1/50, avg_epoch_loss=0.202]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.18it/s, epoch=2/50, avg_epoch_loss=0.183] 94%|█████████▎| 1069/1143 [00:20<00:01, 53.48it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:21<00:00, 53.39it/s, epoch=2/50, avg_epoch_loss=0.182]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.36it/s, epoch=3/50, avg_epoch_loss=0.18] 93%|█████████▎| 1068/1143 [00:20<00:01, 53.08it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.19it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.80it/s, epoch=4/50, avg_epoch_loss=0.18] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.62it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.67it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 539/1143 [00:10<00:11, 53.86it/s, epoch=5/50, avg_epoch_loss=0.179] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.43it/s, epoch=5/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.43it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.29it/s, epoch=6/50, avg_epoch_loss=0.18] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.71it/s, epoch=6/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.61it/s, epoch=6/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.59it/s, epoch=7/50, avg_epoch_loss=0.18] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.45it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.52it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.63it/s, epoch=8/50, avg_epoch_loss=0.18] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.49it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 53.43it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.54it/s, epoch=9/50, avg_epoch_loss=0.18] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.36it/s, epoch=9/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 53.36it/s, epoch=9/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.45it/s, epoch=10/50, avg_epoch_loss=0.178] 94%|█████████▎| 1070/1143 [00:20<00:01, 52.85it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.96it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 520/1143 [00:10<00:11, 51.99it/s, epoch=11/50, avg_epoch_loss=0.179] 92%|█████████▏| 1050/1143 [00:20<00:01, 52.54it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.46it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 521/1143 [00:10<00:11, 52.10it/s, epoch=12/50, avg_epoch_loss=0.178] 91%|█████████ | 1042/1143 [00:20<00:01, 51.85it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:22<00:00, 51.92it/s, epoch=12/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 507/1143 [00:10<00:12, 50.61it/s, epoch=13/50, avg_epoch_loss=0.178] 89%|████████▊ | 1014/1143 [00:20<00:02, 50.53it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 50.52it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 523/1143 [00:10<00:11, 52.25it/s, epoch=14/50, avg_epoch_loss=0.178] 92%|█████████▏| 1046/1143 [00:20<00:01, 51.74it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 51.96it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.96it/s, epoch=15/50, avg_epoch_loss=0.178] 93%|█████████▎| 1068/1143 [00:20<00:01, 53.42it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.32it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.59it/s, epoch=16/50, avg_epoch_loss=0.178] 94%|█████████▍| 1078/1143 [00:20<00:01, 53.92it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.83it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.18it/s, epoch=17/50, avg_epoch_loss=0.179] 94%|█████████▎| 1069/1143 [00:20<00:01, 53.44it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.44it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 536/1143 [00:10<00:11, 53.56it/s, epoch=18/50, avg_epoch_loss=0.178] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.79it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.69it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.69it/s, epoch=19/50, avg_epoch_loss=0.178] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.70it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.70it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.00it/s, epoch=20/50, avg_epoch_loss=0.178] 95%|█████████▍| 1083/1143 [00:20<00:01, 54.09it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.84it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.95it/s, epoch=21/50, avg_epoch_loss=0.178] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.66it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.46it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.93it/s, epoch=22/50, avg_epoch_loss=0.178] 95%|█████████▍| 1085/1143 [00:20<00:01, 54.23it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.22it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.67it/s, epoch=23/50, avg_epoch_loss=0.177] 94%|█████████▍| 1077/1143 [00:20<00:01, 53.86it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.77it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.45it/s, epoch=24/50, avg_epoch_loss=0.179] 94%|█████████▍| 1072/1143 [00:20<00:01, 53.58it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.62it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.82it/s, epoch=25/50, avg_epoch_loss=0.178] 94%|█████████▎| 1069/1143 [00:20<00:01, 53.48it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.41it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 532/1143 [00:10<00:11, 53.16it/s, epoch=26/50, avg_epoch_loss=0.178] 94%|█████████▎| 1069/1143 [00:20<00:01, 53.45it/s, epoch=26/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.32it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 513/1143 [00:10<00:12, 51.21it/s, epoch=27/50, avg_epoch_loss=0.177] 92%|█████████▏| 1050/1143 [00:20<00:01, 52.63it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.54it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 541/1143 [00:10<00:11, 54.08it/s, epoch=28/50, avg_epoch_loss=0.179] 95%|█████████▍| 1084/1143 [00:20<00:01, 54.17it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 54.14it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 521/1143 [00:10<00:11, 52.07it/s, epoch=29/50, avg_epoch_loss=0.177] 92%|█████████▏| 1049/1143 [00:20<00:01, 52.47it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.52it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.76it/s, epoch=30/50, avg_epoch_loss=0.178] 92%|█████████▏| 1056/1143 [00:20<00:01, 52.47it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.47it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 519/1143 [00:10<00:12, 51.90it/s, epoch=31/50, avg_epoch_loss=0.177] 91%|█████████ | 1039/1143 [00:20<00:02, 51.92it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 51.81it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 518/1143 [00:10<00:12, 51.76it/s, epoch=32/50, avg_epoch_loss=0.178] 91%|█████████ | 1036/1143 [00:20<00:02, 51.53it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 51.59it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 519/1143 [00:10<00:12, 51.82it/s, epoch=33/50, avg_epoch_loss=0.177] 91%|█████████ | 1040/1143 [00:20<00:01, 51.94it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 51.93it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 521/1143 [00:10<00:11, 52.09it/s, epoch=34/50, avg_epoch_loss=0.177] 91%|█████████▏| 1043/1143 [00:20<00:01, 52.10it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 51.99it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 508/1143 [00:10<00:12, 50.77it/s, epoch=35/50, avg_epoch_loss=0.177] 90%|█████████ | 1033/1143 [00:20<00:02, 51.76it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 51.86it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.59it/s, epoch=36/50, avg_epoch_loss=0.176] 93%|█████████▎| 1065/1143 [00:20<00:01, 53.35it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.30it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 538/1143 [00:10<00:11, 53.74it/s, epoch=37/50, avg_epoch_loss=0.177] 94%|█████████▍| 1076/1143 [00:20<00:01, 53.53it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.47it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 533/1143 [00:10<00:11, 53.22it/s, epoch=38/50, avg_epoch_loss=0.177] 94%|█████████▎| 1071/1143 [00:20<00:01, 53.51it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.44it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.65it/s, epoch=39/50, avg_epoch_loss=0.177] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.98it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.93it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 534/1143 [00:10<00:11, 53.34it/s, epoch=40/50, avg_epoch_loss=0.177] 94%|█████████▍| 1073/1143 [00:20<00:01, 53.65it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.62it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.69it/s, epoch=41/50, avg_epoch_loss=0.177] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.27it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.27it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 535/1143 [00:10<00:11, 53.43it/s, epoch=42/50, avg_epoch_loss=0.178] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.69it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 53.66it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 527/1143 [00:10<00:11, 52.68it/s, epoch=43/50, avg_epoch_loss=0.177] 93%|█████████▎| 1058/1143 [00:20<00:01, 52.89it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.88it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 540/1143 [00:10<00:11, 53.92it/s, epoch=44/50, avg_epoch_loss=0.177] 94%|█████████▍| 1080/1143 [00:20<00:01, 53.72it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.80it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 47%|████▋     | 537/1143 [00:10<00:11, 53.64it/s, epoch=45/50, avg_epoch_loss=0.176] 94%|█████████▍| 1074/1143 [00:20<00:01, 53.28it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.40it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.98it/s, epoch=46/50, avg_epoch_loss=0.178] 93%|█████████▎| 1064/1143 [00:20<00:01, 53.19it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.04it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 531/1143 [00:10<00:11, 53.06it/s, epoch=47/50, avg_epoch_loss=0.176] 93%|█████████▎| 1062/1143 [00:20<00:01, 53.03it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 53.08it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.53it/s, epoch=48/50, avg_epoch_loss=0.177] 92%|█████████▏| 1057/1143 [00:20<00:01, 52.81it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.80it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 530/1143 [00:10<00:11, 52.92it/s, epoch=49/50, avg_epoch_loss=0.177] 93%|█████████▎| 1062/1143 [00:20<00:01, 53.03it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.98it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 509/1143 [00:10<00:12, 50.81it/s, epoch=50/50, avg_epoch_loss=0.177] 91%|█████████ | 1038/1143 [00:20<00:02, 52.01it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 51.89it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 85.95037216320634 seconds
Parameter local_layers with value 1 had evaluation 2.5780958198366766
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 45, 'local_layers': 2, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1077.4045732431114 seconds
Creating forecasts took 172.55747005715966 seconds
 Start rescaling
Rescaling took 397.1307939160615 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 503/1143 [00:10<00:12, 50.26it/s, epoch=1/50, avg_epoch_loss=0.234] 89%|████████▊ | 1012/1143 [00:20<00:02, 50.63it/s, epoch=1/50, avg_epoch_loss=0.209]100%|██████████| 1143/1143 [00:22<00:00, 50.64it/s, epoch=1/50, avg_epoch_loss=0.206]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 525/1143 [00:10<00:11, 52.42it/s, epoch=2/50, avg_epoch_loss=0.183] 92%|█████████▏| 1050/1143 [00:20<00:01, 52.23it/s, epoch=2/50, avg_epoch_loss=0.183]100%|██████████| 1143/1143 [00:21<00:00, 52.36it/s, epoch=2/50, avg_epoch_loss=0.183]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 522/1143 [00:10<00:11, 52.14it/s, epoch=3/50, avg_epoch_loss=0.182] 91%|█████████▏| 1044/1143 [00:20<00:01, 51.68it/s, epoch=3/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:22<00:00, 51.79it/s, epoch=3/50, avg_epoch_loss=0.182]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 525/1143 [00:10<00:11, 52.46it/s, epoch=4/50, avg_epoch_loss=0.181] 46%|████▌     | 525/1143 [00:20<00:11, 52.46it/s, epoch=4/50, avg_epoch_loss=0.181] 92%|█████████▏| 1046/1143 [00:20<00:01, 52.14it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.23it/s, epoch=4/50, avg_epoch_loss=0.181]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 524/1143 [00:10<00:11, 52.34it/s, epoch=5/50, avg_epoch_loss=0.179] 92%|█████████▏| 1048/1143 [00:20<00:01, 52.26it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.27it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 523/1143 [00:10<00:11, 52.20it/s, epoch=6/50, avg_epoch_loss=0.18] 92%|█████████▏| 1051/1143 [00:20<00:01, 52.54it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:21<00:00, 52.45it/s, epoch=6/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.90it/s, epoch=7/50, avg_epoch_loss=0.179] 93%|█████████▎| 1058/1143 [00:20<00:01, 52.83it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.86it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 514/1143 [00:10<00:12, 51.33it/s, epoch=8/50, avg_epoch_loss=0.179] 90%|█████████ | 1031/1143 [00:20<00:02, 51.53it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:22<00:00, 51.34it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 515/1143 [00:10<00:12, 51.43it/s, epoch=9/50, avg_epoch_loss=0.18] 90%|█████████ | 1034/1143 [00:20<00:02, 51.70it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:22<00:00, 51.70it/s, epoch=9/50, avg_epoch_loss=0.18] 
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 516/1143 [00:10<00:12, 51.58it/s, epoch=10/50, avg_epoch_loss=0.178] 90%|█████████ | 1034/1143 [00:20<00:02, 51.65it/s, epoch=10/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 51.77it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▋     | 529/1143 [00:10<00:11, 52.85it/s, epoch=11/50, avg_epoch_loss=0.179] 93%|█████████▎| 1058/1143 [00:20<00:01, 51.83it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:21<00:00, 52.08it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 524/1143 [00:10<00:11, 52.33it/s, epoch=12/50, avg_epoch_loss=0.178] 92%|█████████▏| 1049/1143 [00:20<00:01, 52.40it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.48it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 528/1143 [00:10<00:11, 52.77it/s, epoch=13/50, avg_epoch_loss=0.178] 92%|█████████▏| 1056/1143 [00:20<00:01, 52.50it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.53it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 514/1143 [00:10<00:12, 51.35it/s, epoch=14/50, avg_epoch_loss=0.178] 91%|█████████▏| 1044/1143 [00:20<00:01, 52.27it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.21it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 525/1143 [00:10<00:11, 52.47it/s, epoch=15/50, avg_epoch_loss=0.178] 92%|█████████▏| 1050/1143 [00:20<00:01, 52.19it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.34it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 518/1143 [00:10<00:12, 51.70it/s, epoch=16/50, avg_epoch_loss=0.178] 91%|█████████▏| 1045/1143 [00:20<00:01, 52.24it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.20it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 520/1143 [00:10<00:11, 51.97it/s, epoch=17/50, avg_epoch_loss=0.179] 91%|█████████▏| 1044/1143 [00:20<00:01, 52.21it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.16it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 522/1143 [00:10<00:11, 52.11it/s, epoch=18/50, avg_epoch_loss=0.178] 91%|█████████▏| 1044/1143 [00:20<00:01, 52.04it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.09it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 526/1143 [00:10<00:11, 52.58it/s, epoch=19/50, avg_epoch_loss=0.178] 92%|█████████▏| 1052/1143 [00:20<00:01, 52.29it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.37it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 525/1143 [00:10<00:11, 52.44it/s, epoch=20/50, avg_epoch_loss=0.179] 92%|█████████▏| 1052/1143 [00:20<00:01, 52.56it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.58it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 521/1143 [00:10<00:11, 52.03it/s, epoch=21/50, avg_epoch_loss=0.177] 91%|█████████ | 1042/1143 [00:20<00:01, 50.94it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 50.73it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 513/1143 [00:10<00:12, 51.29it/s, epoch=22/50, avg_epoch_loss=0.179] 90%|█████████ | 1029/1143 [00:20<00:02, 51.47it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 51.49it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 514/1143 [00:10<00:12, 51.37it/s, epoch=23/50, avg_epoch_loss=0.177] 90%|████████▉ | 1028/1143 [00:20<00:02, 51.36it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 51.28it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 502/1143 [00:10<00:12, 50.18it/s, epoch=24/50, avg_epoch_loss=0.179] 88%|████████▊ | 1007/1143 [00:20<00:02, 50.33it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 50.62it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 525/1143 [00:10<00:11, 52.47it/s, epoch=25/50, avg_epoch_loss=0.177] 92%|█████████▏| 1050/1143 [00:20<00:01, 51.72it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 51.75it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 510/1143 [00:10<00:12, 50.98it/s, epoch=26/50, avg_epoch_loss=0.177] 90%|████████▉ | 1025/1143 [00:20<00:02, 51.29it/s, epoch=26/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 51.22it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 511/1143 [00:10<00:12, 51.06it/s, epoch=27/50, avg_epoch_loss=0.177] 91%|█████████ | 1039/1143 [00:20<00:01, 52.05it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.02it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 524/1143 [00:10<00:11, 52.34it/s, epoch=28/50, avg_epoch_loss=0.178] 92%|█████████▏| 1052/1143 [00:20<00:01, 52.60it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.59it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 515/1143 [00:10<00:12, 51.44it/s, epoch=29/50, avg_epoch_loss=0.178] 91%|█████████ | 1038/1143 [00:20<00:02, 51.94it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 51.99it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 523/1143 [00:10<00:11, 52.24it/s, epoch=30/50, avg_epoch_loss=0.178] 92%|█████████▏| 1051/1143 [00:20<00:01, 52.55it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.51it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 517/1143 [00:10<00:12, 51.68it/s, epoch=31/50, avg_epoch_loss=0.178] 90%|█████████ | 1034/1143 [00:20<00:02, 51.59it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 51.64it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 522/1143 [00:10<00:11, 52.17it/s, epoch=32/50, avg_epoch_loss=0.178] 92%|█████████▏| 1046/1143 [00:20<00:01, 52.26it/s, epoch=32/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 52.27it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 46%|████▌     | 527/1143 [00:10<00:11, 52.67it/s, epoch=33/50, avg_epoch_loss=0.178] 92%|█████████▏| 1054/1143 [00:20<00:01, 52.28it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:21<00:00, 52.31it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 520/1143 [00:10<00:11, 51.95it/s, epoch=34/50, avg_epoch_loss=0.177] 91%|█████████ | 1040/1143 [00:20<00:02, 50.85it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 51.01it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 503/1143 [00:10<00:12, 50.26it/s, epoch=35/50, avg_epoch_loss=0.178] 89%|████████▉ | 1017/1143 [00:20<00:02, 50.92it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 50.91it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 511/1143 [00:10<00:12, 51.05it/s, epoch=36/50, avg_epoch_loss=0.176] 89%|████████▉ | 1022/1143 [00:20<00:02, 51.08it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 51.12it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 517/1143 [00:10<00:12, 51.64it/s, epoch=37/50, avg_epoch_loss=0.177] 91%|█████████ | 1039/1143 [00:20<00:02, 51.95it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:21<00:00, 51.96it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 519/1143 [00:10<00:12, 51.84it/s, epoch=38/50, avg_epoch_loss=0.177] 91%|█████████ | 1038/1143 [00:20<00:02, 51.28it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 51.35it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 513/1143 [00:10<00:12, 51.22it/s, epoch=39/50, avg_epoch_loss=0.178] 90%|█████████ | 1029/1143 [00:20<00:02, 51.43it/s, epoch=39/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 51.48it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 507/1143 [00:10<00:12, 50.60it/s, epoch=40/50, avg_epoch_loss=0.177] 89%|████████▊ | 1013/1143 [00:20<00:02, 50.28it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 50.37it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 508/1143 [00:10<00:12, 50.72it/s, epoch=41/50, avg_epoch_loss=0.177] 89%|████████▉ | 1019/1143 [00:20<00:02, 50.91it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 50.70it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 511/1143 [00:10<00:12, 51.03it/s, epoch=42/50, avg_epoch_loss=0.177] 89%|████████▉ | 1022/1143 [00:20<00:02, 50.35it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 50.44it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 508/1143 [00:10<00:12, 50.76it/s, epoch=43/50, avg_epoch_loss=0.177] 89%|████████▉ | 1019/1143 [00:20<00:02, 50.93it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 50.95it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 506/1143 [00:10<00:12, 50.51it/s, epoch=44/50, avg_epoch_loss=0.178] 89%|████████▊ | 1012/1143 [00:20<00:02, 50.12it/s, epoch=44/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 49.89it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 503/1143 [00:10<00:12, 50.26it/s, epoch=45/50, avg_epoch_loss=0.176] 88%|████████▊ | 1007/1143 [00:20<00:02, 50.31it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 50.42it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 502/1143 [00:10<00:12, 50.18it/s, epoch=46/50, avg_epoch_loss=0.177] 89%|████████▊ | 1012/1143 [00:20<00:02, 50.64it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 50.51it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▎     | 498/1143 [00:10<00:12, 49.77it/s, epoch=47/50, avg_epoch_loss=0.177] 87%|████████▋ | 996/1143 [00:20<00:02, 49.66it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 49.82it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 510/1143 [00:10<00:12, 50.92it/s, epoch=48/50, avg_epoch_loss=0.177] 89%|████████▉ | 1020/1143 [00:20<00:02, 50.84it/s, epoch=48/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 50.84it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 516/1143 [00:10<00:12, 51.51it/s, epoch=49/50, avg_epoch_loss=0.176] 90%|█████████ | 1032/1143 [00:20<00:02, 51.11it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 51.24it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▌     | 517/1143 [00:10<00:12, 51.70it/s, epoch=50/50, avg_epoch_loss=0.176] 91%|█████████ | 1038/1143 [00:20<00:02, 51.90it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 51.94it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 86.2507188487798 seconds
Parameter local_layers with value 2 had evaluation 2.2560286413613193
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 45, 'local_layers': 3, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1108.3524581100792 seconds
Creating forecasts took 179.75693840906024 seconds
 Start rescaling
Rescaling took 398.97564847022295 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 486/1143 [00:10<00:13, 48.59it/s, epoch=1/50, avg_epoch_loss=0.235] 86%|████████▌ | 982/1143 [00:20<00:03, 49.17it/s, epoch=1/50, avg_epoch_loss=0.209]100%|██████████| 1143/1143 [00:23<00:00, 49.18it/s, epoch=1/50, avg_epoch_loss=0.205]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 503/1143 [00:10<00:12, 50.28it/s, epoch=2/50, avg_epoch_loss=0.183] 88%|████████▊ | 1006/1143 [00:20<00:02, 49.98it/s, epoch=2/50, avg_epoch_loss=0.183]100%|██████████| 1143/1143 [00:22<00:00, 50.02it/s, epoch=2/50, avg_epoch_loss=0.183]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 492/1143 [00:10<00:13, 49.12it/s, epoch=3/50, avg_epoch_loss=0.18] 86%|████████▌ | 984/1143 [00:20<00:03, 49.15it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:23<00:00, 49.17it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 502/1143 [00:10<00:12, 50.11it/s, epoch=4/50, avg_epoch_loss=0.181] 88%|████████▊ | 1004/1143 [00:20<00:02, 49.42it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:23<00:00, 49.52it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 486/1143 [00:10<00:13, 48.57it/s, epoch=5/50, avg_epoch_loss=0.18] 85%|████████▌ | 975/1143 [00:20<00:03, 48.74it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:23<00:00, 48.68it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 494/1143 [00:10<00:13, 49.31it/s, epoch=6/50, avg_epoch_loss=0.179] 86%|████████▋ | 988/1143 [00:20<00:03, 47.75it/s, epoch=6/50, avg_epoch_loss=0.18] 100%|██████████| 1143/1143 [00:23<00:00, 47.79it/s, epoch=6/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████▏     | 473/1143 [00:10<00:14, 47.24it/s, epoch=7/50, avg_epoch_loss=0.18] 83%|████████▎ | 949/1143 [00:20<00:04, 47.41it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:24<00:00, 47.55it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 481/1143 [00:10<00:13, 48.02it/s, epoch=8/50, avg_epoch_loss=0.18] 84%|████████▍ | 965/1143 [00:20<00:03, 48.24it/s, epoch=8/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:23<00:00, 48.27it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 479/1143 [00:10<00:13, 47.81it/s, epoch=9/50, avg_epoch_loss=0.179] 85%|████████▌ | 976/1143 [00:20<00:03, 48.88it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:23<00:00, 48.62it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 486/1143 [00:10<00:13, 48.60it/s, epoch=10/50, avg_epoch_loss=0.178] 85%|████████▌ | 972/1143 [00:20<00:03, 48.26it/s, epoch=10/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.33it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 488/1143 [00:10<00:13, 48.77it/s, epoch=11/50, avg_epoch_loss=0.179] 85%|████████▌ | 976/1143 [00:20<00:03, 48.22it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:23<00:00, 48.45it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 488/1143 [00:10<00:13, 48.79it/s, epoch=12/50, avg_epoch_loss=0.178] 85%|████████▌ | 976/1143 [00:20<00:03, 48.62it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.69it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 493/1143 [00:10<00:13, 49.26it/s, epoch=13/50, avg_epoch_loss=0.178] 87%|████████▋ | 997/1143 [00:20<00:02, 49.92it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 49.93it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 45%|████▍     | 509/1143 [00:10<00:12, 50.83it/s, epoch=14/50, avg_epoch_loss=0.178] 89%|████████▉ | 1018/1143 [00:20<00:02, 50.02it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 49.97it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 493/1143 [00:10<00:13, 49.30it/s, epoch=15/50, avg_epoch_loss=0.178] 87%|████████▋ | 994/1143 [00:20<00:02, 49.74it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 49.81it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 502/1143 [00:10<00:12, 50.20it/s, epoch=16/50, avg_epoch_loss=0.178] 88%|████████▊ | 1004/1143 [00:20<00:02, 49.74it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 49.93it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▎     | 498/1143 [00:10<00:12, 49.73it/s, epoch=17/50, avg_epoch_loss=0.178] 87%|████████▋ | 999/1143 [00:20<00:02, 49.91it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 49.87it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 497/1143 [00:10<00:13, 49.65it/s, epoch=18/50, avg_epoch_loss=0.178] 87%|████████▋ | 996/1143 [00:20<00:02, 49.76it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 49.70it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▎     | 500/1143 [00:10<00:12, 49.94it/s, epoch=19/50, avg_epoch_loss=0.178] 88%|████████▊ | 1003/1143 [00:20<00:02, 50.10it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 50.13it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 506/1143 [00:10<00:12, 50.54it/s, epoch=20/50, avg_epoch_loss=0.179] 89%|████████▊ | 1012/1143 [00:20<00:02, 50.38it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 50.40it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 508/1143 [00:10<00:12, 50.77it/s, epoch=21/50, avg_epoch_loss=0.178] 89%|████████▉ | 1016/1143 [00:20<00:02, 49.63it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 49.60it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▎     | 499/1143 [00:10<00:12, 49.87it/s, epoch=22/50, avg_epoch_loss=0.178] 88%|████████▊ | 1004/1143 [00:20<00:02, 50.21it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 50.00it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▎     | 499/1143 [00:10<00:12, 49.80it/s, epoch=23/50, avg_epoch_loss=0.177] 87%|████████▋ | 997/1143 [00:20<00:02, 49.78it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 49.90it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▎     | 498/1143 [00:10<00:12, 49.79it/s, epoch=24/50, avg_epoch_loss=0.178] 87%|████████▋ | 996/1143 [00:20<00:02, 49.79it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 49.71it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▎     | 500/1143 [00:10<00:12, 49.91it/s, epoch=25/50, avg_epoch_loss=0.177] 87%|████████▋ | 1000/1143 [00:20<00:02, 49.89it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 49.89it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 494/1143 [00:10<00:13, 49.32it/s, epoch=26/50, avg_epoch_loss=0.178] 87%|████████▋ | 994/1143 [00:20<00:03, 49.66it/s, epoch=26/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 49.63it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 501/1143 [00:10<00:12, 50.06it/s, epoch=27/50, avg_epoch_loss=0.176] 44%|████▍     | 501/1143 [00:20<00:12, 50.06it/s, epoch=27/50, avg_epoch_loss=0.177] 87%|████████▋ | 998/1143 [00:20<00:02, 49.84it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 49.90it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 494/1143 [00:10<00:13, 49.34it/s, epoch=28/50, avg_epoch_loss=0.178] 86%|████████▋ | 988/1143 [00:20<00:03, 49.30it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 49.44it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 495/1143 [00:10<00:13, 49.46it/s, epoch=29/50, avg_epoch_loss=0.178] 87%|████████▋ | 994/1143 [00:20<00:02, 49.71it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 49.68it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 479/1143 [00:10<00:13, 47.88it/s, epoch=30/50, avg_epoch_loss=0.178] 84%|████████▍ | 964/1143 [00:20<00:03, 48.19it/s, epoch=30/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 48.09it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 484/1143 [00:10<00:13, 48.37it/s, epoch=31/50, avg_epoch_loss=0.178] 86%|████████▌ | 979/1143 [00:20<00:03, 49.00it/s, epoch=31/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 49.12it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▎     | 498/1143 [00:10<00:12, 49.73it/s, epoch=32/50, avg_epoch_loss=0.179] 87%|████████▋ | 996/1143 [00:20<00:02, 49.39it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 49.56it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 502/1143 [00:10<00:12, 50.13it/s, epoch=33/50, avg_epoch_loss=0.178] 88%|████████▊ | 1004/1143 [00:20<00:02, 49.89it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:22<00:00, 49.85it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 495/1143 [00:10<00:13, 49.43it/s, epoch=34/50, avg_epoch_loss=0.176] 87%|████████▋ | 990/1143 [00:20<00:03, 48.86it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 48.74it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 484/1143 [00:10<00:13, 48.32it/s, epoch=35/50, avg_epoch_loss=0.178] 85%|████████▌ | 975/1143 [00:20<00:03, 48.74it/s, epoch=35/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 48.79it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▍     | 502/1143 [00:10<00:12, 50.16it/s, epoch=36/50, avg_epoch_loss=0.176] 88%|████████▊ | 1004/1143 [00:20<00:02, 49.76it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 49.73it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 497/1143 [00:10<00:13, 49.62it/s, epoch=37/50, avg_epoch_loss=0.176] 87%|████████▋ | 994/1143 [00:20<00:03, 49.47it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 49.52it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 494/1143 [00:10<00:13, 49.36it/s, epoch=38/50, avg_epoch_loss=0.177] 86%|████████▋ | 988/1143 [00:20<00:03, 49.15it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 49.18it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 496/1143 [00:10<00:13, 49.58it/s, epoch=39/50, avg_epoch_loss=0.177] 87%|████████▋ | 992/1143 [00:20<00:03, 48.87it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 49.15it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▎     | 500/1143 [00:10<00:12, 49.92it/s, epoch=40/50, avg_epoch_loss=0.176] 87%|████████▋ | 1000/1143 [00:20<00:02, 49.15it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 49.31it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 493/1143 [00:10<00:13, 49.24it/s, epoch=41/50, avg_epoch_loss=0.177] 86%|████████▋ | 986/1143 [00:20<00:03, 48.97it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 49.13it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 487/1143 [00:10<00:13, 48.67it/s, epoch=42/50, avg_epoch_loss=0.177] 86%|████████▌ | 982/1143 [00:20<00:03, 49.12it/s, epoch=42/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 49.20it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 490/1143 [00:10<00:13, 48.95it/s, epoch=43/50, avg_epoch_loss=0.178] 86%|████████▋ | 987/1143 [00:20<00:03, 49.35it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 49.27it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▎     | 498/1143 [00:10<00:12, 49.77it/s, epoch=44/50, avg_epoch_loss=0.177] 87%|████████▋ | 996/1143 [00:20<00:02, 49.58it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 49.70it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 491/1143 [00:10<00:13, 49.08it/s, epoch=45/50, avg_epoch_loss=0.176] 86%|████████▌ | 982/1143 [00:20<00:03, 48.91it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 49.10it/s, epoch=45/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▎     | 498/1143 [00:10<00:12, 49.77it/s, epoch=46/50, avg_epoch_loss=0.177] 87%|████████▋ | 998/1143 [00:20<00:02, 49.88it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 49.76it/s, epoch=46/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▎     | 498/1143 [00:10<00:12, 49.71it/s, epoch=47/50, avg_epoch_loss=0.177] 87%|████████▋ | 998/1143 [00:20<00:02, 49.83it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 49.85it/s, epoch=47/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 44%|████▎     | 499/1143 [00:10<00:12, 49.84it/s, epoch=48/50, avg_epoch_loss=0.177] 88%|████████▊ | 1001/1143 [00:20<00:02, 50.05it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:22<00:00, 49.90it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 495/1143 [00:10<00:13, 49.41it/s, epoch=49/50, avg_epoch_loss=0.176] 87%|████████▋ | 990/1143 [00:20<00:03, 48.91it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 48.85it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 490/1143 [00:10<00:13, 48.94it/s, epoch=50/50, avg_epoch_loss=0.176] 86%|████████▌ | 984/1143 [00:20<00:03, 49.19it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 49.17it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 86.26616692356765 seconds
Parameter local_layers with value 3 had evaluation 2.1890780171965987
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 45, 'local_layers': 4, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1159.1275609005243 seconds
Creating forecasts took 184.80511895008385 seconds
 Start rescaling
Rescaling took 399.1673506833613 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|███▉      | 455/1143 [00:10<00:15, 45.41it/s, epoch=1/50, avg_epoch_loss=0.242] 81%|████████▏ | 929/1143 [00:20<00:04, 46.56it/s, epoch=1/50, avg_epoch_loss=0.212]100%|██████████| 1143/1143 [00:24<00:00, 46.65it/s, epoch=1/50, avg_epoch_loss=0.207]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 467/1143 [00:10<00:14, 46.62it/s, epoch=2/50, avg_epoch_loss=0.183] 83%|████████▎ | 944/1143 [00:20<00:04, 47.23it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:24<00:00, 47.17it/s, epoch=2/50, avg_epoch_loss=0.182]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 476/1143 [00:10<00:14, 47.59it/s, epoch=3/50, avg_epoch_loss=0.182] 83%|████████▎ | 952/1143 [00:20<00:04, 47.57it/s, epoch=3/50, avg_epoch_loss=0.181]100%|██████████| 1143/1143 [00:23<00:00, 47.78it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 483/1143 [00:10<00:13, 48.27it/s, epoch=4/50, avg_epoch_loss=0.18] 85%|████████▍ | 966/1143 [00:20<00:03, 48.16it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:23<00:00, 47.97it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 482/1143 [00:10<00:13, 48.13it/s, epoch=5/50, avg_epoch_loss=0.179] 85%|████████▍ | 969/1143 [00:20<00:03, 48.42it/s, epoch=5/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:23<00:00, 48.27it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 465/1143 [00:10<00:14, 46.46it/s, epoch=6/50, avg_epoch_loss=0.18] 82%|████████▏ | 941/1143 [00:20<00:04, 47.11it/s, epoch=6/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:24<00:00, 47.08it/s, epoch=6/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|███▉      | 456/1143 [00:10<00:15, 45.51it/s, epoch=7/50, avg_epoch_loss=0.18] 81%|████████  | 925/1143 [00:20<00:04, 46.29it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:24<00:00, 46.59it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 482/1143 [00:10<00:13, 48.16it/s, epoch=8/50, avg_epoch_loss=0.179] 85%|████████▌ | 973/1143 [00:20<00:03, 48.69it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:23<00:00, 48.69it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 489/1143 [00:10<00:13, 48.82it/s, epoch=9/50, avg_epoch_loss=0.179] 86%|████████▌ | 978/1143 [00:20<00:03, 48.57it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:23<00:00, 48.52it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 488/1143 [00:10<00:13, 48.74it/s, epoch=10/50, avg_epoch_loss=0.179] 85%|████████▌ | 976/1143 [00:20<00:03, 48.52it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:23<00:00, 48.42it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 489/1143 [00:10<00:13, 48.83it/s, epoch=11/50, avg_epoch_loss=0.179] 86%|████████▌ | 978/1143 [00:20<00:03, 48.64it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:23<00:00, 48.62it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 469/1143 [00:10<00:14, 46.83it/s, epoch=12/50, avg_epoch_loss=0.178] 82%|████████▏ | 938/1143 [00:20<00:04, 45.11it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 45.54it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 465/1143 [00:10<00:14, 46.42it/s, epoch=13/50, avg_epoch_loss=0.178] 82%|████████▏ | 941/1143 [00:20<00:04, 47.07it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:24<00:00, 46.80it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 461/1143 [00:10<00:14, 46.03it/s, epoch=14/50, avg_epoch_loss=0.177] 81%|████████  | 923/1143 [00:20<00:04, 46.08it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:24<00:00, 46.09it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 465/1143 [00:10<00:14, 46.49it/s, epoch=15/50, avg_epoch_loss=0.178] 81%|████████▏ | 930/1143 [00:20<00:04, 46.18it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:24<00:00, 46.58it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████▏     | 473/1143 [00:10<00:14, 47.21it/s, epoch=16/50, avg_epoch_loss=0.178] 83%|████████▎ | 946/1143 [00:20<00:04, 46.91it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 47.13it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████▏     | 472/1143 [00:10<00:14, 47.19it/s, epoch=17/50, avg_epoch_loss=0.179] 83%|████████▎ | 946/1143 [00:20<00:04, 47.31it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 47.35it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 475/1143 [00:10<00:14, 47.40it/s, epoch=18/50, avg_epoch_loss=0.178] 83%|████████▎ | 950/1143 [00:20<00:04, 47.45it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 47.51it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 476/1143 [00:10<00:14, 47.51it/s, epoch=19/50, avg_epoch_loss=0.178] 84%|████████▎ | 956/1143 [00:20<00:03, 47.75it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 47.69it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████▏     | 472/1143 [00:10<00:14, 47.18it/s, epoch=20/50, avg_epoch_loss=0.178] 83%|████████▎ | 944/1143 [00:20<00:04, 46.78it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 46.67it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 475/1143 [00:10<00:14, 47.42it/s, epoch=21/50, avg_epoch_loss=0.177] 83%|████████▎ | 950/1143 [00:20<00:04, 47.16it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 47.18it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 468/1143 [00:10<00:14, 46.76it/s, epoch=22/50, avg_epoch_loss=0.178] 82%|████████▏ | 938/1143 [00:20<00:04, 46.88it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 46.74it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 481/1143 [00:10<00:13, 48.09it/s, epoch=23/50, avg_epoch_loss=0.177] 85%|████████▍ | 967/1143 [00:20<00:03, 48.35it/s, epoch=23/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.29it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████▏     | 473/1143 [00:10<00:14, 47.23it/s, epoch=24/50, avg_epoch_loss=0.178] 83%|████████▎ | 946/1143 [00:20<00:04, 46.52it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 46.56it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 470/1143 [00:10<00:14, 46.97it/s, epoch=25/50, avg_epoch_loss=0.177] 82%|████████▏ | 942/1143 [00:20<00:04, 47.05it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 47.20it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████▏     | 474/1143 [00:10<00:14, 47.31it/s, epoch=26/50, avg_epoch_loss=0.177] 83%|████████▎ | 948/1143 [00:20<00:04, 47.24it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 47.45it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 484/1143 [00:10<00:13, 48.31it/s, epoch=27/50, avg_epoch_loss=0.177] 85%|████████▌ | 974/1143 [00:20<00:03, 48.67it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.47it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 483/1143 [00:10<00:13, 48.27it/s, epoch=28/50, avg_epoch_loss=0.178] 85%|████████▍ | 969/1143 [00:20<00:03, 48.42it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.58it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 481/1143 [00:10<00:13, 48.07it/s, epoch=29/50, avg_epoch_loss=0.177] 84%|████████▍ | 962/1143 [00:20<00:03, 47.40it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 47.72it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 486/1143 [00:10<00:13, 48.59it/s, epoch=30/50, avg_epoch_loss=0.178] 85%|████████▌ | 972/1143 [00:20<00:03, 48.42it/s, epoch=30/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 48.56it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 486/1143 [00:10<00:13, 48.54it/s, epoch=31/50, avg_epoch_loss=0.178] 85%|████████▌ | 972/1143 [00:20<00:03, 48.36it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.39it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 486/1143 [00:10<00:13, 48.58it/s, epoch=32/50, avg_epoch_loss=0.178] 85%|████████▌ | 972/1143 [00:20<00:03, 48.31it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.33it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 491/1143 [00:10<00:13, 49.08it/s, epoch=33/50, avg_epoch_loss=0.178] 86%|████████▌ | 982/1143 [00:20<00:03, 48.94it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 49.04it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 484/1143 [00:10<00:13, 48.35it/s, epoch=34/50, avg_epoch_loss=0.177] 85%|████████▍ | 968/1143 [00:20<00:03, 47.63it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 47.73it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 477/1143 [00:10<00:13, 47.64it/s, epoch=35/50, avg_epoch_loss=0.177] 85%|████████▍ | 966/1143 [00:20<00:03, 48.35it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.36it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 477/1143 [00:10<00:13, 47.64it/s, epoch=36/50, avg_epoch_loss=0.177] 83%|████████▎ | 954/1143 [00:20<00:04, 47.22it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 47.22it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 480/1143 [00:10<00:13, 47.90it/s, epoch=37/50, avg_epoch_loss=0.177] 84%|████████▍ | 959/1143 [00:20<00:03, 47.71it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 47.78it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 480/1143 [00:10<00:13, 47.97it/s, epoch=38/50, avg_epoch_loss=0.176] 84%|████████▍ | 960/1143 [00:20<00:03, 47.57it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 47.95it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 485/1143 [00:10<00:13, 48.49it/s, epoch=39/50, avg_epoch_loss=0.177] 85%|████████▍ | 970/1143 [00:20<00:03, 47.89it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 47.79it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 468/1143 [00:10<00:14, 46.77it/s, epoch=40/50, avg_epoch_loss=0.177] 83%|████████▎ | 948/1143 [00:20<00:04, 47.45it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 47.33it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 479/1143 [00:10<00:13, 47.88it/s, epoch=41/50, avg_epoch_loss=0.178] 84%|████████▍ | 965/1143 [00:20<00:03, 48.27it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 48.32it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 486/1143 [00:10<00:13, 48.60it/s, epoch=42/50, avg_epoch_loss=0.178] 86%|████████▌ | 978/1143 [00:20<00:03, 48.94it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 48.86it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 488/1143 [00:10<00:13, 48.74it/s, epoch=43/50, avg_epoch_loss=0.177] 85%|████████▌ | 976/1143 [00:20<00:03, 48.63it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.72it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 487/1143 [00:10<00:13, 48.66it/s, epoch=44/50, avg_epoch_loss=0.178] 86%|████████▌ | 978/1143 [00:20<00:03, 48.87it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 48.80it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 488/1143 [00:10<00:13, 48.75it/s, epoch=45/50, avg_epoch_loss=0.177] 86%|████████▌ | 980/1143 [00:20<00:03, 48.96it/s, epoch=45/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:23<00:00, 49.02it/s, epoch=45/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 496/1143 [00:10<00:13, 49.50it/s, epoch=46/50, avg_epoch_loss=0.177] 87%|████████▋ | 993/1143 [00:20<00:03, 49.58it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 49.30it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 491/1143 [00:10<00:13, 49.05it/s, epoch=47/50, avg_epoch_loss=0.176] 86%|████████▌ | 982/1143 [00:20<00:03, 48.91it/s, epoch=47/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:23<00:00, 48.88it/s, epoch=47/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 497/1143 [00:10<00:13, 49.62it/s, epoch=48/50, avg_epoch_loss=0.177] 87%|████████▋ | 994/1143 [00:20<00:03, 49.04it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 49.03it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████▏     | 474/1143 [00:10<00:14, 47.33it/s, epoch=49/50, avg_epoch_loss=0.176] 84%|████████▍ | 964/1143 [00:20<00:03, 48.29it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 48.28it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 487/1143 [00:10<00:13, 48.61it/s, epoch=50/50, avg_epoch_loss=0.177] 43%|████▎     | 487/1143 [00:20<00:13, 48.61it/s, epoch=50/50, avg_epoch_loss=0.177] 84%|████████▍ | 965/1143 [00:20<00:03, 47.49it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 47.87it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 87.16303630732 seconds
Parameter local_layers with value 4 had evaluation 2.1766360781036562
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 45, 'local_layers': 5, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1196.1287856288254 seconds
Creating forecasts took 186.23604533448815 seconds
 Start rescaling
Rescaling took 398.3756005335599 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 480/1143 [00:10<00:13, 47.90it/s, epoch=1/50, avg_epoch_loss=0.234] 84%|████████▍ | 960/1143 [00:20<00:03, 47.68it/s, epoch=1/50, avg_epoch_loss=0.209]100%|██████████| 1143/1143 [00:23<00:00, 47.82it/s, epoch=1/50, avg_epoch_loss=0.205]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████▏     | 474/1143 [00:10<00:14, 47.36it/s, epoch=2/50, avg_epoch_loss=0.182] 84%|████████▎ | 957/1143 [00:20<00:03, 47.88it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:23<00:00, 47.90it/s, epoch=2/50, avg_epoch_loss=0.182]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 481/1143 [00:10<00:13, 48.01it/s, epoch=3/50, avg_epoch_loss=0.179] 84%|████████▍ | 962/1143 [00:20<00:03, 48.05it/s, epoch=3/50, avg_epoch_loss=0.18] 100%|██████████| 1143/1143 [00:23<00:00, 47.68it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 465/1143 [00:10<00:14, 46.50it/s, epoch=4/50, avg_epoch_loss=0.179] 81%|████████▏ | 930/1143 [00:20<00:04, 46.29it/s, epoch=4/50, avg_epoch_loss=0.18] 100%|██████████| 1143/1143 [00:24<00:00, 46.35it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 467/1143 [00:10<00:14, 46.61it/s, epoch=5/50, avg_epoch_loss=0.179] 82%|████████▏ | 934/1143 [00:20<00:04, 46.64it/s, epoch=5/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:24<00:00, 46.74it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 463/1143 [00:10<00:14, 46.25it/s, epoch=6/50, avg_epoch_loss=0.179] 81%|████████▏ | 930/1143 [00:20<00:04, 46.46it/s, epoch=6/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:24<00:00, 46.44it/s, epoch=6/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████▏     | 472/1143 [00:10<00:14, 47.10it/s, epoch=7/50, avg_epoch_loss=0.179] 83%|████████▎ | 945/1143 [00:20<00:04, 47.17it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:24<00:00, 47.02it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 475/1143 [00:10<00:14, 47.43it/s, epoch=8/50, avg_epoch_loss=0.179] 83%|████████▎ | 951/1143 [00:20<00:04, 47.50it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:24<00:00, 47.42it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████▏     | 472/1143 [00:10<00:14, 47.20it/s, epoch=9/50, avg_epoch_loss=0.18] 83%|████████▎ | 944/1143 [00:20<00:04, 46.86it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:24<00:00, 47.09it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 468/1143 [00:10<00:14, 46.77it/s, epoch=10/50, avg_epoch_loss=0.179] 82%|████████▏ | 936/1143 [00:20<00:04, 46.20it/s, epoch=10/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 46.63it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 485/1143 [00:10<00:13, 48.44it/s, epoch=11/50, avg_epoch_loss=0.18] 85%|████████▍ | 970/1143 [00:20<00:03, 47.79it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:23<00:00, 48.03it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████▏     | 473/1143 [00:10<00:14, 47.28it/s, epoch=12/50, avg_epoch_loss=0.178] 83%|████████▎ | 947/1143 [00:20<00:04, 47.34it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 47.18it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 470/1143 [00:10<00:14, 46.99it/s, epoch=13/50, avg_epoch_loss=0.178] 82%|████████▏ | 941/1143 [00:20<00:04, 47.05it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:24<00:00, 47.20it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████▏     | 473/1143 [00:10<00:14, 47.28it/s, epoch=14/50, avg_epoch_loss=0.178] 84%|████████▎ | 955/1143 [00:20<00:03, 47.79it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 47.75it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 484/1143 [00:10<00:13, 48.31it/s, epoch=15/50, avg_epoch_loss=0.178] 85%|████████▍ | 969/1143 [00:20<00:03, 48.39it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.43it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 488/1143 [00:10<00:13, 48.71it/s, epoch=16/50, avg_epoch_loss=0.178] 85%|████████▌ | 976/1143 [00:20<00:03, 48.37it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.42it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 488/1143 [00:10<00:13, 48.74it/s, epoch=17/50, avg_epoch_loss=0.178] 85%|████████▌ | 976/1143 [00:20<00:03, 48.47it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.61it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 489/1143 [00:10<00:13, 48.84it/s, epoch=18/50, avg_epoch_loss=0.178] 86%|████████▌ | 978/1143 [00:20<00:03, 48.40it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.47it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 483/1143 [00:10<00:13, 48.30it/s, epoch=19/50, avg_epoch_loss=0.178] 85%|████████▍ | 969/1143 [00:20<00:03, 48.47it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.50it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 487/1143 [00:10<00:13, 48.63it/s, epoch=20/50, avg_epoch_loss=0.178] 85%|████████▌ | 974/1143 [00:20<00:03, 48.57it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.58it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 482/1143 [00:10<00:13, 48.15it/s, epoch=21/50, avg_epoch_loss=0.177] 84%|████████▍ | 964/1143 [00:20<00:03, 48.15it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 48.23it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 482/1143 [00:10<00:13, 48.15it/s, epoch=22/50, avg_epoch_loss=0.179] 84%|████████▍ | 964/1143 [00:20<00:03, 47.83it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 47.88it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 485/1143 [00:10<00:13, 48.40it/s, epoch=23/50, avg_epoch_loss=0.177] 85%|████████▍ | 970/1143 [00:20<00:03, 48.39it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 48.42it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 482/1143 [00:10<00:13, 48.12it/s, epoch=24/50, avg_epoch_loss=0.179] 84%|████████▍ | 964/1143 [00:20<00:03, 47.78it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 47.79it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 479/1143 [00:10<00:13, 47.89it/s, epoch=25/50, avg_epoch_loss=0.177] 84%|████████▍ | 958/1143 [00:20<00:03, 47.30it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 47.44it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 460/1143 [00:10<00:14, 45.91it/s, epoch=26/50, avg_epoch_loss=0.178] 80%|████████  | 920/1143 [00:20<00:04, 45.87it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 45.93it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 462/1143 [00:10<00:14, 46.14it/s, epoch=27/50, avg_epoch_loss=0.177] 82%|████████▏ | 932/1143 [00:20<00:04, 46.61it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 46.58it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 462/1143 [00:10<00:14, 46.14it/s, epoch=28/50, avg_epoch_loss=0.178] 82%|████████▏ | 936/1143 [00:20<00:04, 46.88it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 47.01it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████▏     | 474/1143 [00:10<00:14, 47.38it/s, epoch=29/50, avg_epoch_loss=0.178] 83%|████████▎ | 953/1143 [00:20<00:03, 47.66it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 47.60it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 466/1143 [00:10<00:14, 46.54it/s, epoch=30/50, avg_epoch_loss=0.178] 82%|████████▏ | 939/1143 [00:20<00:04, 46.96it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 47.04it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 471/1143 [00:10<00:14, 47.10it/s, epoch=31/50, avg_epoch_loss=0.177] 83%|████████▎ | 943/1143 [00:20<00:04, 47.12it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 47.22it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 480/1143 [00:10<00:13, 47.91it/s, epoch=32/50, avg_epoch_loss=0.178] 84%|████████▍ | 960/1143 [00:20<00:03, 47.39it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 47.37it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 477/1143 [00:10<00:13, 47.69it/s, epoch=33/50, avg_epoch_loss=0.178] 83%|████████▎ | 954/1143 [00:20<00:03, 47.26it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 47.33it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 470/1143 [00:10<00:14, 46.89it/s, epoch=34/50, avg_epoch_loss=0.177] 83%|████████▎ | 945/1143 [00:20<00:04, 47.22it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 47.23it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 479/1143 [00:10<00:13, 47.82it/s, epoch=35/50, avg_epoch_loss=0.178] 85%|████████▍ | 968/1143 [00:20<00:03, 48.40it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:23<00:00, 48.43it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 43%|████▎     | 489/1143 [00:10<00:13, 48.89it/s, epoch=36/50, avg_epoch_loss=0.177] 86%|████████▌ | 978/1143 [00:20<00:03, 48.75it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 48.77it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 485/1143 [00:10<00:13, 48.47it/s, epoch=37/50, avg_epoch_loss=0.177] 85%|████████▍ | 970/1143 [00:20<00:03, 47.95it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:23<00:00, 47.71it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|███▉      | 456/1143 [00:10<00:15, 45.59it/s, epoch=38/50, avg_epoch_loss=0.178] 82%|████████▏ | 932/1143 [00:20<00:04, 46.73it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 46.56it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 445/1143 [00:10<00:15, 44.47it/s, epoch=39/50, avg_epoch_loss=0.177] 80%|███████▉  | 911/1143 [00:20<00:05, 45.71it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 45.73it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 478/1143 [00:10<00:13, 47.79it/s, epoch=40/50, avg_epoch_loss=0.177] 84%|████████▎ | 956/1143 [00:20<00:03, 47.39it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 47.54it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 480/1143 [00:10<00:13, 47.92it/s, epoch=41/50, avg_epoch_loss=0.178] 84%|████████▍ | 960/1143 [00:20<00:03, 47.36it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 47.51it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 477/1143 [00:10<00:13, 47.70it/s, epoch=42/50, avg_epoch_loss=0.177] 83%|████████▎ | 954/1143 [00:20<00:03, 47.47it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 47.54it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████▏     | 473/1143 [00:10<00:14, 47.28it/s, epoch=43/50, avg_epoch_loss=0.177] 83%|████████▎ | 950/1143 [00:20<00:04, 47.51it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 47.47it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████▏     | 474/1143 [00:10<00:14, 47.33it/s, epoch=44/50, avg_epoch_loss=0.178] 83%|████████▎ | 948/1143 [00:20<00:04, 47.11it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 47.24it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 476/1143 [00:10<00:14, 47.57it/s, epoch=45/50, avg_epoch_loss=0.176] 83%|████████▎ | 952/1143 [00:20<00:04, 46.37it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 46.66it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 475/1143 [00:10<00:14, 47.42it/s, epoch=46/50, avg_epoch_loss=0.178] 83%|████████▎ | 950/1143 [00:20<00:04, 47.25it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 47.34it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 480/1143 [00:10<00:13, 47.94it/s, epoch=47/50, avg_epoch_loss=0.176] 84%|████████▍ | 960/1143 [00:20<00:03, 47.97it/s, epoch=47/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:23<00:00, 47.93it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 480/1143 [00:10<00:13, 47.96it/s, epoch=48/50, avg_epoch_loss=0.177] 84%|████████▍ | 960/1143 [00:20<00:03, 47.27it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 47.25it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 42%|████▏     | 476/1143 [00:10<00:14, 47.58it/s, epoch=49/50, avg_epoch_loss=0.177] 83%|████████▎ | 952/1143 [00:20<00:04, 46.46it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 46.64it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 462/1143 [00:10<00:14, 46.19it/s, epoch=50/50, avg_epoch_loss=0.177] 82%|████████▏ | 932/1143 [00:20<00:04, 46.64it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 46.51it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.83612780086696 seconds
Parameter local_layers with value 5 had evaluation 2.1943555458861597
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 45, 'local_layers': 6, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1205.3732535913587 seconds
Creating forecasts took 191.25023592822254 seconds
 Start rescaling
Rescaling took 397.3277551867068 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▊      | 441/1143 [00:10<00:15, 44.08it/s, epoch=1/50, avg_epoch_loss=0.239] 78%|███████▊  | 895/1143 [00:20<00:05, 44.83it/s, epoch=1/50, avg_epoch_loss=0.211]100%|██████████| 1143/1143 [00:25<00:00, 44.81it/s, epoch=1/50, avg_epoch_loss=0.205]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 449/1143 [00:10<00:15, 44.84it/s, epoch=2/50, avg_epoch_loss=0.182] 79%|███████▊  | 900/1143 [00:20<00:05, 44.95it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:25<00:00, 45.11it/s, epoch=2/50, avg_epoch_loss=0.182]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|███▉      | 456/1143 [00:10<00:15, 45.57it/s, epoch=3/50, avg_epoch_loss=0.18] 80%|███████▉  | 912/1143 [00:20<00:05, 45.55it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:25<00:00, 45.56it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 462/1143 [00:10<00:14, 46.16it/s, epoch=4/50, avg_epoch_loss=0.181] 81%|████████  | 924/1143 [00:20<00:04, 46.17it/s, epoch=4/50, avg_epoch_loss=0.18] 100%|██████████| 1143/1143 [00:24<00:00, 46.25it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 461/1143 [00:10<00:14, 46.00it/s, epoch=5/50, avg_epoch_loss=0.179] 81%|████████  | 922/1143 [00:20<00:04, 46.03it/s, epoch=5/50, avg_epoch_loss=0.18] 100%|██████████| 1143/1143 [00:24<00:00, 45.80it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 448/1143 [00:10<00:15, 44.78it/s, epoch=6/50, avg_epoch_loss=0.18] 78%|███████▊  | 896/1143 [00:20<00:05, 44.45it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:25<00:00, 44.49it/s, epoch=6/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 449/1143 [00:10<00:15, 44.84it/s, epoch=7/50, avg_epoch_loss=0.179] 79%|███████▉  | 902/1143 [00:20<00:05, 45.09it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:25<00:00, 45.09it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 449/1143 [00:10<00:15, 44.82it/s, epoch=8/50, avg_epoch_loss=0.18] 80%|███████▉  | 911/1143 [00:20<00:05, 45.57it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:25<00:00, 45.64it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 462/1143 [00:10<00:14, 46.18it/s, epoch=9/50, avg_epoch_loss=0.18] 81%|████████  | 924/1143 [00:20<00:04, 46.03it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:24<00:00, 45.94it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 463/1143 [00:10<00:14, 46.29it/s, epoch=10/50, avg_epoch_loss=0.177] 81%|████████  | 926/1143 [00:20<00:04, 46.08it/s, epoch=10/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:24<00:00, 46.02it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 461/1143 [00:10<00:14, 46.03it/s, epoch=11/50, avg_epoch_loss=0.18] 81%|████████  | 924/1143 [00:20<00:04, 46.15it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:24<00:00, 46.12it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 465/1143 [00:10<00:14, 46.42it/s, epoch=12/50, avg_epoch_loss=0.178] 81%|████████▏ | 930/1143 [00:20<00:04, 46.14it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 46.07it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 461/1143 [00:10<00:14, 46.05it/s, epoch=13/50, avg_epoch_loss=0.179] 81%|████████  | 922/1143 [00:20<00:04, 45.94it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 46.05it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 462/1143 [00:10<00:14, 46.14it/s, epoch=14/50, avg_epoch_loss=0.178] 81%|████████▏ | 929/1143 [00:20<00:04, 46.43it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 46.42it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 459/1143 [00:10<00:14, 45.86it/s, epoch=15/50, avg_epoch_loss=0.178] 80%|████████  | 918/1143 [00:20<00:04, 45.13it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 45.19it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|███▉      | 452/1143 [00:10<00:15, 45.13it/s, epoch=16/50, avg_epoch_loss=0.177] 79%|███████▉  | 904/1143 [00:20<00:05, 44.86it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.98it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 448/1143 [00:10<00:15, 44.78it/s, epoch=17/50, avg_epoch_loss=0.178] 78%|███████▊  | 896/1143 [00:20<00:05, 44.42it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.48it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 447/1143 [00:10<00:15, 44.70it/s, epoch=18/50, avg_epoch_loss=0.178] 78%|███████▊  | 897/1143 [00:20<00:05, 44.87it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 45.01it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 448/1143 [00:10<00:15, 44.76it/s, epoch=19/50, avg_epoch_loss=0.179] 79%|███████▉  | 905/1143 [00:20<00:05, 45.28it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 45.48it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 459/1143 [00:10<00:14, 45.86it/s, epoch=20/50, avg_epoch_loss=0.179] 80%|████████  | 919/1143 [00:20<00:04, 45.92it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 46.03it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 467/1143 [00:10<00:14, 46.61it/s, epoch=21/50, avg_epoch_loss=0.178] 82%|████████▏ | 934/1143 [00:20<00:04, 46.13it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 46.25it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 462/1143 [00:10<00:14, 46.12it/s, epoch=22/50, avg_epoch_loss=0.179] 81%|████████  | 924/1143 [00:20<00:04, 45.90it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 46.00it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 459/1143 [00:10<00:14, 45.81it/s, epoch=23/50, avg_epoch_loss=0.177] 80%|████████  | 918/1143 [00:20<00:04, 45.86it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 45.98it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 464/1143 [00:10<00:14, 46.35it/s, epoch=24/50, avg_epoch_loss=0.179] 81%|████████▏ | 929/1143 [00:20<00:04, 46.40it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 46.30it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 461/1143 [00:10<00:14, 46.01it/s, epoch=25/50, avg_epoch_loss=0.177] 81%|████████  | 922/1143 [00:20<00:04, 45.82it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 45.91it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 460/1143 [00:10<00:14, 45.95it/s, epoch=26/50, avg_epoch_loss=0.178] 81%|████████  | 924/1143 [00:20<00:04, 46.21it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 46.11it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 459/1143 [00:10<00:14, 45.83it/s, epoch=27/50, avg_epoch_loss=0.177] 80%|████████  | 918/1143 [00:20<00:04, 45.78it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 45.82it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 458/1143 [00:10<00:14, 45.79it/s, epoch=28/50, avg_epoch_loss=0.178] 80%|████████  | 916/1143 [00:20<00:05, 44.92it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.97it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 445/1143 [00:10<00:15, 44.43it/s, epoch=29/50, avg_epoch_loss=0.178] 78%|███████▊  | 890/1143 [00:20<00:05, 44.38it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.44it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 451/1143 [00:10<00:15, 45.07it/s, epoch=30/50, avg_epoch_loss=0.178] 79%|███████▉  | 902/1143 [00:20<00:05, 45.08it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 45.34it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 462/1143 [00:10<00:14, 46.10it/s, epoch=31/50, avg_epoch_loss=0.177] 81%|████████  | 924/1143 [00:20<00:04, 45.40it/s, epoch=31/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 45.68it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 460/1143 [00:10<00:14, 45.92it/s, epoch=32/50, avg_epoch_loss=0.178] 81%|████████  | 924/1143 [00:20<00:04, 46.15it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 46.16it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 41%|████      | 465/1143 [00:10<00:14, 46.42it/s, epoch=33/50, avg_epoch_loss=0.178] 81%|████████▏ | 930/1143 [00:20<00:04, 46.12it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:24<00:00, 46.08it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 460/1143 [00:10<00:14, 45.91it/s, epoch=34/50, avg_epoch_loss=0.177] 80%|████████  | 920/1143 [00:20<00:04, 45.74it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 45.78it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 462/1143 [00:10<00:14, 46.20it/s, epoch=35/50, avg_epoch_loss=0.179] 81%|████████  | 924/1143 [00:20<00:04, 45.95it/s, epoch=35/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:24<00:00, 45.75it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 447/1143 [00:10<00:15, 44.64it/s, epoch=36/50, avg_epoch_loss=0.177] 79%|███████▊  | 898/1143 [00:20<00:05, 44.88it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.93it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 451/1143 [00:10<00:15, 45.01it/s, epoch=37/50, avg_epoch_loss=0.178] 79%|███████▉  | 902/1143 [00:20<00:05, 44.67it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.74it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 438/1143 [00:10<00:16, 43.71it/s, epoch=38/50, avg_epoch_loss=0.177] 78%|███████▊  | 886/1143 [00:20<00:05, 44.34it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.31it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▊      | 441/1143 [00:10<00:15, 44.08it/s, epoch=39/50, avg_epoch_loss=0.178] 77%|███████▋  | 882/1143 [00:20<00:05, 43.84it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 43.85it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 439/1143 [00:10<00:16, 43.87it/s, epoch=40/50, avg_epoch_loss=0.176] 77%|███████▋  | 878/1143 [00:20<00:06, 43.78it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 43.76it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 440/1143 [00:10<00:15, 43.94it/s, epoch=41/50, avg_epoch_loss=0.178] 77%|███████▋  | 880/1143 [00:20<00:06, 43.65it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 43.75it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 443/1143 [00:10<00:15, 44.22it/s, epoch=42/50, avg_epoch_loss=0.178] 78%|███████▊  | 886/1143 [00:20<00:05, 44.19it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.12it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 447/1143 [00:10<00:15, 44.67it/s, epoch=43/50, avg_epoch_loss=0.177] 78%|███████▊  | 894/1143 [00:20<00:05, 44.38it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.67it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 446/1143 [00:10<00:15, 44.54it/s, epoch=44/50, avg_epoch_loss=0.178] 78%|███████▊  | 896/1143 [00:20<00:05, 44.77it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.84it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 447/1143 [00:10<00:15, 44.63it/s, epoch=45/50, avg_epoch_loss=0.177] 79%|███████▊  | 900/1143 [00:20<00:05, 45.01it/s, epoch=45/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:25<00:00, 44.80it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 437/1143 [00:10<00:16, 43.69it/s, epoch=46/50, avg_epoch_loss=0.177] 77%|███████▋  | 880/1143 [00:20<00:05, 44.04it/s, epoch=46/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.10it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|███▉      | 457/1143 [00:10<00:15, 45.66it/s, epoch=47/50, avg_epoch_loss=0.177] 80%|████████  | 918/1143 [00:20<00:04, 45.88it/s, epoch=47/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:24<00:00, 45.76it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 40%|████      | 461/1143 [00:10<00:14, 46.08it/s, epoch=48/50, avg_epoch_loss=0.178] 81%|████████  | 922/1143 [00:20<00:04, 45.01it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.98it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 449/1143 [00:10<00:15, 44.85it/s, epoch=49/50, avg_epoch_loss=0.176] 79%|███████▉  | 902/1143 [00:20<00:05, 45.11it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 45.18it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 450/1143 [00:10<00:15, 44.95it/s, epoch=50/50, avg_epoch_loss=0.178] 79%|███████▉  | 906/1143 [00:20<00:05, 45.31it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.93it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 84.90128811821342 seconds
Parameter local_layers with value 6 had evaluation 2.1863976280530677
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 45, 'local_layers': 7, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1262.0253164432943 seconds
Creating forecasts took 196.73849833011627 seconds
 Start rescaling
Rescaling took 397.4023565072566 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 438/1143 [00:10<00:16, 43.76it/s, epoch=1/50, avg_epoch_loss=0.243] 77%|███████▋  | 883/1143 [00:20<00:05, 44.15it/s, epoch=1/50, avg_epoch_loss=0.213]100%|██████████| 1143/1143 [00:25<00:00, 44.19it/s, epoch=1/50, avg_epoch_loss=0.206]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▊      | 442/1143 [00:10<00:15, 44.16it/s, epoch=2/50, avg_epoch_loss=0.183] 78%|███████▊  | 887/1143 [00:20<00:05, 44.32it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:25<00:00, 44.03it/s, epoch=2/50, avg_epoch_loss=0.182]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 434/1143 [00:10<00:16, 43.36it/s, epoch=3/50, avg_epoch_loss=0.181] 76%|███████▌  | 868/1143 [00:20<00:06, 42.95it/s, epoch=3/50, avg_epoch_loss=0.18] 100%|██████████| 1143/1143 [00:26<00:00, 43.05it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 437/1143 [00:10<00:16, 43.67it/s, epoch=4/50, avg_epoch_loss=0.18] 76%|███████▋  | 874/1143 [00:20<00:06, 43.25it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:26<00:00, 43.40it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 434/1143 [00:10<00:16, 43.34it/s, epoch=5/50, avg_epoch_loss=0.18] 76%|███████▌  | 871/1143 [00:20<00:06, 43.51it/s, epoch=5/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:26<00:00, 42.98it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 445/1143 [00:10<00:15, 44.45it/s, epoch=6/50, avg_epoch_loss=0.18] 78%|███████▊  | 893/1143 [00:20<00:05, 44.64it/s, epoch=6/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:25<00:00, 44.73it/s, epoch=6/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 447/1143 [00:10<00:15, 44.60it/s, epoch=7/50, avg_epoch_loss=0.179] 78%|███████▊  | 894/1143 [00:20<00:05, 44.63it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:25<00:00, 44.42it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 445/1143 [00:10<00:15, 44.48it/s, epoch=8/50, avg_epoch_loss=0.179] 78%|███████▊  | 890/1143 [00:20<00:05, 44.44it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:25<00:00, 44.47it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 446/1143 [00:10<00:15, 44.54it/s, epoch=9/50, avg_epoch_loss=0.179] 78%|███████▊  | 893/1143 [00:20<00:05, 44.63it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:25<00:00, 44.71it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 444/1143 [00:10<00:15, 44.37it/s, epoch=10/50, avg_epoch_loss=0.178] 78%|███████▊  | 890/1143 [00:20<00:05, 44.48it/s, epoch=10/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.44it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 447/1143 [00:10<00:15, 44.68it/s, epoch=11/50, avg_epoch_loss=0.179] 78%|███████▊  | 894/1143 [00:20<00:05, 44.45it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:25<00:00, 44.58it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 446/1143 [00:10<00:15, 44.60it/s, epoch=12/50, avg_epoch_loss=0.179] 78%|███████▊  | 892/1143 [00:20<00:05, 44.47it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.43it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 448/1143 [00:10<00:15, 44.74it/s, epoch=13/50, avg_epoch_loss=0.178] 78%|███████▊  | 896/1143 [00:20<00:05, 44.18it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.45it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 447/1143 [00:10<00:15, 44.69it/s, epoch=14/50, avg_epoch_loss=0.179] 78%|███████▊  | 894/1143 [00:20<00:05, 44.08it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:26<00:00, 43.75it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 429/1143 [00:10<00:16, 42.86it/s, epoch=15/50, avg_epoch_loss=0.179] 76%|███████▌  | 865/1143 [00:20<00:06, 43.29it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:26<00:00, 43.31it/s, epoch=15/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 429/1143 [00:10<00:16, 42.82it/s, epoch=16/50, avg_epoch_loss=0.177] 76%|███████▌  | 866/1143 [00:20<00:06, 43.33it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:26<00:00, 43.53it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 443/1143 [00:10<00:15, 44.23it/s, epoch=17/50, avg_epoch_loss=0.178] 78%|███████▊  | 891/1143 [00:20<00:05, 44.52it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.55it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 451/1143 [00:10<00:15, 45.00it/s, epoch=18/50, avg_epoch_loss=0.178] 79%|███████▉  | 902/1143 [00:20<00:05, 44.78it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.81it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 444/1143 [00:10<00:15, 44.38it/s, epoch=19/50, avg_epoch_loss=0.178] 78%|███████▊  | 888/1143 [00:20<00:05, 44.17it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.06it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▊      | 441/1143 [00:10<00:15, 44.06it/s, epoch=20/50, avg_epoch_loss=0.178] 77%|███████▋  | 883/1143 [00:20<00:05, 44.14it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.22it/s, epoch=20/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▊      | 441/1143 [00:10<00:15, 44.06it/s, epoch=21/50, avg_epoch_loss=0.177] 78%|███████▊  | 886/1143 [00:20<00:05, 44.27it/s, epoch=21/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.34it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 438/1143 [00:10<00:16, 43.79it/s, epoch=22/50, avg_epoch_loss=0.179] 77%|███████▋  | 878/1143 [00:20<00:06, 43.85it/s, epoch=22/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:26<00:00, 43.91it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 444/1143 [00:10<00:15, 44.31it/s, epoch=23/50, avg_epoch_loss=0.177] 78%|███████▊  | 888/1143 [00:20<00:05, 44.08it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.20it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 443/1143 [00:10<00:15, 44.26it/s, epoch=24/50, avg_epoch_loss=0.179] 78%|███████▊  | 887/1143 [00:20<00:05, 44.32it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.29it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 440/1143 [00:10<00:15, 43.99it/s, epoch=25/50, avg_epoch_loss=0.177] 77%|███████▋  | 880/1143 [00:20<00:06, 43.62it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 43.31it/s, epoch=25/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 429/1143 [00:10<00:16, 42.88it/s, epoch=26/50, avg_epoch_loss=0.177] 75%|███████▌  | 861/1143 [00:20<00:06, 43.04it/s, epoch=26/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 43.19it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 433/1143 [00:10<00:16, 43.28it/s, epoch=27/50, avg_epoch_loss=0.177] 76%|███████▌  | 868/1143 [00:20<00:06, 43.38it/s, epoch=27/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 43.64it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 443/1143 [00:10<00:15, 44.22it/s, epoch=28/50, avg_epoch_loss=0.178] 78%|███████▊  | 886/1143 [00:20<00:05, 44.05it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.19it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▊      | 442/1143 [00:10<00:15, 44.15it/s, epoch=29/50, avg_epoch_loss=0.177] 78%|███████▊  | 886/1143 [00:20<00:05, 44.24it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.05it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▊      | 442/1143 [00:10<00:15, 44.15it/s, epoch=30/50, avg_epoch_loss=0.178] 77%|███████▋  | 884/1143 [00:20<00:05, 43.49it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:26<00:00, 43.62it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 447/1143 [00:10<00:15, 44.60it/s, epoch=31/50, avg_epoch_loss=0.177] 78%|███████▊  | 895/1143 [00:20<00:05, 44.66it/s, epoch=31/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.62it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 443/1143 [00:10<00:15, 44.24it/s, epoch=32/50, avg_epoch_loss=0.177] 78%|███████▊  | 889/1143 [00:20<00:05, 44.40it/s, epoch=32/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.42it/s, epoch=32/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 446/1143 [00:10<00:15, 44.55it/s, epoch=33/50, avg_epoch_loss=0.178] 78%|███████▊  | 892/1143 [00:20<00:05, 44.42it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.23it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▊      | 441/1143 [00:10<00:15, 44.07it/s, epoch=34/50, avg_epoch_loss=0.176] 77%|███████▋  | 882/1143 [00:20<00:05, 44.03it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.08it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 444/1143 [00:10<00:15, 44.31it/s, epoch=35/50, avg_epoch_loss=0.178] 78%|███████▊  | 893/1143 [00:20<00:05, 44.62it/s, epoch=35/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.40it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 427/1143 [00:10<00:16, 42.64it/s, epoch=36/50, avg_epoch_loss=0.177] 75%|███████▍  | 854/1143 [00:20<00:06, 41.99it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 41.83it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 427/1143 [00:10<00:16, 42.65it/s, epoch=37/50, avg_epoch_loss=0.177] 75%|███████▍  | 854/1143 [00:20<00:06, 42.28it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 42.30it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 411/1143 [00:10<00:17, 41.06it/s, epoch=38/50, avg_epoch_loss=0.177] 73%|███████▎  | 835/1143 [00:20<00:07, 41.80it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 42.37it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 444/1143 [00:10<00:15, 44.33it/s, epoch=39/50, avg_epoch_loss=0.177] 78%|███████▊  | 888/1143 [00:20<00:05, 44.09it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.25it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▊      | 442/1143 [00:10<00:15, 44.17it/s, epoch=40/50, avg_epoch_loss=0.177] 78%|███████▊  | 887/1143 [00:20<00:05, 44.35it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.32it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 446/1143 [00:10<00:15, 44.53it/s, epoch=41/50, avg_epoch_loss=0.177] 78%|███████▊  | 892/1143 [00:20<00:05, 44.18it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.16it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 439/1143 [00:10<00:16, 43.83it/s, epoch=42/50, avg_epoch_loss=0.176] 77%|███████▋  | 879/1143 [00:20<00:06, 43.90it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 43.87it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 440/1143 [00:10<00:15, 43.97it/s, epoch=43/50, avg_epoch_loss=0.178] 77%|███████▋  | 881/1143 [00:20<00:05, 44.00it/s, epoch=43/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:25<00:00, 44.00it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 434/1143 [00:10<00:16, 43.36it/s, epoch=44/50, avg_epoch_loss=0.178] 77%|███████▋  | 878/1143 [00:20<00:06, 43.97it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 43.92it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 440/1143 [00:10<00:15, 43.97it/s, epoch=45/50, avg_epoch_loss=0.177] 77%|███████▋  | 880/1143 [00:20<00:05, 43.85it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 43.97it/s, epoch=45/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 446/1143 [00:10<00:15, 44.59it/s, epoch=46/50, avg_epoch_loss=0.177] 78%|███████▊  | 892/1143 [00:20<00:05, 44.11it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.26it/s, epoch=46/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 427/1143 [00:10<00:16, 42.60it/s, epoch=47/50, avg_epoch_loss=0.177] 75%|███████▍  | 853/1143 [00:20<00:06, 42.48it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 42.39it/s, epoch=47/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 426/1143 [00:10<00:16, 42.55it/s, epoch=48/50, avg_epoch_loss=0.177] 75%|███████▍  | 855/1143 [00:20<00:06, 42.73it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 41.91it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 420/1143 [00:10<00:17, 41.98it/s, epoch=49/50, avg_epoch_loss=0.176] 75%|███████▍  | 856/1143 [00:20<00:06, 42.89it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 43.18it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 39%|███▉      | 444/1143 [00:10<00:15, 44.40it/s, epoch=50/50, avg_epoch_loss=0.177] 78%|███████▊  | 888/1143 [00:20<00:05, 44.32it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:25<00:00, 44.23it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 83.90447409823537 seconds
Parameter local_layers with value 7 had evaluation 2.1742782021638063
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 45, 'local_layers': 8, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1303.734816916287 seconds
Creating forecasts took 203.34986383281648 seconds
 Start rescaling
Rescaling took 399.0690498240292 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▋      | 416/1143 [00:10<00:17, 41.53it/s, epoch=1/50, avg_epoch_loss=0.243] 73%|███████▎  | 835/1143 [00:20<00:07, 41.74it/s, epoch=1/50, avg_epoch_loss=0.213]100%|██████████| 1143/1143 [00:27<00:00, 41.79it/s, epoch=1/50, avg_epoch_loss=0.205]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 419/1143 [00:10<00:17, 41.85it/s, epoch=2/50, avg_epoch_loss=0.181] 73%|███████▎  | 839/1143 [00:20<00:07, 41.91it/s, epoch=2/50, avg_epoch_loss=0.182]100%|██████████| 1143/1143 [00:27<00:00, 41.69it/s, epoch=2/50, avg_epoch_loss=0.182]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 411/1143 [00:10<00:17, 41.02it/s, epoch=3/50, avg_epoch_loss=0.18] 72%|███████▏  | 824/1143 [00:20<00:07, 41.14it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:27<00:00, 41.06it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▋      | 417/1143 [00:10<00:17, 41.69it/s, epoch=4/50, avg_epoch_loss=0.18] 73%|███████▎  | 835/1143 [00:20<00:07, 41.74it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:27<00:00, 41.72it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 428/1143 [00:10<00:16, 42.75it/s, epoch=5/50, avg_epoch_loss=0.179] 75%|███████▍  | 856/1143 [00:20<00:06, 42.51it/s, epoch=5/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:26<00:00, 42.60it/s, epoch=5/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 421/1143 [00:10<00:17, 42.07it/s, epoch=6/50, avg_epoch_loss=0.18] 74%|███████▍  | 845/1143 [00:20<00:07, 42.23it/s, epoch=6/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:27<00:00, 42.17it/s, epoch=6/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 422/1143 [00:10<00:17, 42.12it/s, epoch=7/50, avg_epoch_loss=0.179] 74%|███████▍  | 850/1143 [00:20<00:06, 42.48it/s, epoch=7/50, avg_epoch_loss=0.18] 100%|██████████| 1143/1143 [00:26<00:00, 42.63it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 421/1143 [00:10<00:17, 42.09it/s, epoch=8/50, avg_epoch_loss=0.179] 74%|███████▍  | 843/1143 [00:20<00:07, 42.10it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:27<00:00, 42.32it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 428/1143 [00:10<00:16, 42.72it/s, epoch=9/50, avg_epoch_loss=0.179] 75%|███████▍  | 856/1143 [00:20<00:06, 42.23it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:26<00:00, 42.40it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 422/1143 [00:10<00:17, 42.19it/s, epoch=10/50, avg_epoch_loss=0.177] 74%|███████▍  | 844/1143 [00:20<00:07, 42.17it/s, epoch=10/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:27<00:00, 42.24it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 431/1143 [00:10<00:16, 43.02it/s, epoch=11/50, avg_epoch_loss=0.18] 75%|███████▌  | 862/1143 [00:20<00:06, 42.53it/s, epoch=11/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:26<00:00, 42.38it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 424/1143 [00:10<00:16, 42.38it/s, epoch=12/50, avg_epoch_loss=0.177] 74%|███████▍  | 848/1143 [00:20<00:07, 41.96it/s, epoch=12/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:27<00:00, 42.19it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▋      | 415/1143 [00:10<00:17, 41.43it/s, epoch=13/50, avg_epoch_loss=0.177] 73%|███████▎  | 830/1143 [00:20<00:07, 40.83it/s, epoch=13/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:28<00:00, 40.76it/s, epoch=13/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 413/1143 [00:10<00:17, 41.25it/s, epoch=14/50, avg_epoch_loss=0.177] 73%|███████▎  | 833/1143 [00:20<00:07, 41.67it/s, epoch=14/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:27<00:00, 41.42it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▋      | 415/1143 [00:10<00:17, 41.48it/s, epoch=15/50, avg_epoch_loss=0.177] 73%|███████▎  | 836/1143 [00:20<00:07, 41.80it/s, epoch=15/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:27<00:00, 42.05it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 421/1143 [00:10<00:17, 42.03it/s, epoch=16/50, avg_epoch_loss=0.177] 74%|███████▍  | 845/1143 [00:20<00:07, 42.21it/s, epoch=16/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 42.16it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 432/1143 [00:10<00:16, 43.18it/s, epoch=17/50, avg_epoch_loss=0.178] 76%|███████▌  | 864/1143 [00:20<00:06, 43.11it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:26<00:00, 43.02it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 429/1143 [00:10<00:16, 42.86it/s, epoch=18/50, avg_epoch_loss=0.177] 75%|███████▌  | 858/1143 [00:20<00:06, 42.47it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:26<00:00, 42.55it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 428/1143 [00:10<00:16, 42.70it/s, epoch=19/50, avg_epoch_loss=0.179] 75%|███████▍  | 856/1143 [00:20<00:06, 42.68it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:26<00:00, 42.76it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 435/1143 [00:10<00:16, 43.45it/s, epoch=20/50, avg_epoch_loss=0.179] 76%|███████▌  | 870/1143 [00:20<00:06, 42.73it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:26<00:00, 42.77it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 421/1143 [00:10<00:17, 42.08it/s, epoch=21/50, avg_epoch_loss=0.176] 74%|███████▍  | 848/1143 [00:20<00:06, 42.41it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 42.38it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 426/1143 [00:10<00:16, 42.57it/s, epoch=22/50, avg_epoch_loss=0.178] 75%|███████▍  | 854/1143 [00:20<00:06, 42.65it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:26<00:00, 42.76it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 428/1143 [00:10<00:16, 42.79it/s, epoch=23/50, avg_epoch_loss=0.177] 75%|███████▍  | 856/1143 [00:20<00:06, 41.85it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 41.88it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 410/1143 [00:10<00:17, 40.99it/s, epoch=24/50, avg_epoch_loss=0.179] 73%|███████▎  | 834/1143 [00:20<00:07, 41.79it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:27<00:00, 41.76it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 419/1143 [00:10<00:17, 41.82it/s, epoch=25/50, avg_epoch_loss=0.177] 73%|███████▎  | 838/1143 [00:20<00:07, 41.51it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 41.89it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 432/1143 [00:10<00:16, 43.18it/s, epoch=26/50, avg_epoch_loss=0.178] 76%|███████▌  | 864/1143 [00:20<00:06, 43.08it/s, epoch=26/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 43.02it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 434/1143 [00:10<00:16, 43.35it/s, epoch=27/50, avg_epoch_loss=0.178] 76%|███████▋  | 872/1143 [00:20<00:06, 43.61it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:26<00:00, 43.34it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 432/1143 [00:10<00:16, 43.15it/s, epoch=28/50, avg_epoch_loss=0.178] 76%|███████▌  | 864/1143 [00:20<00:06, 43.17it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:26<00:00, 43.05it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 422/1143 [00:10<00:17, 42.13it/s, epoch=29/50, avg_epoch_loss=0.177] 75%|███████▍  | 853/1143 [00:20<00:06, 42.66it/s, epoch=29/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:26<00:00, 42.40it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▋      | 417/1143 [00:10<00:17, 41.64it/s, epoch=30/50, avg_epoch_loss=0.178] 74%|███████▍  | 843/1143 [00:20<00:07, 42.18it/s, epoch=30/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 41.90it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 421/1143 [00:10<00:17, 42.05it/s, epoch=31/50, avg_epoch_loss=0.177] 74%|███████▍  | 845/1143 [00:20<00:07, 42.21it/s, epoch=31/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 42.05it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▋      | 416/1143 [00:10<00:17, 41.51it/s, epoch=32/50, avg_epoch_loss=0.178] 73%|███████▎  | 832/1143 [00:20<00:07, 41.37it/s, epoch=32/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 41.62it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 419/1143 [00:10<00:17, 41.89it/s, epoch=33/50, avg_epoch_loss=0.178] 73%|███████▎  | 838/1143 [00:20<00:07, 41.83it/s, epoch=33/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:27<00:00, 41.60it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▋      | 415/1143 [00:10<00:17, 41.42it/s, epoch=34/50, avg_epoch_loss=0.177] 73%|███████▎  | 832/1143 [00:20<00:07, 41.56it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 41.23it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 424/1143 [00:10<00:16, 42.32it/s, epoch=35/50, avg_epoch_loss=0.178] 74%|███████▍  | 848/1143 [00:20<00:07, 41.95it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:27<00:00, 41.88it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 420/1143 [00:10<00:17, 41.99it/s, epoch=36/50, avg_epoch_loss=0.176] 73%|███████▎  | 840/1143 [00:20<00:07, 41.60it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 42.00it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 428/1143 [00:10<00:16, 42.78it/s, epoch=37/50, avg_epoch_loss=0.177] 75%|███████▍  | 857/1143 [00:20<00:06, 42.83it/s, epoch=37/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:26<00:00, 42.89it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 433/1143 [00:10<00:16, 43.26it/s, epoch=38/50, avg_epoch_loss=0.177] 76%|███████▌  | 867/1143 [00:20<00:06, 43.28it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 43.08it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 426/1143 [00:10<00:16, 42.59it/s, epoch=39/50, avg_epoch_loss=0.177] 75%|███████▍  | 854/1143 [00:20<00:06, 42.66it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 42.57it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 431/1143 [00:10<00:16, 43.09it/s, epoch=40/50, avg_epoch_loss=0.177] 76%|███████▌  | 863/1143 [00:20<00:06, 43.12it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 43.20it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 427/1143 [00:10<00:16, 42.60it/s, epoch=41/50, avg_epoch_loss=0.177] 75%|███████▍  | 856/1143 [00:20<00:06, 42.77it/s, epoch=41/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:26<00:00, 42.81it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 433/1143 [00:10<00:16, 43.23it/s, epoch=42/50, avg_epoch_loss=0.178] 76%|███████▌  | 866/1143 [00:20<00:06, 43.15it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 43.11it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 434/1143 [00:10<00:16, 43.38it/s, epoch=43/50, avg_epoch_loss=0.178] 76%|███████▌  | 868/1143 [00:20<00:06, 43.23it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 43.25it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 424/1143 [00:10<00:16, 42.31it/s, epoch=44/50, avg_epoch_loss=0.178] 74%|███████▍  | 848/1143 [00:20<00:06, 42.34it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 42.40it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 433/1143 [00:10<00:16, 43.21it/s, epoch=45/50, avg_epoch_loss=0.176] 76%|███████▌  | 866/1143 [00:20<00:06, 42.77it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 42.84it/s, epoch=45/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 428/1143 [00:10<00:16, 42.79it/s, epoch=46/50, avg_epoch_loss=0.178] 75%|███████▍  | 856/1143 [00:20<00:06, 41.81it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 42.15it/s, epoch=46/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 38%|███▊      | 429/1143 [00:10<00:16, 42.86it/s, epoch=47/50, avg_epoch_loss=0.176] 75%|███████▌  | 858/1143 [00:20<00:06, 42.76it/s, epoch=47/50, avg_epoch_loss=0.176]100%|██████████| 1143/1143 [00:26<00:00, 42.75it/s, epoch=47/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 423/1143 [00:10<00:17, 42.29it/s, epoch=48/50, avg_epoch_loss=0.178] 75%|███████▍  | 852/1143 [00:20<00:06, 42.60it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 42.64it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 426/1143 [00:10<00:16, 42.56it/s, epoch=49/50, avg_epoch_loss=0.177] 75%|███████▌  | 859/1143 [00:20<00:06, 42.94it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 42.67it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 37%|███▋      | 426/1143 [00:10<00:16, 42.58it/s, epoch=50/50, avg_epoch_loss=0.177] 75%|███████▍  | 856/1143 [00:20<00:06, 42.78it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:26<00:00, 42.78it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 85.11736438795924 seconds
Parameter local_layers with value 8 had evaluation 2.2197025209876657
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 45, 'local_layers': 9, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1350.9898245856166 seconds
Creating forecasts took 207.34960660897195 seconds
 Start rescaling
Rescaling took 396.9627315290272 seconds
 Start validating...
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▍      | 396/1143 [00:10<00:18, 39.59it/s, epoch=1/50, avg_epoch_loss=0.248] 69%|██████▉   | 793/1143 [00:20<00:08, 39.63it/s, epoch=1/50, avg_epoch_loss=0.216]100%|██████████| 1143/1143 [00:28<00:00, 39.95it/s, epoch=1/50, avg_epoch_loss=0.206]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 408/1143 [00:10<00:18, 40.73it/s, epoch=2/50, avg_epoch_loss=0.182] 71%|███████▏  | 816/1143 [00:20<00:08, 40.62it/s, epoch=2/50, avg_epoch_loss=0.183]100%|██████████| 1143/1143 [00:28<00:00, 40.69it/s, epoch=2/50, avg_epoch_loss=0.182]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▌      | 403/1143 [00:10<00:18, 40.25it/s, epoch=3/50, avg_epoch_loss=0.18] 71%|███████   | 811/1143 [00:20<00:08, 40.51it/s, epoch=3/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:28<00:00, 40.46it/s, epoch=3/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▌      | 405/1143 [00:10<00:18, 40.40it/s, epoch=4/50, avg_epoch_loss=0.18] 71%|███████   | 810/1143 [00:20<00:08, 40.37it/s, epoch=4/50, avg_epoch_loss=0.18]100%|██████████| 1143/1143 [00:28<00:00, 40.39it/s, epoch=4/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▌      | 403/1143 [00:10<00:18, 40.29it/s, epoch=5/50, avg_epoch_loss=0.181] 71%|███████   | 807/1143 [00:20<00:08, 40.32it/s, epoch=5/50, avg_epoch_loss=0.18] 100%|██████████| 1143/1143 [00:28<00:00, 39.99it/s, epoch=5/50, avg_epoch_loss=0.18]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▍      | 395/1143 [00:10<00:18, 39.45it/s, epoch=6/50, avg_epoch_loss=0.18] 70%|███████   | 802/1143 [00:20<00:08, 40.14it/s, epoch=6/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:28<00:00, 40.26it/s, epoch=6/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▌      | 403/1143 [00:10<00:18, 40.25it/s, epoch=7/50, avg_epoch_loss=0.18] 71%|███████   | 806/1143 [00:20<00:08, 39.83it/s, epoch=7/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:28<00:00, 39.72it/s, epoch=7/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▍      | 396/1143 [00:10<00:18, 39.56it/s, epoch=8/50, avg_epoch_loss=0.179] 70%|██████▉   | 795/1143 [00:20<00:08, 39.75it/s, epoch=8/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:28<00:00, 39.71it/s, epoch=8/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 34%|███▍      | 390/1143 [00:10<00:19, 38.92it/s, epoch=9/50, avg_epoch_loss=0.179] 68%|██████▊   | 781/1143 [00:20<00:09, 39.00it/s, epoch=9/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:28<00:00, 39.52it/s, epoch=9/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▌      | 405/1143 [00:10<00:18, 40.45it/s, epoch=10/50, avg_epoch_loss=0.178] 71%|███████   | 810/1143 [00:20<00:08, 40.46it/s, epoch=10/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:28<00:00, 40.65it/s, epoch=10/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 407/1143 [00:10<00:18, 40.64it/s, epoch=11/50, avg_epoch_loss=0.18] 71%|███████▏  | 816/1143 [00:20<00:08, 40.77it/s, epoch=11/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:28<00:00, 40.64it/s, epoch=11/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▌      | 402/1143 [00:10<00:18, 40.19it/s, epoch=12/50, avg_epoch_loss=0.178] 71%|███████   | 811/1143 [00:20<00:08, 40.57it/s, epoch=12/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:28<00:00, 40.47it/s, epoch=12/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 409/1143 [00:10<00:17, 40.81it/s, epoch=13/50, avg_epoch_loss=0.178] 72%|███████▏  | 818/1143 [00:20<00:08, 40.53it/s, epoch=13/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:28<00:00, 40.45it/s, epoch=13/50, avg_epoch_loss=0.179]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 409/1143 [00:10<00:17, 40.88it/s, epoch=14/50, avg_epoch_loss=0.178] 72%|███████▏  | 822/1143 [00:20<00:07, 41.09it/s, epoch=14/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:27<00:00, 41.08it/s, epoch=14/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 407/1143 [00:10<00:18, 40.60it/s, epoch=15/50, avg_epoch_loss=0.178] 72%|███████▏  | 818/1143 [00:20<00:07, 40.85it/s, epoch=15/50, avg_epoch_loss=0.179]100%|██████████| 1143/1143 [00:27<00:00, 40.84it/s, epoch=15/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 414/1143 [00:10<00:17, 41.31it/s, epoch=16/50, avg_epoch_loss=0.178] 72%|███████▏  | 828/1143 [00:20<00:07, 40.88it/s, epoch=16/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:27<00:00, 41.02it/s, epoch=16/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 412/1143 [00:10<00:17, 41.11it/s, epoch=17/50, avg_epoch_loss=0.178] 72%|███████▏  | 824/1143 [00:20<00:07, 40.62it/s, epoch=17/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:28<00:00, 40.44it/s, epoch=17/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 34%|███▍      | 394/1143 [00:10<00:19, 39.35it/s, epoch=18/50, avg_epoch_loss=0.178] 69%|██████▉   | 788/1143 [00:20<00:09, 39.35it/s, epoch=18/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:28<00:00, 39.57it/s, epoch=18/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▍      | 395/1143 [00:10<00:18, 39.45it/s, epoch=19/50, avg_epoch_loss=0.178] 70%|███████   | 801/1143 [00:20<00:08, 40.10it/s, epoch=19/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:28<00:00, 40.25it/s, epoch=19/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 406/1143 [00:10<00:18, 40.52it/s, epoch=20/50, avg_epoch_loss=0.178] 71%|███████▏  | 815/1143 [00:20<00:08, 40.69it/s, epoch=20/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:28<00:00, 40.73it/s, epoch=20/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 408/1143 [00:10<00:18, 40.78it/s, epoch=21/50, avg_epoch_loss=0.177] 71%|███████▏  | 816/1143 [00:20<00:08, 40.66it/s, epoch=21/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:28<00:00, 40.72it/s, epoch=21/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 407/1143 [00:10<00:18, 40.62it/s, epoch=22/50, avg_epoch_loss=0.177] 71%|███████   | 814/1143 [00:20<00:08, 40.60it/s, epoch=22/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:28<00:00, 40.61it/s, epoch=22/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 414/1143 [00:10<00:17, 41.30it/s, epoch=23/50, avg_epoch_loss=0.177] 72%|███████▏  | 828/1143 [00:20<00:07, 41.05it/s, epoch=23/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 41.17it/s, epoch=23/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 408/1143 [00:10<00:18, 40.76it/s, epoch=24/50, avg_epoch_loss=0.178] 72%|███████▏  | 819/1143 [00:20<00:07, 40.92it/s, epoch=24/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:28<00:00, 40.78it/s, epoch=24/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 409/1143 [00:10<00:17, 40.85it/s, epoch=25/50, avg_epoch_loss=0.177] 72%|███████▏  | 818/1143 [00:20<00:07, 40.85it/s, epoch=25/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 40.84it/s, epoch=25/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 410/1143 [00:10<00:17, 40.91it/s, epoch=26/50, avg_epoch_loss=0.178] 72%|███████▏  | 822/1143 [00:20<00:07, 41.03it/s, epoch=26/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:27<00:00, 41.11it/s, epoch=26/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 410/1143 [00:10<00:17, 40.94it/s, epoch=27/50, avg_epoch_loss=0.176] 72%|███████▏  | 820/1143 [00:20<00:07, 40.80it/s, epoch=27/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:28<00:00, 40.45it/s, epoch=27/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 34%|███▍      | 388/1143 [00:10<00:19, 38.77it/s, epoch=28/50, avg_epoch_loss=0.179] 68%|██████▊   | 776/1143 [00:20<00:09, 38.64it/s, epoch=28/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:29<00:00, 38.86it/s, epoch=28/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 34%|███▍      | 391/1143 [00:10<00:19, 39.08it/s, epoch=29/50, avg_epoch_loss=0.177] 69%|██████▉   | 786/1143 [00:20<00:09, 39.31it/s, epoch=29/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:28<00:00, 39.69it/s, epoch=29/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▌      | 402/1143 [00:10<00:18, 40.16it/s, epoch=30/50, avg_epoch_loss=0.177] 35%|███▌      | 402/1143 [00:20<00:18, 40.16it/s, epoch=30/50, avg_epoch_loss=0.178] 70%|██████▉   | 797/1143 [00:20<00:08, 39.55it/s, epoch=30/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:28<00:00, 39.66it/s, epoch=30/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▌      | 403/1143 [00:10<00:18, 40.21it/s, epoch=31/50, avg_epoch_loss=0.178] 71%|███████   | 807/1143 [00:20<00:08, 40.32it/s, epoch=31/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:28<00:00, 40.27it/s, epoch=31/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▌      | 404/1143 [00:10<00:18, 40.40it/s, epoch=32/50, avg_epoch_loss=0.178] 71%|███████   | 808/1143 [00:20<00:08, 40.35it/s, epoch=32/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:28<00:00, 40.08it/s, epoch=32/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 406/1143 [00:10<00:18, 40.57it/s, epoch=33/50, avg_epoch_loss=0.178] 71%|███████   | 812/1143 [00:20<00:08, 39.75it/s, epoch=33/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:28<00:00, 40.38it/s, epoch=33/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 410/1143 [00:10<00:17, 40.99it/s, epoch=34/50, avg_epoch_loss=0.177] 72%|███████▏  | 820/1143 [00:20<00:07, 40.87it/s, epoch=34/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 40.98it/s, epoch=34/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▌      | 404/1143 [00:10<00:18, 40.32it/s, epoch=35/50, avg_epoch_loss=0.178] 71%|███████   | 808/1143 [00:20<00:08, 40.00it/s, epoch=35/50, avg_epoch_loss=0.178]100%|██████████| 1143/1143 [00:28<00:00, 40.19it/s, epoch=35/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 409/1143 [00:10<00:17, 40.88it/s, epoch=36/50, avg_epoch_loss=0.176] 72%|███████▏  | 820/1143 [00:20<00:07, 40.99it/s, epoch=36/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 41.05it/s, epoch=36/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 412/1143 [00:10<00:17, 41.20it/s, epoch=37/50, avg_epoch_loss=0.177] 72%|███████▏  | 824/1143 [00:20<00:07, 40.71it/s, epoch=37/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 40.89it/s, epoch=37/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 410/1143 [00:10<00:17, 40.95it/s, epoch=38/50, avg_epoch_loss=0.176] 72%|███████▏  | 820/1143 [00:20<00:08, 40.23it/s, epoch=38/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:28<00:00, 40.27it/s, epoch=38/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▍      | 397/1143 [00:10<00:18, 39.70it/s, epoch=39/50, avg_epoch_loss=0.177] 69%|██████▉   | 794/1143 [00:20<00:08, 39.54it/s, epoch=39/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:28<00:00, 39.69it/s, epoch=39/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▌      | 403/1143 [00:10<00:18, 40.25it/s, epoch=40/50, avg_epoch_loss=0.176] 71%|███████▏  | 815/1143 [00:20<00:08, 40.81it/s, epoch=40/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:28<00:00, 40.81it/s, epoch=40/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▋      | 415/1143 [00:10<00:17, 41.45it/s, epoch=41/50, avg_epoch_loss=0.177] 73%|███████▎  | 830/1143 [00:20<00:07, 41.06it/s, epoch=41/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 40.97it/s, epoch=41/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▌      | 401/1143 [00:10<00:18, 40.03it/s, epoch=42/50, avg_epoch_loss=0.177] 70%|███████   | 805/1143 [00:20<00:08, 40.22it/s, epoch=42/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:28<00:00, 40.28it/s, epoch=42/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 410/1143 [00:10<00:17, 40.97it/s, epoch=43/50, avg_epoch_loss=0.178] 72%|███████▏  | 823/1143 [00:20<00:07, 41.15it/s, epoch=43/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 41.13it/s, epoch=43/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▌      | 404/1143 [00:10<00:18, 40.32it/s, epoch=44/50, avg_epoch_loss=0.178] 71%|███████   | 812/1143 [00:20<00:08, 40.58it/s, epoch=44/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:28<00:00, 40.70it/s, epoch=44/50, avg_epoch_loss=0.178]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▋      | 415/1143 [00:10<00:17, 41.42it/s, epoch=45/50, avg_epoch_loss=0.176] 73%|███████▎  | 830/1143 [00:20<00:07, 41.35it/s, epoch=45/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 41.32it/s, epoch=45/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▋      | 415/1143 [00:10<00:17, 41.44it/s, epoch=46/50, avg_epoch_loss=0.177] 73%|███████▎  | 830/1143 [00:20<00:07, 41.46it/s, epoch=46/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 41.21it/s, epoch=46/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 409/1143 [00:10<00:17, 40.90it/s, epoch=47/50, avg_epoch_loss=0.176] 72%|███████▏  | 819/1143 [00:20<00:07, 40.95it/s, epoch=47/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:27<00:00, 41.02it/s, epoch=47/50, avg_epoch_loss=0.176]
  0%|          | 0/1143 [00:00<?, ?it/s] 36%|███▌      | 406/1143 [00:10<00:18, 40.53it/s, epoch=48/50, avg_epoch_loss=0.177] 71%|███████   | 813/1143 [00:20<00:08, 40.57it/s, epoch=48/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:28<00:00, 40.29it/s, epoch=48/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▍      | 395/1143 [00:10<00:18, 39.42it/s, epoch=49/50, avg_epoch_loss=0.177] 69%|██████▉   | 793/1143 [00:20<00:08, 39.62it/s, epoch=49/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:28<00:00, 39.79it/s, epoch=49/50, avg_epoch_loss=0.177]
  0%|          | 0/1143 [00:00<?, ?it/s] 35%|███▍      | 397/1143 [00:10<00:18, 39.69it/s, epoch=50/50, avg_epoch_loss=0.176] 70%|██████▉   | 795/1143 [00:20<00:08, 39.75it/s, epoch=50/50, avg_epoch_loss=0.177]100%|██████████| 1143/1143 [00:28<00:00, 40.10it/s, epoch=50/50, avg_epoch_loss=0.177]
WARNING:root:Serializing RepresentableBlockPredictor instances does not save the prediction network structure in a backwards-compatible manner. Be careful not to use this method in production.
Evaluation took 86.6502240486443 seconds
Parameter local_layers with value 9 had evaluation 2.1898363525036046
{'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 45, 'local_layers': 10, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
learning rate from ``lr_scheduler`` has been overwritten by ``learning_rate`` in optimizer.
Training the predictor took 1413.9983744639903 seconds
Creating forecasts took 207.62979561462998 seconds
 Start rescaling
Rescaling took 399.1888895165175 seconds
 Start validating...
Evaluation took 83.98080480843782 seconds
Parameter local_layers with value 10 had evaluation 2.2049236379953205
The best value for local_layers is 7 with evaluation 2.1742782021638063
 md[local_layers] = 7
The final result is {'path': 'data/pems-bay.h5', 'sensors': 325, 'freq': '5Min', 'make_plots': False, 'normalize': True, 'train_predictor': True, 'prediction_length': 12, 'estimator': 'DeepFactor', 'kernel': '', 'distribution': 'StudentT', 'global_units': 4, 'global_layers': 8, 'factors': 65, 'local_units': 45, 'local_layers': 7, 'cell_type': 'gru', 'serialize_path': 'results/Pems/DF-combine/', 'params': ['global_units', 'global_layers', 'factors', 'local_units', 'local_layers'], 'start': [2, 1, 5, 5, 1], 'step': [2, 1, 5, 5, 1], 'end': [25, 11, 100, 55, 11], 'stop': True}
 with evaluation 2.1742782021638063
finished successful
